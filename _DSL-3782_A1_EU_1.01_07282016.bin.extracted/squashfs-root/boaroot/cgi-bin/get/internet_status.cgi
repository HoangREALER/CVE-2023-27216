#!/bin/sh
echo -e "Content-Type: text/html\n\n"
tcapi_path=/userfs/bin/

internet_status_adsl=0
internet_status_ptm=0
internet_status_fiber=0
internet_status_3g=0

for i in 0 1 2 3 4 5 6 7
do 
	connType_adsl=`"$tcapi_path"tcapi get DeviceInfo_PVC$i connType`
	if [ "$connType_adsl" != "Bridge" ] ; then
		status_adsl=`"$tcapi_path"tcapi get DeviceInfo_PVC$i Status`
		if [ "$status_adsl" = "1" ] ; then
			wanip_adsl=`"$tcapi_path"tcapi get DeviceInfo_PVC$i WanIP`
			if [ "$wanip_adsl" != "10.64.64.64" ] ; then
				internet_status_adsl=1
			fi
		fi
	fi
done

for i in 0 1 2 3 4 5 6 7
do 
	connType_fiber=`"$tcapi_path"tcapi get DeviceInfoExt_PVC8e$i connType`
	if [ "$connType_fiber" != "Bridge" ] ; then
		status_fiber=`"$tcapi_path"tcapi get DeviceInfoExt_PVC8e$i Status`
		if [ "$status_fiber" = "1" ] ; then
			wanip_ptm=`"$tcapi_path"tcapi get DeviceInfoExt_PVC8e$i WanIP`
			if [ "$wanip_ptm" != "10.64.64.64" ] ; then
				internet_status_ptm=1
			fi
		fi
	fi
done

for i in 0 1 2 3 4 5 6 7
do 
	connType_fiber=`"$tcapi_path"tcapi get DeviceInfoExt_PVC10e$i connType`
	if [ "$connType_fiber" != "Bridge" ] ; then
		status_fiber=`"$tcapi_path"tcapi get DeviceInfoExt_PVC10e$i Status`
		if [ "$status_fiber" = "1" ] ; then
			wanip_fiber=`"$tcapi_path"tcapi get DeviceInfoExt_PVC10e$i WanIP`
			if [ "$wanip_fiber" != "10.64.64.64" ] ; then
				internet_status_fiber=1
			fi
		fi
	fi
done

status_3g=`"$tcapi_path"tcapi get DongleInfo Status`
if [ "$status_3g" = "1" ] ; then
	internet_status_3g=1
fi

echo "var internet_status_adsl= '$internet_status_adsl';"
echo "var internet_status_ptm= '$internet_status_ptm';"
echo "var internet_status_fiber= '$internet_status_fiber';"
echo "var internet_status_3g= '$internet_status_3g';"