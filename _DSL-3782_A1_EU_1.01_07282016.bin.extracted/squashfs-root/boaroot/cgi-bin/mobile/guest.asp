<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title><%tcWebApi_get("Upnpd_Entry","ModelName","s")%></title>
	<link rel="stylesheet" href="/mobile/jquery.mobile-1.4.5.min.css">
	<link rel="stylesheet" href="/mobile/style.css">
	<script src="/mobile/jquery.min.js"></script>
	<script src="/mobile/jquery.mobile-1.4.5.min.js"></script>
	<script src="/mobile/initLanguage.js"></script>
</head>
<body>
	<div data-role="page">
		<script type="text/javascript">

			if(top.location.href.indexOf("index.asp") != top.location.href.toString().length - 9) {
				top.location.href = "http://<%TCWebApi_get("Lan_Entry0","IP","s")%>/cgi-bin/mobile/index.asp";
			}

			var n = 5 * 60*1000;
			setTimeout(function(){
				self.location.href = "/cgi-bin/mobile/index.asp";
			}, n);

			function encodeSpecialChr(str) {
				str = str.replace(/&/g, "&amp;");
				str = str.replace(/</g, "&lt;");
				str = str.replace(/>/g, "&gt;");
				str = str.replace(/"/g, "&quot;");
				str = str.replace(/'/g, "&#39;");
				str = str.replace(/;/g, "\;");
				str = str.replace(/=/g, "&#61;");
				str = str.replace(/\+/g, "&#43;");
				str = str.replace(/-/g, "&#45;");
				return str;
			}

			function decodeSpecialChr(str) {
				str = str.replace(/&amp;/g, "&");
				str = str.replace(/&lt;/g, "<");
				str = str.replace(/&gt;/g, ">");
				str = str.replace(/&quot;/g, "\"");
				str = str.replace(/&#39;/g, "'");
				str = str.replace(/&#59;/g, ";");
				str = str.replace(/&#61;/g, "=");
				str = str.replace(/&#43;/g, "+");
				str = str.replace(/&#45;/g, "-");
				return str;
			}

			function isSSIDInvalid(source) {
				var sourcestr = new String(source);
				var tempstr;
				for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
					tempstr = sourcestr.substr(strposition, 1);
					if (tempstr.charCodeAt(0) == 45 || tempstr.charCodeAt(0) == 95 || tempstr.charCodeAt(0) == 46 || tempstr.charCodeAt(0) == 64 || (tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
						continue;
					else
						return true;
				}
				return false;
			}

			function checkSSID(name, id) {
				var en_ssid_index_0 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","SSIDON","s")%>');
				var en_ssid_index_1 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry1","SSIDON","s")%>');
				var en_ssid_index_2 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry2","SSIDON","s")%>');
				var en_ssid_index_3 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry3","SSIDON","s")%>');
				var conn_ssid_0 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","SSID","s")%>');
				var conn_ssid_1 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry1","SSID","s")%>');
				var conn_ssid_2 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry2","SSID","s")%>');
				var conn_ssid_3 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry3","SSID","s")%>');
				var dataLists = [
					[en_ssid_index_0, conn_ssid_0],
					[en_ssid_index_1, conn_ssid_1],
					[en_ssid_index_2, conn_ssid_2],
					[en_ssid_index_3, conn_ssid_3]
				];
				for (var i = 0; i < dataLists.length; i++) {
					if (dataLists[i][0] == 1) {
						if (id != i) {
							if (name == dataLists[i][1])
								return false;
						}
					}
				}
				return true;
			}

			function checkSSID_ac(name, id) {
				var en_ssid_index_0_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","SSIDON","s")%>');
				var en_ssid_index_1_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry1","SSIDON","s")%>');
				var en_ssid_index_2_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry2","SSIDON","s")%>');
				var en_ssid_index_3_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry3","SSIDON","s")%>');
				var conn_ssid_0_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","SSID","s")%>');
				var conn_ssid_1_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry1","SSID","s")%>');
				var conn_ssid_2_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry2","SSID","s")%>');
				var conn_ssid_3_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry3","SSID","s")%>');
				var dataLists_ac = [
					[en_ssid_index_0_ac, conn_ssid_0_ac],
					[en_ssid_index_1_ac, conn_ssid_1_ac],
					[en_ssid_index_2_ac, conn_ssid_2_ac],
					[en_ssid_index_3_ac, conn_ssid_3_ac]
				];
				for (var i = 0; i < dataLists_ac.length; i++) {
					if (dataLists_ac[i][0] == 1) {
						if (id != i) {
							if (name == dataLists_ac[i][1])
								return false;
						}
					}
				}
				return true;
			}

			function isSSIDInvalid(source) {
				var sourcestr = new String(source);
				var tempstr;
				for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
					tempstr = sourcestr.substr(strposition, 1);
					if (tempstr.charCodeAt(0) == 45 || tempstr.charCodeAt(0) == 95 || tempstr.charCodeAt(0) == 46 || tempstr.charCodeAt(0) == 64 || (tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
						continue;
					else
						return true;
				}
				return false;
			}

			function strchk_unicode(str) {
				var strlen = str.length;
				if (strlen > 0) {
					var c = '';
					for (var i = 0; i < strlen; i++) {
						c = escape(str.charAt(i));
						if (c.charAt(0) == '%' && c.charAt(1) == 'u')
							return true;
					}
				}
				return false;
			}

			function Prefixes_Rule_WEP_KEY(TelNum) {
				for (var i = 0; i < TelNum.length; i++) {
					if (TelNum.charAt(i) == '\"') return false;
					if (TelNum.charAt(i) == ' ') return false;
					if (TelNum.charAt(i) == '\\') return false;
					if (TelNum.charAt(i) == '%') return false;
					if (TelNum.charAt(i) == '#') return false;
				}
				return true;
			}

			function isHex(cmpStr) {
				var regStr = /[a-fA-F0-9]/;
				for (i = 0; i < cmpStr.length; i++) {
					if (cmpStr.charAt(i).search(regStr) == -1)
						return false;
				}
				return true;
			}

			var msg_length = 0;

			function check_key(keyvalue, lan_wlan_cipher, lan_wlan_type) {
				var keylength = parseInt(lan_wlan_cipher);
				var keytype = parseInt(lan_wlan_type);
				var ascii_length = (keylength / 8) - 3;
				var hex_length = ascii_length * 2;

				if (keytype == 1)
					my_length = ascii_length;
				else
					my_length = hex_length;

				msg_length = my_length;

				if (keytype == 1) {
					if (!Prefixes_Rule_WEP_KEY(keyvalue))
						return false;
				}

				if (keytype != 1) {
					if (!isHex(keyvalue))
						return false;
				}

				if ((keytype == 1) && (keyvalue == 0))
					return false;

				if ((keyvalue.length != my_length && keyvalue != ""))
					return false;

				return true;
			}

			function isWPAKeyInvalid(source) {
				var sourcestr = new String(source);
				var tempstr;
				if (sourcestr == "")
					return false;

				for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
					tempstr = sourcestr.substr(strposition, 1);
					if ((tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
						continue;
					else
						return true;
				}
				return false;
			}

			
			var guest_val = {
				"guest24_status": '<%tcWebApi_get("WLan_Common","SSIDseperation","s")%>',
				"guest24_ssid": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","SSID","s")%>'),

				"guest24_authmode": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","AuthMode","s")%>'),
				"guest24_defKeyID": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","DefaultKeyID","s")%>'),
				"guest24_key1": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","Key1Str","s")%>'),
				"guest24_key2": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","Key2Str","s")%>'),
				"guest24_key3": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","Key3Str","s")%>'),
				"guest24_key4": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","Key4Str","s")%>'),
				"guest24_wpapsk": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WPAPSK","s")%>'),
				"WEPAuthType": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WEPAuthType","s")%>'),
				"EncrypType": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","EncrypType","s")%>'),
				"RekeyInterval": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","RekeyInterval","s")%>'),

				"WPSConfMode": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WPSConfMode","s")%>'),
				"WPSConfStatus": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WPSConfStatus","s")%>'),
				"HideSSID": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","HideSSID","s")%>'),
				"WMM": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WMM","s")%>'),
				// ////////////////////////////////////////

				"guest5_status": '<%tcWebApi_get("WLan11ac_Common","SSIDseperation","s")%>',
				"guest5_ssid": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","SSID","s")%>'),

				"guest5_authmode": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","AuthMode","s")%>'),
				"guest5_defKeyID": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","DefaultKeyID","s")%>'),
				"guest5_key1": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","Key1Str","s")%>'),
				"guest5_key2": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","Key2Str","s")%>'),
				"guest5_key3": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","Key3Str","s")%>'),
				"guest5_key4": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","Key4Str","s")%>'),
				"guest5_wpapsk": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WPAPSK","s")%>'),
				"WEPAuthType_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WEPAuthType","s")%>'),
				"EncrypType_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","EncrypType","s")%>'),
				"RekeyInterval_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","RekeyInterval","s")%>'),

				"WPSConfMode_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WPSConfMode","s")%>'),
				"WPSConfStatus_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WPSConfStatus","s")%>'),
				"HideSSID_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","HideSSID","s")%>'),
				"WMM_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WMM","s")%>'),
			};

			guest_val.guest24_authmode = "WPAPSKWPA2PSK";
			guest_val.guest5_authmode = "WPAPSKWPA2PSK";


			$(function(){
				if(guest_val.guest24_status == "1") {
					$("#mobile_gz_24g_div").show();
					if (guest_val.guest24_authmode != "OPEN")
						$("#mobile_gz_24g_key_div").show();

					$("#mobile_gz_24g").val('1');
				} else {
					$("#mobile_gz_24g").val('0');
				}

				$('#mobile_gz_24g').slider('refresh');

				$("#mobile_gz_24g_ssid").val(guest_val.guest24_ssid);

				var wifi2_key;
				if (guest_val.guest24_authmode == "OPEN") {
					wifi2_key = "";
				} else if (guest_val.guest24_authmode == "WEP-64Bits") {
					wifi2_key = eval("guest_val.guest24_key" + guest_val.guest24_defKeyID);
				} else if (guest_val.guest24_authmode == "WEP-128Bits") {
					wifi2_key = eval("guest_val.guest24_key" + guest_val.guest24_defKeyID);					
				} else if (guest_val.guest24_authmode == "WPAPSK" || guest_val.guest24_authmode == "WPA") {
					wifi2_key = guest_val.guest24_wpapsk;					
				} else if (guest_val.guest24_authmode == "WPA2PSK" || guest_val.guest24_authmode == "WPA2") {
					wifi2_key = guest_val.guest24_wpapsk;					
				} else if (guest_val.guest24_authmode == "WPAPSKWPA2PSK" || guest_val.guest24_authmode == "WPA1WPA2") {
					wifi2_key = guest_val.guest24_wpapsk;					
				}

				if (wifi2_key == "" || wifi2_key == "N/A")
					wifi2_key = "";

				$("#mbwifi_pswd_24").val(wifi2_key);

				if(guest_val.guest5_status == "1") {
					$("#mobile_gz_5g_div").show();
					if (guest_val.guest5_authmode != "OPEN")
						$("#mobile_gz_5g_key_div").show();
					$("#mobile_gz_5g").val('1');
				} else {
					$("#mobile_gz_5g").val('0');
				}

				$('#mobile_gz_5g').slider('refresh');
				$("#mobile_gz_5g").change();

				$("#mobile_gz_5g_ssid").val(guest_val.guest5_ssid);

				var wifi5_key;
				if (guest_val.guest5_authmode == "OPEN") {
					wifi5_key = "";					
				} else if (guest_val.guest5_authmode == "WEP-64Bits") {
					wifi5_key = eval("guest_val.guest5_key" + guest_val.guest5_defKeyID);					
				} else if (guest_val.guest5_authmode == "WEP-128Bits") {
					wifi5_key = eval("guest_val.guest5_key" + guest_val.guest5_defKeyID);					
				} else if (guest_val.guest5_authmode == "WPAPSK" || guest_val.guest5_authmode == "WPA") {
					wifi5_key = guest_val.guest5_wpapsk;				
				} else if (guest_val.guest5_authmode == "WPA2PSK" || guest_val.guest5_authmode == "WPA2") {
					wifi5_key = guest_val.guest5_wpapsk;					
				} else if (guest_val.guest5_authmode == "WPAPSKWPA2PSK" || guest_val.guest5_authmode == "WPA1WPA2") {
					wifi5_key = guest_val.guest5_wpapsk;					
				}
				if (wifi5_key == "" || wifi5_key == "N/A")
					wifi5_key = "";

				$("#mbwifi_pswd_5").val(wifi5_key);

				if(guest_val.guest24_status == "1" || guest_val.guest5_status == "1") {
					$("#gz_status").prop("src", "/mobile/images/mobile_guestzone_enabled.png");
				} else if( guest_val.guest24_status != "1" && guest_val.guest5_status != "1" ) {
					$("#gz_status").prop("src", "/mobile/images/mobile_guestzone.png");
				}				

				$("#btn_login").on("tap", function(){
					$("#mobile_gz_24g_ssid_error").hide();
					$("#mobile_gz_5g_ssid_error").hide();

					$("#mbwifi_pswd_24_error").hide();
					$("#mbwifi_pswd_5_error").hide();
					if($("#mobile_gz_24g").val() == "1") {
						if ($("#mobile_gz_24g_ssid").val().length < 3 || $("#mobile_gz_24g_ssid").val().length > 32) {
							$("#mobile_gz_24g_ssid_error").html(m_wifi_waringssid);
							$("#mobile_gz_24g_ssid_error").show();
							return;
						} else if (isSSIDInvalid($("#mobile_gz_24g_ssid").val())) {
							$("#mobile_gz_24g_ssid_error").html(m_wifi_waringssid);
							$("#mobile_gz_24g_ssid_error").show();
							return;
						}

						if (checkSSID($("#mobile_gz_24g_ssid").val(), 1) == false) {
							$("#mobile_gz_24g_ssid_error").html(m_wifi_waringssid2).show();
							return;
						}


						if (guest_val.guest24_authmode == "OPEN") {
							
						} else if (guest_val.guest24_authmode == "WEP-64Bits") {
							if ($("#mbwifi_pswd_24").val().length == 5) {
								if (!check_key($("#mbwifi_pswd_24").val(), 64, 1)) {
									$("#mbwifi_pswd_24_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_ASCII_error).show();
									return;
								}
							} else if ($("#mbwifi_pswd_24").val().length == 10) {
								if (!check_key($("#mbwifi_pswd_24").val(), 64, 2)) {
									$("#mbwifi_pswd_24_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_hex_error).show();
									return;
								}
							} else {
								$("#mbwifi_pswd_24_error").html(_wlan_conn_wizard_network_error).show();
								return;
							}
						} else if (guest_val.guest24_authmode == "WEP-128Bits") {
							if ($("#mbwifi_pswd_24").val().length == 13) {
								if (!check_key($("#mbwifi_pswd_24").val(), 128, 1)) {
									$("#mbwifi_pswd_24_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_ASCII_error).show();
									return;
								}
							} else if ($("#mbwifi_pswd_24").val().length == 26) {
								if (!check_key($("#mbwifi_pswd_24").val(), 128, 2)) {
									$("#mbwifi_pswd_24_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_hex_error).show();
									return;
								}
							} else {
								$("#mbwifi_pswd_24_error").html(_wlan_conn_wizard_network_error).show();
								return;
							}
						} else if (guest_val.guest24_authmode == "WPAPSK" || guest_val.guest24_authmode == "WPA") {
							if (($("#mbwifi_pswd_24").val().length < 8) || ($("#mbwifi_pswd_24").val().length > 63) || (isWPAKeyInvalid($("#mbwifi_pswd_24").val()))) {
								$("#mbwifi_pswd_24_error").html(_lan_wlan_string_errorA + "WPA-PSK" + _lan_wlan_string_errorB).show();	
								return;
							}

							if (strchk_unicode($("#mbwifi_pswd_24").val())) {
								$("#mbwifi_pswd_24_error").html(_lan_wlan_string_errorC).show();
								return;
							}
						} else if (guest_val.guest24_authmode == "WPA2PSK" || guest_val.guest24_authmode == "WPA2") {
							if (($("#mbwifi_pswd_24").val().length < 8) || ($("#mbwifi_pswd_24").val().length > 63) || (isWPAKeyInvalid($("#mbwifi_pswd_24").val()))) {
								
								$("#mbwifi_pswd_24_error").html(_lan_wlan_string_errorA + "WPA2-PSK" + _lan_wlan_string_errorB).show();	
								return;
							}

							if (strchk_unicode($("#mbwifi_pswd_24").val())) {
								$("#mbwifi_pswd_24_error").html(_lan_wlan_string_errorC).show();
								return;
							}
						} else if (guest_val.guest24_authmode == "WPAPSKWPA2PSK" || guest_val.guest24_authmode == "WPA1WPA2") {
							if (($("#mbwifi_pswd_24").val().length < 8) || ($("#mbwifi_pswd_24").val().length > 63) || (isWPAKeyInvalid($("#mbwifi_pswd_24").val()))) {
								
								$("#mbwifi_pswd_24_error").html(_lan_wlan_string_errorA + "WPA/WPA2-PSK" + _lan_wlan_string_errorB).show();
								return;
							}

							if (strchk_unicode($("#mbwifi_pswd_24").val())) {
								$("#mbwifi_pswd_24_error").html(_lan_wlan_string_errorC).show();
								return;
							}
						}
					}

					if($("#mobile_gz_5g").val() == "1") {
						if ($("#mobile_gz_5g_ssid").val().length < 3 || $("#mobile_gz_5g_ssid").val().length > 32) {
							$("#mobile_gz_5g_ssid_error").html(m_wifi_waringssid);
							$("#mobile_gz_5g_ssid_error").show();
							return;
						} else if (isSSIDInvalid($("#mobile_gz_5g_ssid").val())) {
							$("#mobile_gz_5g_ssid_error").html(m_wifi_waringssid);
							$("#mobile_gz_5g_ssid_error").show();
							return;
						}
						if (checkSSID_ac($("#mobile_gz_5g_ssid").val(), 1) == false) {
							$("#mobile_gz_5g_ssid_error").html(m_wifi_waringssid2).show();
							return;
						}


						if (guest_val.guest5_authmode == "OPEN") {
							
						} else if (guest_val.guest5_authmode == "WEP-64Bits") {
							if ($("#mbwifi_pswd_5").val().length == 5) {
								if (!check_key($("#mbwifi_pswd_5").val(), 64, 1)) {
									$("#mbwifi_pswd_5_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_ASCII_error).show();
									return;
								}
							} else if ($("#mbwifi_pswd_5").val().length == 10) {
								if (!check_key($("#mbwifi_pswd_5").val(), 64, 2)) {
									$("#mbwifi_pswd_5_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_hex_error).show();
									return;
								}
							} else {
								$("#mbwifi_pswd_5_error").html(_wlan_conn_wizard_network_error).show();
								return;
							}
						} else if (guest_val.guest5_authmode == "WEP-128Bits") {
							if ($("#mbwifi_pswd_5").val().length == 13) {
								if (!check_key($("#mbwifi_pswd_5").val(), 128, 1)) {
									$("#mbwifi_pswd_5_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_ASCII_error).show();
									return;
								}
							} else if ($("#mbwifi_pswd_5").val().length == 26) {
								if (!check_key($("#mbwifi_pswd_5").val(), 128, 2)) {
									$("#mbwifi_pswd_5_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_hex_error).show();
									return;
								}
							} else {
								$("#mbwifi_pswd_5_error").html(_wlan_conn_wizard_network_error).show();
								return;
							}
						} else if (guest_val.guest5_authmode == "WPAPSK" || guest_val.guest5_authmode == "WPA") {
							if (($("#mbwifi_pswd_5").val().length < 8) || ($("#mbwifi_pswd_5").val().length > 63) || (isWPAKeyInvalid($("#mbwifi_pswd_5").val()))) {
								$("#mbwifi_pswd_5_error").html(_lan_wlan_string_errorA + "WPA-PSK" + _lan_wlan_string_errorB).show();	
								return;
							}

							if (strchk_unicode($("#mbwifi_pswd_5").val())) {
								$("#mbwifi_pswd_5_error").html(_lan_wlan_string_errorC).show();
								return;
							}
						} else if (guest_val.guest5_authmode == "WPA2PSK" || guest_val.guest5_authmode == "WPA2") {
							if (($("#mbwifi_pswd_5").val().length < 8) || ($("#mbwifi_pswd_5").val().length > 63) || (isWPAKeyInvalid($("#mbwifi_pswd_5").val()))) {
								
								$("#mbwifi_pswd_5_error").html(_lan_wlan_string_errorA + "WPA2-PSK" + _lan_wlan_string_errorB).show();	
								return;
							}

							if (strchk_unicode($("#mbwifi_pswd_5").val())) {
								$("#mbwifi_pswd_5_error").html(_lan_wlan_string_errorC).show();
								return;
							}
						} else if (guest_val.guest5_authmode == "WPAPSKWPA2PSK" || guest_val.guest5_authmode == "WPA1WPA2") {
							if (($("#mbwifi_pswd_5").val().length < 8) || ($("#mbwifi_pswd_5").val().length > 63) || (isWPAKeyInvalid($("#mbwifi_pswd_5").val()))) {
								
								$("#mbwifi_pswd_5_error").html(_lan_wlan_string_errorA + "WPA/WPA2-PSK" + _lan_wlan_string_errorB).show();
								return;
							}

							if (strchk_unicode($("#mbwifi_pswd_5").val())) {
								$("#mbwifi_pswd_5_error").html(_lan_wlan_string_errorC).show();
								return;
							}
						}
					}
					
					$("#wait_time").html(60);
					setInterval(function() {
						var waitTime = parseInt($("#wait_time").html());
						waitTime = waitTime - 1;
						if (waitTime > 0) {							
							$("#wait_time").html(waitTime);
						} else {
							self.location.href = "/cgi-bin/mobile/guest.asp";
						}
					}, 1000);
					$("#popup_msg").click();

					$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey){

						guest_val.sessionKey = sessionKey;
						guest_val.mobile_gz = 1;
						guest_val.guest24_status = $("#mobile_gz_24g").val();
						guest_val.guest5_status = $("#mobile_gz_5g").val();

						if($("#mobile_gz_24g").val() == "1"){
							guest_val.guest24_ssid = $("#mobile_gz_24g_ssid").val();
							guest_val.guest24_wpapsk = $("#mbwifi_pswd_24").val();
						}

						if($("#mobile_gz_5g").val() == "1"){
							guest_val.guest5_ssid = $("#mobile_gz_5g_ssid").val();
							guest_val.guest5_wpapsk = $("#mbwifi_pswd_5").val();
						}


						$.ajax({
							type: "POST",
							url: "set_guest.asp",
							data: guest_val,
							success: function(msg){
								/*$.mobile.loading('hide');
								$("#popupMsg").html(m_comm_mobile_save_success);
								$("#popup_msg").click();
								setTimeout(function(){
									self.location.href = "/cgi-bin/mobile/guest.asp";
								}, 1000);*/
							},
							error: function(){
								/*$.mobile.loading('hide');
								$("#popupMsg").html(m_comm_mobile_save_error);
								$("#popup_msg").click();*/
							}
						});
					});	
				});

				$("#mobile_gz_24g").change(function(){
					if($("#mobile_gz_24g").val() == "1") {
						$("#mobile_gz_24g_div").show();
						if (guest_val.guest24_authmode != "OPEN")
							$("#mobile_gz_24g_key_div").show();
					} else {
						$("#mobile_gz_24g_div").hide();
						$("#mobile_gz_24g_key_div").hide();
					}
				});

				$("#mobile_gz_5g").change(function(){
					if($("#mobile_gz_5g").val() == "1") {
						$("#mobile_gz_5g_div").show();
						if (guest_val.guest5_authmode != "OPEN")
							$("#mobile_gz_5g_key_div").show();
					} else {
						$("#mobile_gz_5g_div").hide();
						$("#mobile_gz_5g_key_div").hide();
					}
				});
			});
		</script>
		<div data-role="header" data-theme="c" data-position="fixed">
			<a href="/cgi-bin/mobile/menu.asp" data-role="button" data-icon="home" data-ajax=false><script>document.write(m_comm_mobile_home);</script></a>
			<h2><img src="/mobile/images/mobile_dlink_logo.png" class="title_logo"></h2>
		</div>

		<div role="main" class="ui-content">
			<div style="height: 45px; vertical-align: middle;">
				<img id="gz_status" src="/mobile/images/mobile_guestzone_enabled.png" style="width: 60px; margin-left: 20%;"> 
				<span style="vertical-align: 70%"><script>document.write(m_comm_mobile_guest_title);</script></span>
			</div>

			<label for="mobile_gz_24g"><script>document.write(m_comm_mobile_guest_24_status);</script>:</label>
			<select name="mobile_gz_24g" id="mobile_gz_24g" data-role="slider">
				<script type="text/javascript">
					var str = "";
					str += '<option value="0">'+m_comm_mobile_off+'</option>';
					str += '<option value="1">'+m_comm_mobile_on+'</option>';
					document.write(str);
				</script>
			</select>

			<div id="mobile_gz_24g_div" style="display: none;">
				<label for="mobile_gz_24g_ssid" style="padding-top: 10px;"><script>document.write(m_comm_mobile_guest_ssid);</script>:</label>
				<input name="mobile_gz_24g_ssid" id="mobile_gz_24g_ssid" value="" type="text">
				<div id="mobile_gz_24g_ssid_error" style="color:red; display: none;"></div>
			</div>		

			<div id="mobile_gz_24g_key_div" style="display: none;">
				<label for="mbwifi_pswd_24"><script>document.write(m_comm_mobile_wifi_pd);</script>:</label>
				<input name="mbwifi_pswd_24" id="mbwifi_pswd_24" value=""  type="text">
				<div id="mbwifi_pswd_24_error" style="color:red; display: none;"></div>
			</div>			

			<div style="border-bottom: 1px solid #ddd; padding-top: 10px;"></div>

			<label for="mobile_gz_5g"><script>document.write(m_comm_mobile_guest_5_status);</script>:</label>
			<select name="mobile_gz_5g" id="mobile_gz_5g" data-role="slider">
				<script type="text/javascript">
					var str = "";
					str += '<option value="0">'+m_comm_mobile_off+'</option>';
					str += '<option value="1">'+m_comm_mobile_on+'</option>';
					document.write(str);
				</script>
			</select>

			<div id="mobile_gz_5g_div" style="display: none;">
				<label for="mobile_gz_5g_ssid" style="padding-top: 10px;"><script>document.write(m_comm_mobile_guest_ssid);</script>:</label>
				<input name="mobile_gz_5g_ssid" id="mobile_gz_5g_ssid" value="" type="text">
				<div id="mobile_gz_5g_ssid_error" style="color:red; display: none;"></div>
			</div>			

			<div id="mobile_gz_5g_key_div" style="display: none;">
				<label for="mbwifi_pswd_5"><script>document.write(m_comm_mobile_wifi_pd);</script>:</label>
				<input name="mbwifi_pswd_5" id="mbwifi_pswd_5" value=""  type="text">
				<div id="mbwifi_pswd_5_error" style="color:red; display: none;"></div>
			</div>		

			<a href="#positionWindow" id="popup_msg" style="display: none;" class="ui-btn ui-corner-all ui-shadow ui-btn-inline" data-rel="popup" data-position-to="window"></a>
			<div data-role="popup" id="positionWindow" class="ui-content" data-theme="a" data-dismissible="false" style="max-width:400px;">
				<div class="ui-icon-loading" style="width: 46px; height: 46px; margin: 5px auto;"></div>
				<div id="wait_time" style="margin: 5px auto; width: 15px;">60</div>
				<p style="margin: 10px auto; width: 100%;"><script>document.write(m_comm_mobile_wifi_save_wait);</script></p>
			</div>

			<div>
				<button id="btn_login"><script>document.write(m_comm_Save);</script></button>
			</div>

			<div class="copyright">
				<script>document.write(m_comm_copyright);</script>
			</div>

		</div>
	</div>
</body>
</html>