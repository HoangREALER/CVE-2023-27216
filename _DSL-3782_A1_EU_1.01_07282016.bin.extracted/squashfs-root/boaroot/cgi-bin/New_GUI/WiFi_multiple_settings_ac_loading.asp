<%
'save cfg
  If Request_Form("wirelessesavecfgflag_ac")= "1" then
       If Request_Form("wirelesstotalstatusflag_ac")= "1" then
       	TCWebApi_set_Str("WLan11ac_Common","APOn","1")
		TCWebApi_set("WebCurSet_Entry","wlan_ac_id","sssid_ac")
		TCWebApi_set("WLan11ac_Entry","AuthMode","WirelessSecuritytypeValue_ac")
		'ssid status save
		If Request_Form("wirelesseEnablessidflag_ac")= "1" then
				 TCWebApi_set_Str("WLan11ac_Entry","EnableSSID","1")
				 'ssid index 0 set wps
				 if Request_Form("wirelessewpswificfg_ac")= "1" then
					TCWebApi_set_Str("WLan11ac_Entry","WPSConfMode","7")
				  else 
				  	TCWebApi_set_Str("WLan11ac_Entry","WPSConfMode","0")
				  end if
				  	TCWebApi_set_Str("WLan11ac_Entry","WPSConfStatus","2")
				  'hidden ssid status
				  if Request_Form("wirelessehiddenssidflag_ac")= "2" then
					TCWebApi_set_Str("WLan11ac_Entry","HideSSID","1")
				  else
				  	TCWebApi_set_Str("WLan11ac_Entry","HideSSID","0")
				  end if
				  'wmm staus
				  if Request_Form("wirelessewmmstatusflag_ac")= "2" then
					TCWebApi_set_Str("WLan11ac_Entry","WMM","1")
				  else
				  	TCWebApi_set_Str("WLan11ac_Entry","WMM","0")
				  end if
				 'wep3  wpa4
				  if Request_Form("WirelessSecuritytypeFlag_ac")= "3" then
					TCWebApi_set("WLan11ac_Entry","WEPAuthType","lan_wlan_authtype_ac")
					if Request_Form("Wirelesswepkeyflag_ac") = "2" then
						TCWebApi_set_Str("WLan11ac_Entry","DefaultKeyID","2")	
						TCWebApi_set("WLan11ac_Entry","Key2Str","lan_wlan_encryption_B_ac")
					elseif Request_Form("Wirelesswepkeyflag_ac") = "3" then
						TCWebApi_set_Str("WLan11ac_Entry","DefaultKeyID","3")
						TCWebApi_set("WLan11ac_Entry","Key3Str","lan_wlan_encryption_C_ac")
					elseif Request_Form("Wirelesswepkeyflag_ac") = "4" then
						TCWebApi_set_Str("WLan11ac_Entry","DefaultKeyID","4")
						TCWebApi_set("WLan11ac_Entry","Key4Str","lan_wlan_encryption_D_ac")	
					else
						TCWebApi_set_Str("WLan11ac_Entry","DefaultKeyID","1")
						TCWebApi_set("WLan11ac_Entry","Key1Str","lan_wlan_encryption_A_ac")
					end if
				'WirelessSecuritytypeFlag 4 wpa  802.x
				elseif Request_Form("WirelessSecuritytypeFlag_ac")="4" then	  	
					  	TCWebApi_set("WLan11ac_Entry","EncrypType","cipher_type_ac")
					  	TCWebApi_set("WLan11ac_Entry","RekeyInterval","lan_wlan_groupkeyinterval_ac")
					  	TCWebApi_set("WLan11ac_Entry","RADIUS_Server","lan_wlan_serverip_ac")
					  	TCWebApi_set("WLan11ac_Entry","RADIUS_Port","lan_wlan_port_ac")
					  	TCWebApi_set("WLan11ac_Entry","RADIUS_Key","lan_wlan_secret_ac")
				'WirelessSecuritytypeFlag 5 wpa  psk
				elseif Request_Form("WirelessSecuritytypeFlag_ac")="5" then
						TCWebApi_set("WLan11ac_Entry","EncrypType","cipher_type_ac")
					  	TCWebApi_set("WLan11ac_Entry","RekeyInterval","lan_wlan_groupkeyinterval_ac")
					  	TCWebApi_set("WLan11ac_Entry","WPAPSK","lan_wlan_string_ac")			  	
				  end if	
			else
					 TCWebApi_set_Str("WLan11ac_Entry","EnableSSID","0")
		end if
		else
		TCWebApi_set_Str("WLan11ac_Common","APOn","0")
	end if
		'close the wps
		If Request_Form("closewpsflag_ac")="1" Then
			TCWebApi_set_Str("WLan11ac_Entry","WPSConfMode","0")
		end if
		TCWebApi_commit("WLan11ac")
  end If
  
'advance wireless multiple
 If Request_Form("savecfgflag_ac")= "save" then
		TCWebApi_set("WebCurSet_Entry","wlan_ac_id","savessidindex_ac")
		TCWebApi_set("WLan11ac_Entry","SSID","lan_mgmt_multiple_ssid")
		TCWebApi_set_Str("WLan11ac_Entry","EnableSSID","1")
		TCWebApi_set_Str("WLan11ac_Entry","SSIDON","1")
		TCWebApi_set_Str("WLan11ac_Entry","HideSSID","0")
		TCWebApi_set_Str("WLan11ac_Entry","AuthMode","OPEN")
		TCWebApi_set_Str("WLan11ac_Entry","EncrypType","NONE")
		TCWebApi_set_Str("WLan11ac_Entry","RADIUS_Server","192.168.7.203")
		TCWebApi_set_Str("WLan11ac_Entry","RADIUS_Port","1812")
		TCWebApi_set_Str("WLan11ac_Entry","RADIUS_Key","12345678")
		TCWebApi_set_Str("WLan11ac_Entry","BAK_RADIUS_Server","")
		TCWebApi_set_Str("WLan11ac_Entry","BAK_RADIUS_Port","")
		TCWebApi_set_Str("WLan11ac_Entry","BAK_RADIUS_Key","")
		TCWebApi_set_Str("WLan11ac_Entry","AccessPolicy","0")
		TCWebApi_set_Str("WLan11ac_Entry","WMM","0")
		TCWebApi_set_Str("WLan11ac_Entry","HT_MCS","33")
		TCWebApi_set_Str("WLan11ac_Entry","WPSConfStatus","1")	
		TCWebApi_set_Str("WLan11ac_Entry","WPSMode","1")	
		TCWebApi_set_Str("WLan11ac_Entry","WscDefaultSSID1","Ralink_AP")	
		TCWebApi_set_Str("WLan11ac_Entry","WPSKeyASCII","8")	
		TCWebApi_set_Str("WLan11ac_Entry","WPSConfMode","0")	
		TCWebApi_set_Str("WLan11ac_Entry","WscV2Support","0")	
		TCWebApi_set_Str("WLan11ac_Entry","IgmpSnEn","1")	
		TCWebApi_set_Str("WLan11ac_Entry","KeyPassphrase","")	
		TCWebApi_set_Str("WLan11ac_Entry","RekeyInterval","10")	
		TCWebApi_set_Str("WLan11ac_Entry","WEPAuthType","WEPAuto")
		TCWebApi_set_Str("WLan11ac_Entry","HT_RATE","0")
		TCWebApi_set_Str("WLan11ac_Entry","NoForwarding","0")
		TCWebApi_set_Str("WLan11ac_Entry","DefaultKeyID","1")	
		TCWebApi_commit("WLan11ac_Entry")
		
elseif Request_Form("savecfgflag_ac")= "edit" then
		TCWebApi_set("WebCurSet_Entry","wlan_ac_id","savessidindex_ac")
		TCWebApi_set("WLan11ac_Entry","SSID","lan_mgmt_multiple_ssid")
		TCWebApi_commit("WLan11ac_Entry")
	 
elseif Request_Form("savecfgflag_ac")= "delete" then
	If Request_Form("enable_0")="1" then
		TCWebApi_unset("WLan11ac_Entry0")
		TCWebApi_set_Str("WLan11ac_Entry0","EnableSSID","0")
		TCWebApi_set_Str("WLan11ac_Entry0","SSIDON","0")
		TCWebApi_commit("WLan11ac_Entry0")

	End If
	If Request_Form("enable_1_ac")="1" then
		TCWebApi_unset("WLan11ac_Entry1")
		TCWebApi_set_Str("WLan11ac_Entry1","EnableSSID","0")
		TCWebApi_set_Str("WLan11ac_Entry1","SSIDON","0")
		TCWebApi_commit("WLan11ac_Entry1")

	End If
	If Request_Form("enable_2_ac")="1" then
		TCWebApi_unset("WLan11ac_Entry2")
		TCWebApi_set_Str("WLan11ac_Entry2","EnableSSID","0")
		TCWebApi_set_Str("WLan11ac_Entry2","SSIDON","0")
		TCWebApi_commit("WLan11ac_Entry2")

	End If
	If Request_Form("enable_3_ac")="1" then
		TCWebApi_unset("WLan11ac_Entry3")
		TCWebApi_set_Str("WLan11ac_Entry3","EnableSSID","0")
		TCWebApi_set_Str("WLan11ac_Entry3","SSIDON","0")
		TCWebApi_commit("WLan11ac_Entry3")

	End If
end if
%>
<html>
	<head>
		<meta http-equiv=Content-Type content="text/html; charset=utf-8">
		<meta http-equiv=Content-Type content="no-cache">

		<link rel="stylesheet" href="/layout/alpha.css" type="text/css">

		<script src="/LanguageFamily/en/menu.js" type="text/javascript"></script>
		<script src="/LanguageFamily/en/msg_comm.js" type="text/javascript"></script>
		<script src="/public/__menu.js" type="text/javascript"></script>
		<script src="/public/__all_need.js" type="text/javascript"></script>
		<script src="/public/__button.js" type="text/javascript"></script>
		<script src="/public/__comm.js" type="text/javascript"></script>
		<script src="/public/__js_comm.js" type="text/javascript"></script>
		<script src="/public/__ip.js" type="text/javascript"></script>
		<script src="/public/__display.js" type="text/javascript"></script>
		
	</head>

<script language=javascript>
/***********TK*********
var wireless_action="<?echo $wireless_action;?>";
var wireless_autochannel="<?echo $autochannelenable;?>";

var wireless_action="";
var wireless_autochannel="";

var wireless_action="<?echo $wireless_action;?>";
var wireless_autochannel="<?echo $autochannelenable;?>";
*/

//var wireless_action="<?echo $wireless_action;?>";
var wireless_autochannel="";

	
var countdown=0;
var countdown2=0;
var currentURL=document.location.search;

function uiDoOnLoad()
{
	if (wireless_autochannel==1)
		countdown=11;
	else
		countdown=6;
	setInterval('test()',1000);
}

function test()
{
    if(countdown!=0)
    countdown--;
    
    document.frm.WaitInfo.value=countdown;
    if ((countdown == 0) && (countdown2 ==0))
    {
    	countdown2=1;
       returnToHome();
       }
}

function slip_url(original_url)
{
	var url = original_url;
	while(url.indexOf('?')!=-1)
	{
		j=url.indexOf('?')+1;
		url=url.substring(j,url.length);
	}
	return url;
}

function returnToHome() 
{
	var urlvalue=currentURL.split("=");
       
	if(currentURL.indexOf("ad_multiple_wlan")!=-1)
		self.location.href="ad_multiple_wlan.asp";
	else
		self.location.href="ad_wireless_setup.asp";

}
</script>

<body class="mybody" onload="uiDoOnLoad();">

<form name="frm" id="frm" METHOD="POST">

<!-- logo menu -->
	<script src="/cgi-bin/layout/_product.asp" type="text/javascript"></script>
<!-- logo menu -->
<table border="0" cellpadding="2" cellspacing="1" width="838" align="center" bgcolor="#FFFFFF" bordercolordark="#000033">
<tr valign=top>
	<td width=10%></td>
	<td id="maincontent" width=80%>
		<br>
		<div id="box_header" >
		
		<h1>Setup Complete!</h1>
		The Wireless is restarting.....<br><br>
		Please <font color=red>Don't Power Off.</font><br><br>
		And please wait for
		<input type='Text' readonly name='WaitInfo' value='' size='2' style='border-width:0; background-color=#DFDFDF; color:#FF3030; text-align:center'>
		seconds...

<!-- ________________________________ Main Content Start ______________________________ -->

<!-- ________________________________  Main Content End _______________________________ -->
		</div>
		<br>
	</td>
	<td width=10%></td>
</tr>
</table>

	<!--tail and copyright -->
	<script src="/cgi-bin/layout/_copyright.asp" type="text/javascript"></script>
	<!--tail and copyright -->
	</div>

</form>
</body>
</html>