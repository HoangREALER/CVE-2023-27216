<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns= "http://www.w3c.org/1999/xhtml">
<head>
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/css">
<link rel=stylesheet type="text/css" href="/layout/New_GUI/jquery.selectbox.css?v=20140910163551" />
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJQ.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>
<!--<script src="/LanguageFamily/en/msg_multipe.js" type="text/javascript"></script>-->

<script>
	var admin_val = {
		"Password": "@&~*#()<>xdbgyyzor@&^%*!####"
	};
	
	$(document).ready(function(){
		$("#admPass1").val(admin_val.Password);
		$("#admPass2").val(admin_val.Password);
	});

	var save_flag = false;
	var _ReciprocalNumber = 10;
	function Start_reciprocal_Number_RestoreConfiguration() {
		if (_ReciprocalNumber >= 0) {
			document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", m_comm_Sec);
			_ReciprocalNumber --;
			setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
		} else {
			if(save_flag) {
				document.getElementById("waitSettingFinish").style.display = "none";
				document.getElementById("SuccessSettings").style.display = "inline";
			} else {
				setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
			}
		}
	}

	function Prefixes_Rule_cgi_num(TelNum){
		for (var i=0; i<TelNum.length; i++) {  
			if(TelNum.charCodeAt(i)<48 || TelNum.charCodeAt(i)>122) 
				return false;
			else {
				if(TelNum.charCodeAt(i)>57 && TelNum.charCodeAt(i)<65) 
					return false;
				if(TelNum.charCodeAt(i)>90 &&TelNum.charCodeAt(i)<97)
					return false;
			}
	 	}
		return true;
	}
</script>

<script type="text/javascript">
	function Load_HTML()	{	$("#header").load("header.asp");	}
	function Initial() {
		initialMenu();
	}
	function GetXML()	{	document.getElementById("main").style.display = "inline";	}
</script>
<script language="JavaScript">
	$(function() {
		$("select").change(function () {	save_button_changed();	});
		$("input").keydown(function () {	save_button_changed();	});

		$("input[type='password']").each(function() {	$(this).parent().append("<label id='"+$(this).attr("id")+"_error' name='"+$(this).attr("id")+"_error' class='error'></label>");	});
		
		$("#Save_btn").click(function() {
			$("label[class='error']").html("");
			var pass1 = $("#admPass1").val();
			if(pass1 != admin_val.Password) {
				if ((pass1.length ==0) || (pass1.length > 15) || (!Prefixes_Rule_cgi_num(pass1))) {
					$("#admPass1_error").html("<br/>"+m_admin_error1);
					return;
				}
			}

			if(pass1!=$("#admPass2").val()) {
				$("#admPass2_error").html("<br/>"+m_admin_error2);
				return;
			}

			admin_val.Password = pass1;

			document.getElementById("CreatePopAlertMessage").style.display = "inline";
			document.getElementById("waitSettingFinish").style.display = "inline";
			Start_reciprocal_Number_RestoreConfiguration();

			$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey){
				admin_val.sessionKey = sessionKey;
				setTimeout('$.post("/cgi-bin/New_GUI/Set/Admin.asp", admin_val, function(){save_flag = true;});', 300);
			});		
		});
	});
	function save_button_changed() {
		document.getElementById("Save_Disable_btn").style.display = "none";
		document.getElementById("Save_btn").style.display = "block";
		changeFlag = true;
		checkFlag = true;
	}
</script>
</head>

<body>
	<div id="wrapper">
		<!-------------------- Logo ------------------------->
		<div id="header"></div>
		<!-------------------- Menu ------------------------->
		<div id="menu"></div>
		<div id="menu_edge"></div>
		<!-------------------- Content ---------------------->
		<div id="content">
			<!-------------------- info ---------------------->
	  		<div id="info">
			  	<div id="FunctionName"><script>prints(m_comm_Admin);</script></div>
			  	<div id="wall"><img id="page_Admin" src="/graphic/New_GUI/page_Admin.png?v=20140910163551" alt="" width="195" height="119"/></div>
			    <div id="directions">
					<script>prints(m_admin_desc);</script>
					<label id="Get_Help" onClick="showOnlineHelp('Admin');" style="cursor:pointer;display:none;text-Decoration:underline"><script>prints(m_comm_clickhelp);</script></label>
				</div>
			</div>
		    <!-------------------- funcBar ---------------------->
		    <div id="funcBar">
				<div id="pagePath"><script>prints(m_comm_Managment);</script> >> <script>prints(m_comm_Admin);</script></div>
				<ul id="rightFunc">
					<li style="display:block"><div id="Save_btn" style="cursor:pointer; display:none"><script>prints(m_comm_Save);</script></div></li>
					<li style="display:block"><div id="Save_Disable_btn"><script>prints(m_comm_Save);</script></div></li>
					<li style="display:block"><a href="javascript:CheckHTMLStatus('System');" style="text-decoration:none;"><div id="page_btn" class="linkstyle_1"><script>prints(m_systme_header);</script></div></a></li>
				</ul>
			</div>
	    	<!-------------------- main ------------------------->
	     	<div id="main" style="display:none">
 		   		<!-------------------- general ---------------------->
 		   		<form name="adminpassword_Settings" id="adminpassword_Settings" method="POST" action=""> 		   		
				<table class="block" border="0" style="margin: 10px 0 0 0 ;">
				<tbody>
					 <tr>
						<td colspan="2"><div class ="title"><script>prints(m_admin_adminsetting);</script></div></td
					 </tr>
					<!-- <tr>
				     	<th><script>prints(m_admin_User);</script>:</th>
				     	<td><input class="styled-text" type="text" name="puser" id="puser" disabled="disabled" size="30"></td>
				     </tr>-->
				   	 <tr>
				     	<th><script>prints(m_comm_pwd);</script>:</th>
				     	<td><input class="styled-text" type="password" name="admPass1" size="30" id="admPass1" maxlength="32" autocomplete="off"></td>
				     </tr>
				     <tr>
				     	<th><script>prints(m_comm_confirmpwd);</script>:</th>
				     	<td><input class="styled-text" type="password" name="admPass2" size="30" id="admPass2" maxlength="32" autocomplete="off"></td>
				     </tr>
				</tbody>
			    </table>
			   	</form>			   
		 	</div>
			<div id="CreatePopAlertMessage" style="display:none">
				<div id="AlertPopRect">
					<div id="AlertPopBody">
						<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Loading_pop_image2"></div></center>
									</td>
								 </tr>
								 <tr>
								 	<td><center><label id="reciprocal_Number">10</label></center></td>
								 </tr>
								 <tr>
								 	<td id="dialog_msg_black2"><script>I18N("h", m_comm_changesdesc);</script></td>
								 </tr>
						   </tbody>
						</table>
						<table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0"  style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Information_pop_image"></div></center>
									</td>
								 </tr>
								 <tr>
									 <td>
									 	<div id="dialog_msg_black"><script>I18N("h", m_comm_settingsave);</script></div>
									 </td>
								 </tr>
								 <tr>
									 <td>
									 	<center><div id="Confirm_btn" onclick="javascript: self.location.href = self.location.href;" style="cursor:pointer"><script>I18N("h", m_comm_ok);</script></div></center>
									 </td>
								 </tr>
						   </tbody>
						</table>
					</div>
				</div>
			</div>		
		 <div id="DetectRouterConnection" style="display:none"></div>
		 <div id="footer">
			<div id="copyright"><script>I18N("h", m_comm_copyright);</script></div>
			<div id="help">
                <a target="_blank" href="http://www.dlink.com/support" style="cursor:pointer;text-Decoration:underline">
	                
	                    <script>
	                    prints(m_home_gethelp);
	                    </script>                  
	                
                </a>
            </div>
		 </div>
	</div>
<script type="text/javascript" charset="utf-8">
	$(document).ready( function() {
		$.validator.addMethod("checkDevicePassword", function( value, element ) {
			var returnVal = true;
			if (value.length > 15 || value.length < 6)	{	returnVal = false;	}
			return returnVal;
		}, jQuery.validator.messages.check_DeviceAdminPassword);
		
		$('#adminpassword_Settings').validate({
			rules: {
				password_Admin:	{	required: true,	checkDevicePassword: true	}
			},
			messages: {
				password_Admin:	{	required: jQuery.validator.messages.check_Password	}
			},
			submitHandler: function(form)	{	CheckConnectionStatus();	}
		});
	});
</script>
</body>
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Management");
	GetXML();
</script>
</html>
