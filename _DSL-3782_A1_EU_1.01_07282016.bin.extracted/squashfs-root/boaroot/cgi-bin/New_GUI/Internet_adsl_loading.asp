<%
if Request_Form("submitWANType")="apply" then
	if Request_Form("wanType")="0" then
		TcWebApi_Set_Str("Wan_Common","TransMode","ATM")
		TcWebApi_Set_Str("Wan_Common","WanMode","ADSL")
	elseif Request_Form("wanType")="1" then
		TcWebApi_Set_Str("Wan_Common","TransMode","Ethernet")
		TcWebApi_Set_Str("Wan_Common","WanMode","Fibre")
		TcWebApi_Set_Str("WebCurSet_Entry","wan_pvc","10")
		TcWebApi_Set_Str("WebCurSet_Entry","wan_pvc_ext","0")
	elseif Request_Form("wanType")="2" then
		TcWebApi_Set_Str("Wan_Common","TransMode","3G")
		TcWebApi_Set_Str("Wan_Common","WanMode","3G")
    elseif Request_Form("wanType")="4" then
        TcWebApi_Set_Str("Wan_Common","TransMode","PTM")
        TcWebApi_Set_Str("Wan_Common","WanMode","VDSL")
        TcWebApi_Set_Str("WebCurSet_Entry","wan_pvc","8")
        TcWebApi_Set_Str("WebCurSet_Entry","wan_pvc_ext","0")
	else
		TcWebApi_Set_Str("Wan_Common","WanMode","Auto")
	End if

	if Request_Form("isType")="0" then
		TCWebApi_commit("Wan_Common")
	elseif Request_Form("isType")="1" then
		if Request_Form("isPage")<>"4" then
			if tcWebApi_get("Wan_PVC","ISP","h") = "0" then
				TCWebApi_commit("SysInfo_Entry")
			end if

			if tcWebApi_get("Wan_PVC","ISP","h") = "1" then
				if tcWebApi_get("SysInfo_Entry","IPv6_flag","h") = "1" then
					if tcWebApi_get("Dhcp6s_Entry","Mode","h") = "0" then
						TCWebApi_commit("Dhcp6s_Entry")
					end if
				end if
				TCWebApi_commit("Wan_PVC")
			end if
			TCWebApi_commit("Wan_PVC")
		else
			TCWebApi_commit("Dongle_Entry")
		end if	
	end if
End if

if Request_Form("submitType")="apply" then
	If Request_Form("uiViewConState_ck")="Yes" then
		TcWebApi_Set_Str("Wan_PVC","Active","Yes")
		TcWebApi_set("Wan_PVC","VPI","uiViewPvcVpi")
		TcWebApi_set("Wan_PVC","VCI","uiViewPvcVci")
		TcWebApi_set("Wan_PVC","QOS","uiViewQosS")
		TcWebApi_set("Wan_PVC","PCR","uiViewPvcPcr")
		TcWebApi_set("Wan_PVC","SCR","uiViewPvcScr")
		TcWebApi_set("Wan_PVC","MBS","uiViewPvcMbs")
		if Request_Form("vlanid_switch")="Yes" then
			TcWebApi_Set_Str("Wan_PVC","dot1q","Yes")
			TcWebApi_set("Wan_PVC","VLANID","vlanid")
		else
			TcWebApi_Set_Str("Wan_PVC","dot1q","No")
			TcWebApi_Set_Str("Wan_PVC","VLANID","0")
		End if
		
		if Request_Form("connType")="1" then
			TcWebApi_set("Wan_PVC","MSS","adsl_mss")
			TcWebApi_set("Wan_PVC","MTU","dynamic_mtu")
			TcWebApi_set("Wan_PVC","NATENABLE","dynamic_nat_tmp")
			TcWebApi_set("Wan_PVC","BridgeInterface","dynamic_PPPoEPassthrough_tmp")
			TcWebApi_Set("Wan_PVC","ENCAP","dynamic_uiViewEncaps")
			TcWebApi_Set("Wan_PVC","DEFAULTROUTE","dynamic_DefaultRoute")
			TcWebApi_Set_Str("Wan_PVC","ISP","0")
			'save dhcp option60 venderid
			
		elseif Request_Form("connType")="2" then
			TcWebApi_set("Wan_PVC","MSS","adsl_mss")
			TcWebApi_set("Wan_PVC","MTU","static_mtu")
			TcWebApi_set("Wan_PVC","NATENABLE","static_nat_tmp")
			TcWebApi_set("Wan_PVC","IPADDR","static_ip")
			TcWebApi_set("Wan_PVC","NETMASK","static_mask")
			TcWebApi_set("Wan_PVC","GATEWAY","static_gateway")
			TcWebApi_Set("Wan_PVC","ENCAP","static_uiViewEncaps")
			TcWebApi_Set("Wan_PVC","DEFAULTROUTE","static_DefaultRoute")
			if Request_Form("pppoe_save_flag")="1" then
				TcWebApi_set("Wan_PVC","BridgeInterface","static_PPPoEPassthrough_tmp")
			end if
			TcWebApi_Set_Str("Wan_PVC","ISP","1")
		elseif Request_Form("connType")="3" then
			TcWebApi_set("Wan_PVC","MSS","adsl_mss")
			TcWebApi_set("Wan_PVC","MTU","pppoe_mtu")
			TcWebApi_set("Wan_PVC","NATENABLE","pppoe_nat_tmp")
			TcWebApi_set("Wan_PVC","BridgeInterface","pppoe_PPPoEPassthrough_tmp")
			TcWebApi_set("Wan_PVC","USERNAME","pppoe_name")
			TcWebApi_set("Wan_PVC","PASSWORD","pppoe_pass")

			TcWebApi_Set_Str("WebCurSet_Entry","wan_pvc","10")
			TcWebApi_set("WebCurSet_Entry","wan_pvc_ext","pvcid")
			TcWebApi_set("Wan_PVC","USERNAME","pppoe_name")
			TcWebApi_set("Wan_PVC","PASSWORD","pppoe_pass")
			TcWebApi_set("WebCurSet_Entry","wan_pvc","pvcid")

			if Request_Form("pppoe_radio_connect")="Connect_Keep_Alive" then
				TcWebApi_Set_Str("Wan_PVC","CONNECTION","Connect_Keep_Alive")
			elseif Request_Form("pppoe_radio_connect")="Connect_Manually" then
				TcWebApi_Set_Str("Wan_PVC","CONNECTION","Connect_Manually")
			else
				TcWebApi_Set_Str("Wan_PVC","CONNECTION","Connect_on_Demand")
				TcWebApi_set("Wan_PVC","CLOSEIFIDLE","pppoe_max_time")
			End if
			TcWebApi_Set("Wan_PVC","AUTHEN","pppoe_auth_protocol")
			TcWebApi_Set("Wan_PVC","ENCAP","pppoe_conn_type")
			TcWebApi_Set("Wan_PVC","DEFAULTROUTE","pppoe_DefaultRoute")
			TcWebApi_Set("Wan_PVC","SRVNAME","pppoe_srv_name")
			TcWebApi_Set("Wan_PVC","CANAME","pppoe_ac_name")
			TcWebApi_Set_Str("Wan_PVC","ISP","2")
		elseif Request_Form("connType")="4" then
			TcWebApi_set("Wan_PVC","MSS","adsl_mss")
			TcWebApi_set("Wan_PVC","MTU","pppoa_mtu")
			TcWebApi_set("Wan_PVC","NATENABLE","pppoa_nat_tmp")
			TcWebApi_set("Wan_PVC","USERNAME","pppoa_name")
			TcWebApi_set("Wan_PVC","PASSWORD","pppoa_pass")

			TcWebApi_Set_Str("WebCurSet_Entry","wan_pvc","10")
			TcWebApi_set("WebCurSet_Entry","wan_pvc_ext","pvcid")
			TcWebApi_set("Wan_PVC","USERNAME","pppoa_name")
			TcWebApi_set("Wan_PVC","PASSWORD","pppoa_pass")
			TcWebApi_set("WebCurSet_Entry","wan_pvc","pvcid")
			
			if Request_Form("pppoa_radio_connect")="Connect_Keep_Alive" then
				TcWebApi_Set_Str("Wan_PVC","CONNECTION","Connect_Keep_Alive")
			elseif Request_Form("pppoa_radio_connect")="Connect_Manually" then
				TcWebApi_Set_Str("Wan_PVC","CONNECTION","Connect_Manually")
			else
				TcWebApi_Set_Str("Wan_PVC","CONNECTION","Connect_on_Demand")
				TcWebApi_set("Wan_PVC","CLOSEIFIDLE","pppoa_max_time")
			End if
			TcWebApi_Set("Wan_PVC","ENCAP","pppoa_conn_type")
			TcWebApi_Set("Wan_PVC","AUTHEN","pppoa_auth_protocol")
			TcWebApi_Set("Wan_PVC","DEFAULTROUTE","pppoa_DefaultRoute")
			TcWebApi_Set_Str("Wan_PVC","ISP","2")
		else
			TcWebApi_Set("Wan_PVC","ENCAP","bridge_uiViewEncaps")
			TcWebApi_Set_Str("Wan_PVC","ISP","3")
			if Request_Form("BridgeElppEnable")="Yes" then
				TcWebApi_Set_Str("Wan_PVC","MTU","1516")
			else
				TcWebApi_Set_Str("Wan_PVC","MTU","1500") 
			End if
		End if
		TcWebApi_Set_Str("Wan_PVC","PPPGETIP","Dynamic")
	else
		TcWebApi_Set_Str("Wan_PVC","Active","No")
		TcWebApi_Set_Str("Wan_PVC","PPPGETIP","Dynamic")
	End If
	'dhcp ipv6
	if Request_Form("connType")="1" then
		If Request_Form("DHCPIPv6Enable") = "IPv4/IPv6" Then  
			TcWebApi_Set_Str("Wan_PVC","IPVERSION","IPv4/IPv6")
		  	tcWebApi_set("Wan_PVC","EnableDynIPv6","DynIPv6EnableRadio")		  
		  	if request_Form("DynIPv6EnableRadio") = "1" then
				tcWebApi_set("Wan_PVC","MLDproxy","wan_MLD0")	
		  	else 
			 	tcWebApi_set("Wan_PVC","MLDproxy","No")
		  	end if 
		  	if request_Form("IPv6PrivacyAddrsSupportedFlag") = "Yes" then
				if request_Form("DynIPv6EnableRadio") = "0" then
					tcWebApi_set("Wan_PVC","IPv6Extension","privacyaddrsradio0")		
				end if  
		  	end if

		  	if tcwebApi_get("WebCustom_Entry","isRipngSupported","h") = "Yes" then
				TCWebApi_set("Wan_PVC","RIPNGENABLE","ripngEnableRadio0")
				If Request_Form("ripngEnableRadio0") = "1" Then 
					CWebApi_set("Wan_PVC","RIPNGDIRECTION","wan_Ripng_Dir0")
				End if
		  	end if
		  	tcWebApi_set("Wan_PVC","PPPv6PD","PPPIPv6PDRadio0")
		else
			TcWebApi_Set_Str("Wan_PVC","IPVERSION","IPv4")
		End if		
	End if
	'static ipv6
	if Request_Form("connType")="2" then
		If Request_Form("StaticIPv6Enable") = "IPv4/IPv6" Then  
			TcWebApi_Set_Str("Wan_PVC","IPVERSION","IPv4/IPv6")
			tcWebApi_set("Wan_PVC","IPADDR6","wan_IPv6Addr")			
  			tcWebApi_set("Wan_PVC","PREFIX6","wan_IPv6Prefix")
  			tcWebApi_set("Wan_PVC","DEFGATEWAY6","wan_IPv6DefGw")
			tcWebApi_set("Wan_PVC","DNSIPv61st","wan_IPv6DNS1")
			tcWebApi_set("Wan_PVC","DNSIPv62nd","wan_IPv6DNS2")
			tcWebApi_set("Wan_PVC","MLDproxy","wan_MLD1")

			if tcwebApi_get("WebCustom_Entry","isRipngSupported","h") = "Yes" then
				TCWebApi_set("Wan_PVC","RIPNGENABLE","ripngEnableRadio1")
				If Request_Form("ripngEnableRadio1") = "1" Then 
					TCWebApi_set("Wan_PVC","RIPNGDIRECTION","wan_Ripng_Dir1")
				End if
			end if
			
			
			If Request_Form("DHCP6SMode_Flag") = "0" Then 
				tcWebApi_set("Dhcp6s_Entry","DNSserver","wan_IPv6DNS1")
				tcWebApi_set("Dhcp6s_Entry","SecDNSserver","wan_IPv6DNS2")
			End If
		else
			TcWebApi_Set_Str("Wan_PVC","IPVERSION","IPv4")			
		End if	  		
	End if
	'pppipv6
	if Request_Form("connType")="3" then
		If Request_Form("PPPIPv6Enable") = "IPv4/IPv6" Then
			TcWebApi_Set_Str("Wan_PVC","IPVERSION","IPv4/IPv6")
			tcWebApi_set("Wan_PVC","PPPv6Mode","PPPDHCPv6Mode_Flag")
			tcWebApi_set("Wan_PVC","PPPv6PD","PPPIPv6PDRadio2")	
			if request_Form("IPv6PrivacyAddrsSupportedFlag") = "Yes" then
				if request_Form("PPPDHCPv6Mode_Flag") = "0" then 
			 		 tcWebApi_set("Wan_PVC","IPv6Extension","privacyaddrsradio2")		
				end if  
	  		end if
			tcWebApi_set("Wan_PVC","MLDproxy","wan_MLD2")
			if tcwebApi_get("WebCustom_Entry","isRipngSupported","h") = "Yes" then
				TCWebApi_set("Wan_PVC","RIPNGENABLE","ripngEnableRadio2")
				If Request_Form("ripngEnableRadio2") = "1" Then 
					TCWebApi_set("Wan_PVC","RIPNGDIRECTION","wan_Ripng_Dir2")
				End if
			end if
		else
			TcWebApi_Set_Str("Wan_PVC","IPVERSION","IPv4")			
		End if		
	End if
	if Request_Form("connType")="4" then
		If Request_Form("PPPIPv6Enable") = "IPv4/IPv6" Then 
			TcWebApi_Set_Str("Wan_PVC","IPVERSION","IPv4/IPv6")			
			tcWebApi_set("Wan_PVC","PPPv6Mode","PPPDHCPv6Mode_Flag")
			tcWebApi_set("Wan_PVC","PPPv6PD","PPPIPv6PDRadio2")	
			if request_Form("IPv6PrivacyAddrsSupportedFlag") = "Yes" then
				if request_Form("PPPDHCPv6Mode_Flag") = "0" then 
			 		 tcWebApi_set("Wan_PVC","IPv6Extension","privacyaddrsradio2")		
				end if  
	  		end if			
			tcWebApi_set("Wan_PVC","MLDproxy","wan_MLD2")

			if tcwebApi_get("WebCustom_Entry","isRipngSupported","h") = "Yes" then
				TCWebApi_set("Wan_PVC","RIPNGENABLE","ripngEnableRadio2")
				If Request_Form("ripngEnableRadio2") = "1" Then 
					TCWebApi_set("Wan_PVC","RIPNGDIRECTION","wan_Ripng_Dir2")
				End if
			end if
		else
			TcWebApi_Set_Str("Wan_PVC","IPVERSION","IPv4")				
		End if		
	End if
	if Request_Form("isType")="0" then
		TCWebApi_commit("Wan_Common")
	elseif Request_Form("isType")="1" then
		if Request_Form("isPage")<>"4" then
			if tcWebApi_get("Wan_PVC","ISP","h") = "0" then
				TCWebApi_commit("SysInfo_Entry")
			end if

			if tcWebApi_get("Wan_PVC","ISP","h") = "1" then
				if tcWebApi_get("SysInfo_Entry","IPv6_flag","h") = "1" then
					if tcWebApi_get("Dhcp6s_Entry","Mode","h") = "0" then
						TCWebApi_commit("Dhcp6s_Entry")
					end if
				end if
				TCWebApi_commit("Wan_PVC")
			end if
			TCWebApi_commit("Wan_PVC")
		else
			TCWebApi_commit("Dongle_Entry")
		end if	
	end if
End If

%>

