<%
If Request_Form("SaveTime") = "1" Then	
	TCWebApi_set_Str("WLan_Entry0","uptime","N/A") 
	TCWebApi_set_Str("WLan_Entry1","uptime","N/A") 
	TCWebApi_set_Str("WLan_Entry2","uptime","N/A") 
	TCWebApi_set_Str("WLan_Entry3","uptime","N/A") 
	TCWebApi_set("Timezone_Entry","TZ","uiViewdateToolsTZ") 
	TCWebApi_set("Timezone_Entry","DAYLIGHT","uiViewdateDSValue") 
	TCWebApi_set("Timezone_Entry","SERVER","uiViewSNTPServer")
	If Request_Form("ntp2ServerFlag") = "Yes" Then
		TCWebApi_set("Timezone_Entry","SERVER2","uiViewSNTPServer2")
	elseif Request_Form("ntp3ServerFlag") = "Yes" Then
		TCWebApi_set("Timezone_Entry","SERVER2","uiViewSNTPServer2")
		TCWebApi_set("Timezone_Entry","SERVER3","uiViewSNTPServer3")
	end if	
	TCWebApi_set("Timezone_Entry","TYPE","uiViewSyncWith")
	If Request_Form("uiViewSyncWith") = "1" Then
		TCWebApi_set("Timezone_Entry","PC_CLOCK","uiCurrentTime")
		TCWebApi_set("Timezone_Entry","TYPE","uiViewSyncWith")
	End if	

	If Request_Form("uiViewSyncWith") = "2" Then
		TCWebApi_set("Timezone_Entry","TYPE","uiViewSyncWith")
		TcWebApi_set("Timezone_Entry","Year","uiPCdateYear")
		TcWebApi_set("Timezone_Entry","Month","uiPCdateMonth")
		TcWebApi_set("Timezone_Entry","Date","uiPCdateDay")
		TcWebApi_set("Timezone_Entry","Hour","uiPCdateHour")
		TcWebApi_set("Timezone_Entry","Min","uiPCdateMinute")
		TcWebApi_set("Timezone_Entry","Sec","uiPCdateSec")
	End if		
	
	tcWebApi_commit("Timezone_Entry")

End if

If Request_Form("uiViewSyncWith") <> "" Then
	If Request_Form("uiViewSyncWith") = "0" Then
		TCWebApi_set("Timezone_Entry","TYPE","uiViewSyncWith")
		TCWebApi_set("Timezone_Entry","PCSyncFlag","uiClearPCSyncFlag")
	End if
	If Request_Form("uiViewSyncWith") = "1" Then
		TCWebApi_set("Timezone_Entry","TYPE","uiViewSyncWith")
		If Request_Form("uiRadioValue") = "1" Then
			TCWebApi_set("Timezone_Entry","PC_CLOCK","uiCurrentTime")
			TCWebApi_set("Timezone_Entry","PCSyncFlag","uiClearPCSyncFlag")
			tcWebApi_commit("Timezone_Entry")
		End if
	End if	

	If Request_Form("uiViewSyncWith") = "2" Then
		TCWebApi_set("Timezone_Entry","TYPE","uiViewSyncWith")
		TCWebApi_set("Timezone_Entry","PCSyncFlag","uiClearPCSyncFlag")
	End if		
End if
%>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns= "http://www.w3c.org/1999/xhtml">

<head>
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/css">
<link rel=stylesheet type="text/css" href="/layout/New_GUI/jquery.selectbox.css?v=20140910163551" />
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJQ.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/ip.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/__comm.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/__js_comm.js?v=20140910163551"></script>
<!--<script src="/LanguageFamily/en/msg_multipe.js" type="text/javascript"></script>-->

<!-- get -->
<script src="/cgi-bin/get/New_GUI/Time.asp" type="text/javascript"></script>
<!-- get -->

<!-- js -->
<script src="/js/New_GUI/Management/Time.js" type="text/javascript"></script> 
<!-- js -->

<script type="text/javascript">
	function Load_HTML()	{	$("#header").load("header.asp");	}
	function Initial()
	{
		initialMenu();
	}
	function GetXML()	{
		document.getElementById("main").style.display = "inline";	
	}
</script>

<script type="text/javascript" language="JavaScript">	

	$(function() {
		$("input,select").change(function () {	save_button_changed();	});
		$("input").keydown(function () {	save_button_changed();	});
		$("#uiViewSyncWith0,#uiViewSyncWith1,#uiViewSyncWith2").click(function () {	save_button_changed();	});
	});
	function save_button_changed()
	{
		document.getElementById("Save_Disable_btn").style.display = "none";
		document.getElementById("Save_btn").style.display = "block";
		changeFlag = true;
		checkFlag = true;
	}		
	
	$(document).ready( function() {
		var timeZ = "<%TCWebApi_get("Timezone_Entry","TZ","s")%>";
		var num = "<%TCWebApi_get("Timezone_Entry","TYPE","s")%>";
		var ntp1 = "<%TCWebApi_get("Timezone_Entry","SERVER","s")%>";
		var ntp2 = "<%TCWebApi_get("Timezone_Entry","SERVER2","s")%>";
		var ntp3 = "<%TCWebApi_get("Timezone_Entry","SERVER3","s")%>";
		$("#uiViewSNTPServer").val(decodeSpecialChr(ntp1));
		<% if TCWebApi_get("WebCustom_Entry","is2NTPServerSupported","h") = "Yes" then%>
			$("#uiViewSNTPServer2").val(decodeSpecialChr(ntp2));
		<%elseif TCWebApi_get("WebCustom_Entry","is3NTPServerSupported","h") = "Yes" then%>
			$("#uiViewSNTPServer3").val(decodeSpecialChr(ntp3));
		<%end if%>
		$("#uiViewdateToolsTZ").val(decodeSpecialChr(timeZ));
		$("#uiViewdateToolsTZ").selectbox({width:600});
		uiComputerTimeOnLoad();		
		doDisplay(num);
		uiShowNow();
		// setTimeout('startRefeshForNtp()',10000);			
		getDaylightStatus();			
		$("#uiPCdateMonth").selectbox({width:80});		
	});
</script>

<style>
.styled-text-short{border:1px solid #4598aa;height:30px;margin:0;padding:0 0 0 10px;font-size:14px;width:50px;line-height:28px;}

.styled-radio-width{width:26px;}
</style>

</head>

<body>
<form id="Alpha_Time" name="Alpha_Time"  method="POST" action="">
<input type="hidden" name="sessionKey" id="sessionKey" value="<% tcWebApi_get("Account_Login","sessionKey","s") %>">
<INPUT TYPE="HIDDEN" name="SaveTime" id="SaveTime" VALUE="0">
<INPUT TYPE="HIDDEN" id="uiCurrentTime" name="uiCurrentTime">
<INPUT type="HIDDEN" name="uiViewdateDSValue" id="uiViewdateDSValue">
<INPUT type="HIDDEN" name="uiViewSyncWith" id="uiViewSyncWith">


	<div id="wrapper">
		<!-------------------- Logo ------------------------->
		<div id="header"></div>
		<!-------------------- Menu ------------------------->
		<div id="menu"></div>
		<div id="menu_edge"></div>
		<!-------------------- Content ---------------------->
		<div id="content">
			<!-------------------- info ---------------------->
	  		<div id="info">
			  	<div id="FunctionName"><script>prints(m_time_header);</script></div>
			  	<div id="wallimage"><img id="page_Time" src="/graphic/New_GUI/page_TimeZone.png" alt="" width="195" height="119"/></div>
			    	<div id="directions">
					<script>prints(m_time_desc);</script>
					<label id="Get_Help" onClick="showOnlineHelp('Time');" style="cursor:pointer;display:none;text-Decoration:underline"><script>prints(m_comm_clickhelp);</script></label>
				</div>
			</div>
		    <!-------------------- funcBar ---------------------->
		<div id="funcBar">
			<div id="pagePath"><script>prints(m_comm_Managment);</script> >> <script>prints(m_time_header);</script></div>
			<ul id="rightFunc">
				<li style="display:block"><div id="Save_btn" onclick="uiTimeSave();" style="cursor:pointer; display:none"><script>prints(m_comm_Save);</script></div></li>
				<li style="display:block"><div id="Save_Disable_btn"><script>prints(m_comm_Save);</script></div></li>
				<li style="display:block"><a href="javascript:CheckHTMLStatus('Schedule');" style="text-decoration:none;"><div id="page_btn" class="linkstyle_1"><script>prints(m_home_Schedule);</script></div></a></li>
			</ul>
		</div>
	    	<!-------------------- main ------------------------->
	     	<div id="main" style="display:none">	

			<!-------------------- alert pop ------------------------->
			<div id="CreatePopAlertMessage" style="display:none">
				<div id="AlertPopRect">
					<div id="AlertPopBody">
						<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Loading_pop_image2"></div></center>
									</td>
								 </tr>
								 <tr>
								 	<td><center><label id="reciprocal_Number">10</label></center></td>
								 </tr>
								 <tr>
								 	<td id="dialog_msg_black2"><script>prints(m_comm_changesdesc);</script></td>
								 </tr>
						   </tbody>
						</table>
						<table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0"  style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Information_pop_image"></div></center>
									</td>
								 </tr>
								 <tr>
									 <td>
									 	<div id="dialog_msg_black"><script>prints(m_comm_settingsave);</script></div>
									 </td>
								 </tr>
								 <tr>
									 <td>
									 	<center><div id="Confirm_btn" onclick="javascript: self.location.href = self.location.href;" style="cursor:pointer"><script>prints(m_comm_ok);</script></div></center>
									 </td>
								 </tr>
						   </tbody>
						</table>
					</div>
				</div>
			</div>
					
			    <!-------------------- general ---------------------->
				<table id="first" class="block" border="0" cellspacing="0" ondragstart="return false" onselectstart="return false" style="margin: 10px 0 0 0;">					
					
					<tr>
						<th><script>prints(m_time_header);</script>:</th>
						<td colspan="2">
							<input class="styled-text" type="text" name="uiCurrentTime1" size="27" id="uiCurrentTime1">
						</td>
					</tr>
					
					<INPUT TYPE="HIDDEN" NAME="ToolsTimeSetFlag" id="ToolsTimeSetFlag" VALUE="0">
					<% If tcWebApi_get("Timezone_Entry","TYPE","h") = "1" Then %>
					<INPUT TYPE="HIDDEN" NAME="uiRadioValue" id="uiRadioValue" VALUE="<%TCWebApi_get("Timezone_Entry","PCSyncFlag","s")%>">
					<% Else %>
					<INPUT TYPE="HIDDEN" NAME="uiRadioValue" id="uiRadioValue" VALUE="0">
					<%End If %>
					<INPUT TYPE="HIDDEN" NAME="uiClearPCSyncFlag" id="uiClearPCSyncFlag" VALUE="0">
					<INPUT TYPE="HIDDEN" NAME="uiwPCdateMonth" id="uiwPCdateMonth" VALUE="0">
					<INPUT TYPE="HIDDEN" NAME="uiwPCdateDay" id="uiwPCdateDay" VALUE="">
					<INPUT TYPE="HIDDEN" NAME="uiwPCdateYear" id="uiwPCdateYear" VALUE="">
					<INPUT TYPE="HIDDEN" NAME="uiwPCdateHour" id="uiwPCdateHour" VALUE="">
					<INPUT TYPE="HIDDEN" NAME="uiwPCdateMinute" id="uiwPCdateMinute" VALUE="">
					<INPUT TYPE="HIDDEN" NAME="uiwPCdateSec" id="uiwPCdateSec" VALUE="">
					<INPUT TYPE="HIDDEN" NAME="uiCurTime" id="uiCurTime" VALUE="">
					<INPUT TYPE="HIDDEN" NAME="uiTimezoneType" id="uiTimezoneType" VALUE="<%TCWebApi_get("Timezone_Entry","TYPE","s")%>">

					<tr>
						<td colspan="3">
							<table border="0" cellspacing="0">	
								<tr>
									<th><script>prints(m_time_sync_time);</script>:</th>
									<td style="width: 26px;"><div id="uiViewSyncWith0" name="uiViewSyncWith0" OnClick="doTimeChange(0);doDisplay(0);" <% If TCWebApi_get("Timezone_Entry","TYPE","h") = "0" then asp_Write(" class='clicked' ") else asp_Write(" class='unclick' ")  end if%>></div></td>
									<td style="font-weight:bold;" align="left"><script>prints(m_time_ntpser);</script></td>
								</tr>
								<tr style="display: none;">
									<th></th>
									<td style="width: 26px;"><div id="uiViewSyncWith1" name="uiViewSyncWith1" OnClick="syncwithpc();doDisplay(1);" <% If TCWebApi_get("Timezone_Entry","TYPE","h") = "1" then asp_Write(" class='clicked' ") else asp_Write(" class='unclick' ") end if%>></div></td>
									<td style="font-weight:bold;" align="left"><script>prints(m_time_pcclock);</script></td>
								</tr>
								<tr>
									<th></th>
									<td style="width: 26px;"><div id="uiViewSyncWith2" name="uiViewSyncWith2" OnClick="doTimeChange(2);doDisplay(2);" <% If TCWebApi_get("Timezone_Entry","TYPE","h") = "2" then asp_Write(" class='clicked' ") else asp_Write(" class='unclick' ") end if%>></div></td>
									<td style="font-weight:bold;" align="left"><script>prints(m_comm_Manually);</script></td>
								</tr>
							</table>							
						</td>
					</tr>						

					<tbody id="timezone_ntp_div0">
					<tr>
						<th><script>prints(m_time_timezone);</script>:</th>
						<td colspan="2">
							<div class="styled-select" >
							<select name="uiViewdateToolsTZ" id="uiViewdateToolsTZ">
								<option value="GMT-12:00" >(GMT-12:00) Enewetak, Kwajalein
								<option value="GMT-11:00" >(GMT-11:00) Midway Island, Samoa
								<option value="GMT-10:00" >(GMT-10:00) Hawaii
								<option value="GMT-09:00" >(GMT-09:00) Alaska
								<option value="GMT-08:00" >(GMT-08:00) Pacific Time (US,Canada)
								<option value="GMT-07:00" >(GMT-07:00) Mountain Time (US & Canada)
								<option value="GMT-06:00" >(GMT-06:00) Central Time (US & Canada), Maxico City, Saskatchewan
								<option value="GMT-05:00" >(GMT-05:00) Eastern Time (US & Canada), Indiana(East)
								<option value="GMT-04:00" >(GMT-04:00) Altlantic Time (Canada), Caracas, La Poz
								<option value="GMT-03:30" >(GMT-03:30) Newfoundland
								<option value="GMT-03:00" >(GMT-03:00) Brasilia, Buenos Aires, Georgetown
								<option value="GMT-02:00" >(GMT-02:00) Mid-Atlantic
								<option value="GMT-01:00" >(GMT-01:00) Azores, Cape Verde Is
								<option value="GMT+00:00" >(GMT) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London
								<option value="GMT+01:00" >(GMT+01:00) Berlin, Stockholm, Rome, Bern, Brussels, Vienna
								<option value="GMT+02:00" >(GMT+02:00) Athens, Helsinki, Istanbul, Cairo, Eastern Europe, Israel
								<option value="GMT+03:00" >(GMT+03:00) Baghdad, Kuwait, Nairobi, Riyadh
								<option value="GMT+03:30" >(GMT+03:30) Tehran
								<option value="GMT+04:00" >(GMT+04:00) Abu Dhabi, Muscat, Tbilisi, Kazan, Volgograd, Moscow,St. Peterburg
								<option value="GMT+04:30" >(GMT+04:30) Kabul
								<option value="GMT+05:00" >(GMT+05:00) Islamabad, Karachi, Tashkent
								<option value="GMT+05:30" >(GMT+05:30) New Delhi
								<option value="GMT+06:00" >(GMT+06:00) Almaty, Dhaka, Ekaterinburg
								<option value="GMT+06:30" >(GMT+06:30) Yangon(Rangoon)
								<option value="GMT+07:00" >(GMT+07:00) Bangkok, Jakarta, Hanoi,Novosibirsk
								<option value="GMT+08:00" >(GMT+08:00) Beijing, Hong Kong, Perth, Singapore, Taipei,Krasnoyarsk
								<option value="GMT+09:00" >(GMT+09:00) Tokyo, Osaka, Sapporo, Seoul,Irkutsk
								<option value="GMT+09:30" >(GMT+09:30) Adelaide, Darwin
								<option value="GMT+10:00" >(GMT+10:00) Brisbane, Canberra, Melbourne, Sydney, Hobart, Yakutsk
								<option value="GMT+11:00" >(GMT+11:00) Solomon Is., New Caledonia,Vladivostok
								<option value="GMT+12:00" >(GMT+12:00) Fiji, Kamchatka, Marshall Is., Wellington, Auckland,Magadan
							</select>
							</div>
						</td>
					</tr>
					<tr>
						<th><script>prints(m_time_daylight);</script>:</th>
						<td colspan="2">
							<div id="uiViewdateDS" class="checkbox_on" onclick="ChangeDaylight();">
								<input type="checkbox" id="uiViewdateDS_ck" name="uiViewdateDS_ck" checked>
							</div>
						</td>
					</tr>					
					<tr>
						<th><script>prints(m_time_ntpseradd);</script>:</th>
						<td colspan="2">
							<input class="styled-text" type="text" name="uiViewSNTPServer" size="27" id="uiViewSNTPServer" maxlength="63"><script>prints(m_time_ntpdesc);</script>
							<label id="uiViewSNTPServer_error" name="uiViewSNTPServer_error" class="error"></label>
						</td>
					</tr>
					<% if TCWebApi_get("WebCustom_Entry","is2NTPServerSupported","h") = "Yes" then%>	
					<tr>
						<th><script>prints(m_time_ntpseradd2);</script>:</th>
						<td colspan="2">
							<input class="styled-text" type="text" name="uiViewSNTPServer2" size="27" id="uiViewSNTPServer2" maxlength="63"><script>prints(m_time_ntpdesc);</script>
						</td>
					</tr>

					<%elseif TCWebApi_get("WebCustom_Entry","is3NTPServerSupported","h") = "Yes" then%>
					<tr>
						<th><script>prints(m_time_ntpseradd3);</script>:</th>
						<td colspan="2">
							<input class="styled-text" type="text" name="uiViewSNTPServer3" size="27" id="uiViewSNTPServer3" maxlength="63"><script>prints(m_time_ntpdesc);</script>
						</td>
					</tr>
					<%end if%>
					</tbody>

					<tbody id="timezone_manual_div2">
					<tr>
						<th><script>prints(m_time_Date);</script>:</th>
						<td colspan="2">
						<table>
						<tr>
						<td valign="top" style="width: 70px">
							<div class="styled-select" >
							<select name="uiPCdateMonth" id="uiPCdateMonth" size="1" style="width: 70px">
								<option VALUE=1>1</option>
								<option VALUE=2>2</option>
								<option VALUE=3>3</option>
								<option VALUE=4>4</option>
								<option VALUE=5>5</option>
								<option VALUE=6>6</option>
								<option VALUE=7>7</option>
								<option VALUE=8>8</option>
								<option VALUE=9>9</option>
								<option VALUE=10>10</option>
								<option VALUE=11>11</option>
								<option VALUE=12>12</option>								
							</select>							
							</div>
						</td>
						<td valign="top" width="5">/</td>
						<td valign="top" style="width: 70px">
							<input class="styled-text-short" type="text" id="uiPCdateDay" name="uiPCdateDay" size="2" maxlength="2" value="" >
						</td>
						<td valign="top" width="5">/</td>
						<td valign="top">
							<input class="styled-text-short" type="text" id="uiPCdateYear" name="uiPCdateYear" size="4" maxlength="4"  value=""><script>prints(m_time_mothdaye);</script>
						</td>
						</tr>
						</table>
						</td>						
					</tr>
					<tr>
						<th></th>
						<td colspan="2">						
							<label id="date_error" name="date_error" class="error"></label>
						</td>
												
					</tr>
					<tr>
						<th><script>prints(m_time_header);</script>:</th>
						<td colspan="2">
						<table>
						<tr>
						<td valign="top">
							<input class="styled-text-short" type="text" id="uiPCdateHour" name="uiPCdateHour" size="2" maxlength="2"  value="">
						</td>
						<td valign="top" width="5">:</td>
						<td valign="top">
							<input class="styled-text-short" type="text" id="uiPCdateMinute" name="uiPCdateMinute" size="2" maxlength="2"  value="">
						</td>
						<td valign="top" width="5">:</td>
						<td valign="top">
							<input class="styled-text-short" type="text" id="uiPCdateSec" name="uiPCdateSec" size="2" maxlength="2"  value=""><script>prints(m_time_hourminsec);</script>
							<label id="uiPCdateSec_error" name="uiPCdateSec_error" class="error"></label>
						</td>
						</tr>
						</table>
						</td>						
					</tr>
					<tr>
						<th></th>
						<td colspan="2">						
							<label id="time_error" name="time_error" class="error"></label>
						</td>
												
					</tr>
					<script language="JavaScript" type="text/JavaScript">
						var strmonth = "<% TCWebApi_get("Timezone_Entry","Month","s") %>";
						var strdate = "<% TCWebApi_get("Timezone_Entry","Date","s") %>";
						var stryear = "<% TCWebApi_get("Timezone_Entry","Year","s") %>";
						var strhour = "<% TCWebApi_get("Timezone_Entry","Hour","s") %>";
						var strmin = "<% TCWebApi_get("Timezone_Entry","Min","s") %>";
						var strsec = "<% TCWebApi_get("Timezone_Entry","Sec","s") %>";

						if(strmonth != "N/A")
							document.Alpha_Time.uiPCdateMonth.selectedIndex = parseInt(strmonth) - 1;
						if(strdate != "N/A")
							$("#uiPCdateDay").val(strdate);
						if(stryear != "N/A")
							$("#uiPCdateYear").val(stryear);
						if(strhour != "N/A")
							$("#uiPCdateHour").val(strhour);
						if(strmin != "N/A")
							$("#uiPCdateMinute").val(strmin);
						if(strsec != "N/A")
							$("#uiPCdateSec").val(strsec);
					</script>
					</tbody>	
					
					<INPUT TYPE="HIDDEN" NAME="ntp2ServerFlag" id="ntp2ServerFlag" VALUE="<%tcWebApi_get("WebCustom_Entry","is2NTPServerSupported","s")%>">
					<INPUT TYPE="HIDDEN" NAME="ntp3ServerFlag" id="ntp3ServerFlag" VALUE="<%tcWebApi_get("WebCustom_Entry","is3NTPServerSupported","s")%>">
					
			    </table>	
			<div id="DetectRouterConnection" style="display:none"></div>
		</div>
		<div id="footer" border="0">
			<div id="copyright"><script>prints(m_comm_copyright);</script></div>
			<div id="help">
				<a target="_blank" href="http://www.dlink.com/support" style="cursor:pointer;text-Decoration:underline">
					
						<script>prints(m_home_gethelp);</script>
					
				</a>
			</div>
		</div>
	</div>
</form>
</body>
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Management");
	GetXML();
</script>
</html>
