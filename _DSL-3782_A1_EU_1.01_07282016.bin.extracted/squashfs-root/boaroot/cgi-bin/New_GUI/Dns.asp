<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns= "http://www.w3c.org/1999/xhtml">

<head>
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/css">
<link rel=stylesheet type="text/css" href="/layout/New_GUI/jquery.selectbox.css?v=20140910163551" />
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJQ.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/configuration/DeviceConfig.js?v=TimeStamp_QzwsxDcRfvTGByHn"></script>
<!-- get -->
<script type='text/javascript' src='/cgi-bin/get/internet_status.asp'></script>
<script src="/cgi-bin/get/New_GUI/Dns.asp" type="text/javascript"></script>
<!-- get -->
<script type="text/javascript">
	
	function Load_HTML() {
		$("#header").load("header.asp");
	}
	
	function Initial() {
		initialMenu();
	}

	function InitDns() {
		var f = document.getElementById("frm");

		if(mode=="1")
		{
			changeType(1);
		}
		else 
		{
			changeType(0);
		}
		if(preferredDns != "N/A")
			f.wan_dns_1.value = preferredDns;

		if(alternateDns != "N/A")
			f.wan_dns_2.value = alternateDns;
	}

	function changeType(tmp)
	{
		var f = document.getElementById("frm");
		if(parseInt(tmp) == 0)
		{
			document.getElementById('dnsradio0').setAttribute("class", "clicked");
			document.getElementById('dnsradio1').setAttribute("class", "unclick");
			f.wan_dns_1.disabled=true;
			f.wan_dns_2.disabled=true;
		}
		else
		{
			document.getElementById('dnsradio0').setAttribute("class", "unclick");
			document.getElementById('dnsradio1').setAttribute("class", "clicked");
			f.wan_dns_1.disabled=false;
			f.wan_dns_2.disabled=false;
		}
	}

	function checkdParameter() {
	var f = document.getElementById("frm");
	var preferredDns=true;
	var alternateDns=true;
	
	if(document.getElementById('dnsradio1').getAttribute('class') == 'clicked')
	{
		if (!is_valid_ip(f.wan_dns_1.value,0)) {
			preferredDns=false;
			$("#wan_dns_1_error").html("<br/>Invalid IP address for the primary DNS server.");
			return false;
			
		} else {
			preferredDns=true;
		}
		if(f.wan_dns_2.value != "") {
			if (!is_valid_ip(f.wan_dns_2.value,0)) {
				alternateDns=false;
				$("#wan_dns_2_error").html("<br/>Invalid IP address for the secondary DNS server.");
				return false;
			} else {
				alternateDns=true;
			}
		}	
	}	
	return (preferredDns & alternateDns);
	}

	
	function doSave() {
		var f = document.getElementById("frm");
		$("label[class='error']").html("");

		if (checkdParameter()) {
			f.buttonType.value = "apply";
			if(document.getElementById('dnsradio0').getAttribute('class') == 'clicked')
			{
				f.settingType.value = "0";
			}
			else if(document.getElementById('dnsradio1').getAttribute('class') == 'clicked')
			{
				f.settingType.value = "1";
			}
		}
		else
			return;

		document.getElementById("CreatePopAlertMessage").style.display = "inline";
		document.getElementById("waitSettingFinish").style.display = "inline";
		Start_reciprocal_Number_RestoreConfiguration();

		$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey){
			$("#sessionKey").val(sessionKey);
			setTimeout('$.post("/cgi-bin/New_GUI/Set/Dns.asp", $("form").serialize(), function(){save_flag = true;});', 300);
		});
	}

	var save_flag = false;
	var _ReciprocalNumber = 5;
	function Start_reciprocal_Number_RestoreConfiguration() {
		if (_ReciprocalNumber >= 0) {
			document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", "Sec");
			_ReciprocalNumber --;
			setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
		} else {
			if(save_flag) {
				document.getElementById("waitSettingFinish").style.display = "none";
				document.getElementById("SuccessSettings").style.display = "inline";
			} else {
				setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
			}
		}
	}

</script>
<script language="JavaScript">
	$(function() {
		$("button, div[name='dnsradio']").click(function () { save_button_changed(); });
		$("input, textarea, select").change(function () { save_button_changed(); });
		$("input, textarea").keypress(function () { save_button_changed(); });

		$("#dnsradio0,#dnsradio1").click(function () {	save_button_changed();	});
	});
</script>
<style>
.block th {
    font-weight: normal;
    text-align: right;
    width: 240px;
}
</style>
</head>

<body>
	<form method="POST" action="" name="frm" id="frm">
		<input type="hidden" name="sessionKey" id="sessionKey">
		<input type="hidden" name="buttonType">
		<input type="hidden" name="settingType">
		<div id="wrapper">
			<!-------------------- Logo ------------------------->
			<div id="header"></div>
			<!-------------------- Menu ------------------------->
			<div id="menu"></div>
			<!-------------------- Content ---------------------->
			<div id="content">
				<!-------------------- info ------------------------->
				<div id="info">
					<div id="FunctionName"><script>I18N("h", "DNS");</script></div>
					<div id="wallimage"><img src="/graphic/New_GUI/wall.png" alt="" width="195" height="119"/></div>
					<div id="directions">
						<script>I18N("h", "DNS server is used for translating a URL to an IP address. ");</script>
					</div>
				</div>
				<!-------------------- funcBar ---------------------->
				<div id="funcBar">
					<div id="pagePath">&nbsp;<script>I18N("h", "Features");</script> >> <script>I18N("h", "DNS");</script></div>
					<ul id="rightFunc">
						<li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h", "Save");</script></div></li>
						<li style="display:block"><div id="Save_Disable_btn"><script>I18N("h", "Save");</script></div></li>
						<input id="sumbit_CheckData" class="submit" type="button" value="Submit" style="display:none" onClick="doSave();"/>
					</ul>
				</div>
	     	<!-------------------- main ---------------------->

				<!-------------------- DNS Settings  ---------------------->
					<table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;">
						<tr>
							<td style="width: 205px;">&nbsp;</td>
							<td style="width: 26px;"><div id="dnsradio0" name="dnsradio0" class='unclick' OnClick="changeType(0);"></div></td>
							<td style='width: 150px;'>Obtain DNS server address automatically</td>
						</tr>

						<tr>
							<td style="width: 205px;">&nbsp;</td>
							<td style="width: 26px;"><div id="dnsradio1" name="dnsradio1" class='unclick' OnClick="changeType(1);"></div></td>
							<td style='width: 150px;'>Use the following DNS Server address</td>
						</tr>

						<tr>
							<td style="width: 205px;">&nbsp;</td>
							<td style="width: 26px;">&nbsp;</td>
							<td style='width: 150px;'>Preferred DNS server :</td>
							<td><input class="styled-text" type="text" name="wan_dns_1" maxlength="32" size="30" id="wan_dns_1">
							<label id="wan_dns_1_error" name="wan_dns_1_error" class="error"></label>
							</td>
						</tr>

						<tr>
							<td style="width: 205px;">&nbsp;</td>
							<td style="width: 26px;">&nbsp;</td>
							<td style='width: 150px;'>Alternate DNS server :</td>
							<td><input class="styled-text" type="text" name="wan_dns_2" maxlength="32" size="30" id="wan_dns_2">
							<label id="wan_dns_2_error" name="wan_dns_2_error" class="error"></label>
							</td>
						</tr>
						
					</table>					     			
     			<hr class="advancedBlock" style="display: none;"/>
				<br />
     			<div id="CreatePopAlertMessage" style="display:none">
					<div id="AlertPopRect">
						<div id="AlertPopBody">
							<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none">
							   <tbody>
									 <tr>
									 	<td>
											<center><div id="Loading_pop_image2"></div></center>
										</td>
									 </tr>
									 <tr>
									 	<td><center><label id="reciprocal_Number">5</label></center></td>
									 </tr>
									 <tr>
									 	<td id="dialog_msg_black2"><script>I18N("h", "Your changes are being saved.");</script></td>
									 </tr>
							   </tbody>
							</table>
							<table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0"  style="display:none">
							   <tbody>
									 <tr>
									 	<td>
											<center><div id="Information_pop_image"></div></center>
										</td>
									 </tr>
									 <tr>
										 <td>
										 	<div id="dialog_msg_black"><script>I18N("h", "The new settings have been saved.");</script></div>
										 </td>
									 </tr>
									 <tr>
										 <td>
										 	<center><div id="Confirm_btn" onclick="javascript: self.location.href = self.location.href;" style="cursor:pointer"><script>I18N("h", "OK");</script></div></center>
										 </td>
									 </tr>
							   </tbody>
							</table>
						</div>
					</div>
				</div>
				<div id="DetectRouterConnection" style="display:none"></div>
				<div id="footer" border="0">
					<div id="copyright"><script>prints(m_comm_copyright);</script></div>
					<div id="help">
						<a target="_blank" href="http://www.dlink.com/support" style="cursor:pointer;text-Decoration:underline">
							
								<script>prints(m_home_gethelp);</script>
							
						</a>
					</div>
				</div>
			</div>
	</form>
</body>
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Advanced");
	InitDns();
</script>
</html>

