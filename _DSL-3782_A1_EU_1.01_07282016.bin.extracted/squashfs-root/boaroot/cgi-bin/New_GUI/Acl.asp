<%
/*add a rule*/
if request_Form("ACLActionFlag") = "0" then

	TCWebAPI_set("ACL_Common","Activate","ActivateRDOValue")

	if TCWebAPI_get("ACL_Common", "Activate", "h") = "Yes" then
		TCWebAPI_set("WebCurSet_Entry","acl_id","RuleIndexSEL")
		/*remove original data*/
		TCWebAPI_unset("ACL_Entry")

		TCWebAPI_set("ACL_Entry","Activate","RuleActiveRDOValue")
		TCWebAPI_set("ACL_Entry","ScrIPAddrBegin","ScrIPaddrBeginTXT")
		TCWebAPI_set("ACL_Entry","ScrIPAddrEnd","ScrIPaddrEndTXT")
		TCWebAPI_set("ACL_Entry","Application","ApplicationSEL")
		TCWebAPI_set("ACL_Entry","Interface","InterfaceSEL")
	end if

	/*commit changes*/
	TCWebAPI_commit("ACL_Entry")

/*select a rule*/
elseif Request_Form("ACLActionFlag") = "1" then
	TCWebAPI_set("ACL_Common","Activate","ActivateRDOValue")
	TCWebAPI_set("WebCurSet_Entry","acl_id","RuleIndexSEL")

/*remove a rule*/
elseif Request_Form("ACLActionFlag") = "2" then

	TCWebAPI_set("ACL_Common","Activate","ActivateRDOValue")

	if TCWebAPI_get("ACL_Common", "Activate", "h") = "Yes" then
		TCWebAPI_unset("ACL_Entry")
	end if

	TCWebAPI_commit("ACL_Entry")
end if
%>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns= "http://www.w3c.org/1999/xhtml">

<head>
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/css">
<link rel=stylesheet type="text/css" href="/layout/New_GUI/jquery.selectbox.css?v=20140910163551" />
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJQ.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/__comm.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/__js_comm.js?v=20140910163551"></script>

<!-- get -->
<script src="/cgi-bin/get/New_GUI/internet_status.asp" type="text/javascript"></script>
<script src="/cgi-bin/get/New_GUI/Acl.cgi" type="text/javascript"></script>
<!-- get -->
<!--<script src="/LanguageFamily/en/msg_multipe.js" type="text/javascript"></script>-->

<!-- js -->
<script src="/js/New_GUI/Advanced/Acl.js" type="text/javascript"></script> 
<!-- js -->


<script>
var AclValue = {	
	"acl_active": "<%TCWebAPI_get("ACL_Common", "Activate", "s")%>",
 	"acl_rule_active": "<%TCWebAPI_get("ACL_Entry", "Activate", "s")%>"
};

for(var i in AclValue) {
	if(AclValue[i] == "N/A")
		AclValue[i] = "";
}

</script>

<script type="text/javascript">
	function Load_HTML()	{	$("#header").load("header.asp");	}
	function Initial()
	{
		initialMenu();
	}
	function GetXML()	{
		document.getElementById("main").style.display = "inline";	
	}
</script>

<script type="text/javascript" language="JavaScript">		
	$(document).ready( function() {
		init();	
		$("select").selectbox();
		hideSaveBtn();
	});
</script>

</head>

<body>
<form id="ACL_form" name="ACL_form" METHOD="POST" action="">
<input type="hidden" name="sessionKey" id="sessionKey" value="<% tcWebApi_get("Account_Login","sessionKey","s") %>">
<input type="hidden" id="buttonType" name="buttonType">
<input type="hidden" id="ACLActionFlag" name="ACLActionFlag" value="0">
<input type="hidden" id="ActivateRDOValue" name="ActivateRDOValue">
<input type="hidden" id="RuleActiveRDOValue" name="RuleActiveRDOValue">
	<div id="wrapper">
		<!-------------------- Logo ------------------------->
		<div id="header"></div>
		<!-------------------- Menu ------------------------->
		<div id="menu"></div>
		<div id="menu_edge"></div>
		<!-------------------- Content ---------------------->
		<div id="content">
			<!-------------------- info ---------------------->
	  		<div id="info">
			  	<div id="FunctionName"><script>prints(m_acl_header);</script></div>
			  	<div id="wallimage"><!-- <img id="page_acl" src="" alt="" width="195" height="119"/> --></div>
			    <div id="directions">
					<script>prints(m_acl_desc);</script>
					<label id="Get_Help" onClick="showOnlineHelp('ACL');" style="cursor:pointer;display:none;text-Decoration:underline"><script>prints(m_comm_clickhelp);</script></label>
				</div>
			</div>
		    <!-------------------- funcBar ---------------------->
		<div id="funcBar">
			<div id="pagePath"><script>prints(m_comm_features);</script> >> <script>prints(m_acl_header);</script></div>
			<ul id="rightFunc">				
				<li style="display:block"><div id="Save_btn" onclick="doSubmit();" style="cursor:pointer; display:none"></div></li>
				<li style="display:block"><div id="Save_Disable_btn"></div></li>		
				<li style="display:block"><div id="Save_btn" name="aclDelBtn" onclick="doDel();" style="cursor:pointer"><script>prints(m_comm_DELETE);</script></div></li>
				<li style="display:block"><div id="Save_btn" name="aclSetBtn" onclick="doAdd();" style="cursor:pointer"><script>prints(m_comm_set);</script></div></li>
				
			</ul>
		</div>
	    	<!-------------------- main ------------------------->
	     	<div id="main" style="display:none">
	     		<!-------------------- alert pop ------------------------->
			<div id="CreatePopAlertMessage" style="display:none">
				<div id="AlertPopRect">
					<div id="AlertPopBody">
						<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Loading_pop_image2"></div></center>
									</td>
								 </tr>
								 <tr>
								 	<td><center><label id="reciprocal_Number">10</label></center></td>
								 </tr>
								 <tr>
								 	<td id="dialog_msg_black2"><script>prints(m_comm_changesdesc);</script></td>
								 </tr>
						   </tbody>
						</table>
						<table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0"  style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Information_pop_image"></div></center>
									</td>
								 </tr>
								 <tr>
									 <td>
									 	<div id="dialog_msg_black"><script>prints(m_comm_settingsave);</script></div>
									 </td>
								 </tr>
								 <tr>
									 <td>
									 	<center><div id="Confirm_btn" onclick="javascript: self.location.href = self.location.href;" style="cursor:pointer"><script>prints(m_comm_ok);</script></div></center>
									 </td>
								 </tr>
						   </tbody>
						</table>
					</div>
				</div>
			</div>
			
	     		<!-------------------- general ---------------------->
	     		<br>
			<div class="title"><script>prints(m_acl_accesscon);</script></div>
				<table class="block" border="0" cellspacing="0" ondragstart="return false" onselectstart="return false" style="margin: 10px 0 0 0;">					
					<tr>
						<th><script>prints(m_acl_header);</script>:</th>
						<td valign="top">
							<div id="ActivateRDO" class="checkbox_on" onclick="changeAcl();aclSwitch();">
								<input type="checkbox" name="ActivateRDO_ck" id="ActivateRDO_ck">
							</div>
						</td>
					</tr>
					<tbody id="tAcl" name="tAcl">
					<tr>
						<th><script>prints(m_acl_aclrule);</script>:</th>
						<td>
							<div class="styled-select" >
							<select name="RuleIndexSEL" id="RuleIndexSEL" onChange="doIndexChange()">
								<option value="0" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "0" then asp_Write("selected") end if %>>1
								<option value="1" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "1" then asp_Write("selected") end if %>>2
								<option value="2" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "2" then asp_Write("selected") end if %>>3
								<option value="3" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "3" then asp_Write("selected") end if %>>4
								<option value="4" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "4" then asp_Write("selected") end if %>>5
								<option value="5" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "5" then asp_Write("selected") end if %>>6
								<option value="6" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "6" then asp_Write("selected") end if %>>7
								<option value="7" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "7" then asp_Write("selected") end if %>>8
								<option value="8" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "8" then asp_Write("selected") end if %>>9
								<option value="9" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "9" then asp_Write("selected") end if %>>10
								<option value="10" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "10" then asp_Write("selected") end if %>>11
								<option value="11" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "11" then asp_Write("selected") end if %>>12
								<option value="12" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "12" then asp_Write("selected") end if %>>13
								<option value="13" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "13" then asp_Write("selected") end if %>>14
								<option value="14" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "14" then asp_Write("selected") end if %>>15
								<option value="15" <%if TCWebAPI_get("WebCurSet_Entry", "acl_id", "h") = "15" then asp_Write("selected") end if %>>16
							</select>
							</div>
						</td>
					</tr>
					<tr>
						<th><script>prints(m_comm_Active);</script>:</th>
						<td valign="top">
							<div id="RuleActiveRDO" class="checkbox_on" onclick="changeAclRule();">
								<input type="checkbox" name="RuleActiveRDO_ck" id="RuleActiveRDO_ck">
							</div>
						</td>
					</tr>
					<tr>
						<th><script>prints(m_comm_secrip);</script>:</th>
						<td>
							<input class="styled-text" type="text" id="ScrIPaddrBeginTXT" name="ScrIPaddrBeginTXT" size="15" maxlength="15" value="<%if TCWebAPI_get("ACL_Entry", "ScrIPAddrBegin", "h") <> "N/A" then TCWebAPI_get("ACL_Entry", "ScrIPAddrBegin", "s") else asp_Write("0.0.0.0") end if %>" >~
							<input class="styled-text" type="text" id="ScrIPaddrEndTXT" name="ScrIPaddrEndTXT" size="15" maxlength="15" value="<%if TCWebAPI_get("ACL_Entry", "ScrIPAddrEnd", "h") <> "N/A" then TCWebAPI_get("ACL_Entry", "ScrIPAddrEnd", "s") else asp_Write("0.0.0.0") end if %>" >
		                                        <br>&nbsp;&nbsp;
		                                        <font color="#000000"><script>prints(m_acl_errdesc);</script></font>
		                                        <label id="ScrIPaddr_error" name="ScrIPaddr_error" class="error"></label>
						</td>
					</tr>
					<tr>
						<th><script>prints(m_application_title);</script>:</th>
						<td>
							<div class="styled-select" >
							<select name="ApplicationSEL" id="ApplicationSEL">
							<script>
								prints("<option value=\"Web\" <%if TCWebAPI_get("ACL_Entry", "Application", "h") = "Web" then asp_write("selected") end if %>>"+m_acl_Web);
								prints("<option value=\"Telnet\" <%if TCWebAPI_get("ACL_Entry", "Application", "h") = "Telnet" then asp_write("selected") end if %>>"+m_acl_Telnet);
			                                   <% if TCWebAPI_get("ACL_Common", "sshOption", "h") = "support" then %>
			                                        prints("<option value=\"SSH\" <%if TCWebAPI_get("ACL_Entry", "Application", "h") = "SSH" then asp_write("selected") end if %>>"+m_acl_SSH);
			                                   <% end if %>
								prints("<option value=\"TFTP\" <%if TCWebAPI_get("ACL_Entry", "Application", "h") = "TFTP" then asp_write("selected") end if %>>"+m_acl_TFTP);
								prints("<option value=\"Ping\" <%if TCWebAPI_get("ACL_Entry", "Application", "h") = "Ping" then asp_write("selected") end if %>>"+m_acl_Ping);
								prints("<option value=\"Samba\" <%if TCWebAPI_get("ACL_Entry", "Application", "h") = "Samba" then asp_write("selected") end if %>>"+m_acl_Samba);
								prints("<option value=\"domain\" <%if TCWebAPI_get("ACL_Entry", "Application", "h") = "domain" then asp_write("selected") end if %>>"+m_acl_Domain);
								prints("<option value=\"ALL\" <%if TCWebAPI_get("ACL_Entry", "Application", "h") = "ALL" then asp_write("selected") end if %>>"+m_acl_ALL);
							</script>
							</select>
							</div>
						</td>
					</tr>
					<tr>
						<th><script>prints(m_acl_aclrule);</script>Interface:</th>
						<td>
							<div class="styled-select" >
							<select id="InterfaceSEL" name="InterfaceSEL">
							<script>
								prints("<option value=\"WAN\" <%if TCWebAPI_get("ACL_Entry", "Interface", "h") = "WAN" then asp_write("selected") end if %>>"+m_acl_wan);
								prints("<option value=\"LAN\" <%if TCWebAPI_get("ACL_Entry", "Interface", "h") = "LAN" then asp_write("selected") end if %>>"+m_acl_lan);
								prints("<option value=\"Both\" <%if TCWebAPI_get("ACL_Entry", "Interface", "h") = "Both" then asp_write("selected") end if %>>"+m_comm_Both);
							</script>
							</select>
							</div>
						</td>
					</tr>

					<tr>
						<td colspan="2">&nbsp;</td>
					</tr>
					</tbody>
				</table>
				
				<hr />

				<br>
				<div class="title"><script>prints(m_acl_accessconlist);</script></div>		
				<table class="mainTable" border="0" cellspacing="0">
				<thead>
					<tr>
						<th><script>prints(m_comm_Index);</script></th>
						<th><script>prints(m_comm_Active);</script></th>
						<th><script>prints(m_comm_secrip);</script></th>
						<th><script>prints(m_application_title);</script></th>
						<th><script>prints(_wan_dsl_pvc_txt);</script></th>
					</tr>
					<script>
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry0","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry1","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry2","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry3","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry4","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry5","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry6","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry7","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry8","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry9","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry10","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry11","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry12","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry13","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry14","aclFilterTRLine","s") %>'));
					document.write(decodeSpecialChr('<% tcWebApi_get("GUITemp_Entry15","aclFilterTRLine","s") %>'));
					</script>
				</thead>				
				</table>
				<br />
				<br />
			 <div id="DetectRouterConnection" style="display:none"></div>
		</div>
		 <div id="footer">
			<div id="copyright"><script>prints(m_comm_copyright);</script></div>
			<div id="help">
                <a target="_blank" href="http://www.dlink.com/support" style="cursor:pointer;text-Decoration:underline">
	                
	                    <script>
	                    prints(m_home_gethelp);
	                    </script>                  
	                
                </a>
            </div>
		 </div>
	</div>
	
</form>
</body>
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Advanced");
	GetXML();
</script>
</html>
