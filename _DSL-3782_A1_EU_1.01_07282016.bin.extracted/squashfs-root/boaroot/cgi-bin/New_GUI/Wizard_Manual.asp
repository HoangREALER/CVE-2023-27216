<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3c.org/1999/xhtml">
	<head>
		<title>D-LINK</title>
		<meta http-equiv="X-UA-Compatible" content="IE=9">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<meta http-equiv="Content-Type" content="text/css">
		<link rel="stylesheet" type="text/css" href="/layout/New_GUI/jquery.css">
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/jquery-1.8.2.min.js?v=20140910163551"></script>
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js"></script>
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/i18n.js"></script>

		<link rel="stylesheet" type="text/css" href="/layout/New_GUI/style_h.css" media="all">
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/jquery.js"></script>

		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSSDefault.js?v=20140910163551"></script>
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>
		<link rel=stylesheet type="text/css" href="/layout/New_GUI/jquery.selectbox.css?v=20140910163551" />
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSS.js?v=20140910163551"></script>
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJQ.js?v=20140910163551"></script>
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>
		<script type="text/javascript" charset="utf-8" src="/js/New_GUI/configuration/DeviceConfig.js?v=20140910163551"></script>
		<script src="/js/New_GUI/__comm.js" type="text/javascript" charset="utf-8"></script>
		<script src="/js/New_GUI/__js_comm.js" type="text/javascript" charset="utf-8"></script>
		<script src="/js/New_GUI/__ip.js" type="text/javascript" charset="utf-8"></script>
		<script src="/js/New_GUI/isp_list.js" type="text/javascript" charset="utf-8"></script>

		<style>
			#detection					{	display: none;	}
			#plug_page					{	display: none;	}
			#pvcSetting					{	display: none;	}
			#selectConnectionType		{	display: none;	}
			#pppoe_setupTable			{	display: none;	}
			#pppoe_setupTable th		{	width:	250px;	}
			#pppoa_setupTable			{	display: none;	}
			#pppoa_setupTable th		{	width:	250px;	}
			#staticIP_setupTable		{	display: none;	}
			#wifi_setupTable			{	display: none;	}
			#devicePassword_setupTable	{	display: none;	}
			#confirm_setup				{	display: none;	}
			#createPop_Manual			{	display: none;	}
			#checking_connection		{	display: none;	}
			#mydlink_step1				{	display: none;	}
			#mydlink_step2				{	display: none;	}
			#mydlink_step3				{	display: none;	}
			#congratulationsTable		{	display: none;	}
			#popRect 					{	top: 0px;		}
		</style>
	</head>


	<script type="text/javascript">

		function checkVPIVCI(name1, name2) {
			for (var i = 1; i < isp_val.data_list.length; i++) {
				if ((name1 == isp_val.data_list[i][0]) && (name2 == isp_val.data_list[i][1]))
					return false;
			}
			return true;
		}

		function isNumber(n) {
			if (n.length == 0) return false;
			for (var i = 0; i < n.length; i++) {
				if (n.charAt(i) < '0' || n.charAt(i) > '9') return false;
			}
			return true;
		}

		function showWaitImage() {
			$("#CreatePopAlertMessage").show();
			$("#waitSettingFinish_Setting").show();
		}

		function hideWaitImage() {
			$("#CreatePopAlertMessage").hide();
			$("#waitSettingFinish_Setting").hide();
		}

		function Start_reciprocal_Number_Reboot() {
			if (_ReciprocalRebootNumber >= 0) {
				$("#reboot_wait_time").html(_ReciprocalRebootNumber + " " + I18N("j", m_comm_Sec));
				_ReciprocalRebootNumber--;
				setTimeout("Start_reciprocal_Number_Reboot()", 1000);
			} else {
				$("#REBOOT").hide();
				$("#SuccessREBOOT").show();
			}
		}

		function clearCreateRulePOP() {
			$("#dialog_msg_black2").html("");
			showWaitImage();
			setTimeout(function() {
				self.location.href = "/cgi-bin/New_GUI/Home.asp";
			}, 300);
		}

		function funTopology(show_Bool, wan_line_Bool, wifi_line_Bool, router_line_Bool, area_class) {
			if (!!show_Bool)
				$("#wizard_topology").show();
			else
				$("#wizard_topology").hide();

			$("#wizard_wan_line").removeClass();
			$("#wizard_wifi_line").removeClass();
			$("#wizard_router").removeClass();
			$("#wizard_settings_area").removeClass();

			$("#wizard_wan_line").removeAttr('classname');
			$("#wizard_wifi_line").removeAttr('classname');
			$("#wizard_router").removeAttr('classname');
			$("#wizard_settings_area").removeAttr('classname');

			if (!!wan_line_Bool) {
				$("#wizard_wan_line").addClass("wizard_wan_line_on");
				$("#wizard_wan_line").attr("classname", "wizard_wan_line_on");
			} else {
				$("#wizard_wan_line").addClass("wizard_wan_line_off");
				$("#wizard_wan_line").attr("classname", "wizard_wan_line_off");
			}

			if (!!wifi_line_Bool) {
				$("#wizard_wifi_line").addClass("wizard_wifi_line_on");
				$("#wizard_wifi_line").attr("classname", "wizard_wifi_line_on");
			} else {
				$("#wizard_wifi_line").addClass("wizard_wifi_line_off");
				$("#wizard_wifi_line").attr("classname", "wizard_wifi_line_off");
			}

			if (!!router_line_Bool) {
				$("#wizard_router").addClass("wizard_router_on");
				$("#wizard_router").attr("classname", "wizard_router_on");
			} else {
				$("#wizard_router").addClass("wizard_router_off");
				$("#wizard_router").attr("classname", "wizard_router_off");
			}

			$("#wizard_settings_area").addClass(area_class);
			$("#wizard_router").attr("classname", area_class);
		}

		function hiddenAllBody() {
			$("#wizard_settings_body>div, #wizard_settings_body>table").hide();
		}

		function setButton(id_v, val_v, enable_Bool, show_Bool) {
			$("#" + id_v).html(val_v).removeClass();

			if (!!enable_Bool)
				$("#" + id_v).addClass("styled-button_enable").removeProp('disabled');
			else
				$("#" + id_v).addClass("styled-button_disable").prop('disabled', true);

			if (!!show_Bool)
				$("#" + id_v).show();
			else
				$("#" + id_v).hide();
		}

		function initEncaps(enc_id, llc_val, vcMux_val, encap_adsl) {
			if (change_isp_val.wanMode == "ATM") {

				$("#" + enc_id).parent().parent().parent().show();

				if (change_isp_val.conntype2 != "") {

					if (change_isp_val.conntype2 == "LLC") {
						$("#" + enc_id).val(llc_val);
						$("#" + enc_id).selectbox('change', llc_val, $("#" + enc_id).find('option:selected').text());
					} else {
						$("#" + enc_id).val(vcMux_val);
						$("#" + enc_id).selectbox('change', vcMux_val, $("#" + enc_id).find('option:selected').text());
					}

					$("#" + enc_id).selectbox('disable');

				} else {

					$("#" + enc_id).val(encap_adsl);
					$("#" + enc_id).selectbox('change', encap_adsl, $("#" + enc_id).find('option:selected').text());
					$("#" + enc_id).selectbox('enable');

				}

			} else {

				$("#" + enc_id).parent().parent().parent().hide();

			}
		}

		function isWPAKeyInvalid(source) {
			var sourcestr = new String(source);
			var tempstr;

			if (sourcestr == "")
				return false;

			for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
				tempstr = sourcestr.substr(strposition, 1);
				if ((tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
					continue;
				else
					return true;
			}

			return false;
		}

		var dataWifi24Lists = new Array();
		function checkSSID(name, id) {
			for (var i = 0; i < dataWifi24Lists.length; i++) {
				if (dataWifi24Lists[i][0] == 1) {
					if (id != i) {
						if (name == decodeSpecialChr(dataWifi24Lists[i][1]))
							return false;
					}
				}
			}
			return true;
		}

		var dataWifiacLists = new Array();
		function checkSSID_ac(name, id) {
			for (var i = 0; i < dataWifiacLists.length; i++) {
				if (dataWifiacLists[i][0] == 1) {
					if (id != i) {
						if (name == decodeSpecialChr(dataWifiacLists[i][1]))
							return false;
					}
				}
			}
			return true;
		}

		function isSSIDInvalid(source) {
			var sourcestr = new String(source);
			var tempstr;
			for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
				tempstr = sourcestr.substr(strposition, 1);
				if (tempstr.charCodeAt(0) == 45 || tempstr.charCodeAt(0) == 95 || tempstr.charCodeAt(0) == 46 || tempstr.charCodeAt(0) == 64 || (tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
					continue;
				else
					return true;
			}
			return false;
		}

	</script>

	<script type="text/javascript">
		
		var wizard_Step = 0;

		var Time_GetReciprocalTime;
		var _ReciprocalRebootNumber = 0;

		function wizard_next(num) {

			switch (num) {
				case 0: // wizard begin
					wizard_Step = 1; // ISP page
					showISPBody();
					break;
				case 1:
					saveISP();
					break;
				case 2:
					switch (selectType) {
						case "Dynamic IP":
							wizard_Step = 3; // dhcp page
							if (isp_val.g_wanMode == "PTM") {
								wizard_next(wizard_Step);
							} else {
								showDHCPBody();
							}
							break;
						case "Static IP":
							wizard_Step = 4; // static page
							showStaticBody();
							break;
						case "PPPoE":
							wizard_Step = 5; // pppoe page
							showPPPoEBody();
							break;
						case "PPPoA":
							wizard_Step = 6; // pppoa page
							showPPPoABody();
							break;
						case "Bridge":
							wizard_Step = 7; // bridge page
							if (isp_val.g_wanMode == "PTM") {
								wizard_next(wizard_Step);
							} else {
								showBridgeBody();
							}
							break;
					}
					break;
				case 3:
					saveDHCP();
					break;
				case 4:
					saveStatic();
					break;
				case 5:
					savePPPoE();
					break;
				case 6:
					savePPPoA();
					break;
				case 7:
					saveBridge();
					break;
				case 8:
					saveWIFI();					
					break;
				case 9:
					savePass();					
					break;
				case 10:
					$("#dialog_msg_black2").html("");
					/*showWaitImage();
					setTimeout(function() {
						self.location.href = "/cgi-bin/New_GUI/Home.asp";
					}, 300);*/

					$("#CreatePopAlertMessage").show();
					$("#REBOOT").show();
					_ReciprocalRebootNumber = 100;
					Time_GetReciprocalTime = window.clearInterval(Time_GetReciprocalTime);
					Start_reciprocal_Number_Reboot();

					setTimeout(function() {

						$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {
							wifi_val.sessionKey = sessionKey;
							$.post("/cgi-bin/New_GUI/Set/wizard_wifi_setting.asp", wifi_val, function() {

								var data = {};
								$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey){
									data.sessionKey = sessionKey;
									data.reboot_type = 1;
									$.post("/cgi-bin/New_GUI/Set/reboot_wait.asp", data, function(){});
								});	

							});
						});

					}, 500);
					
					break;
			}

		}

		function wizard_back(num) {

			switch (num) {
				case 1: // wizard isp
					wizard_Step = 0; // begin page
					showBeginBody();
					break;
				case 2:
					wizard_Step = 1; // isp page
					showISPBody();
					break;
				case 3:
				case 4:
				case 5:
				case 6:
				case 7:
					if (change_isp_val.conntype != "") {
						wizard_Step = 1; // isp page
						showISPBody();
					} else {
						wizard_Step = 2; // connect type page
						showConnectTypeBody();
					}
					break;
				case 8:

					var connType = ( change_isp_val.conntype != "" ? change_isp_val.conntype : ( change_isp_val.notISP_conntype != undefined ? change_isp_val.notISP_conntype : "" ) );

					switch (connType) {
						case "":
							wizard_Step = 2; // connect type page
							showConnectTypeBody();
							break;
						case "Dynamic IP":
							wizard_Step = 3; // dhcp page
							if (isp_val.g_wanMode == "PTM") {
								wizard_back(wizard_Step);
							} else {
								showDHCPBody();
							}
							break;
						case "Static IP":
							wizard_Step = 4; // static page
							showStaticBody();
							break;
						case "PPPoE":
							wizard_Step = 5; // pppoe page
							showPPPoEBody();
							break;
						case "PPPoA":
							wizard_Step = 6; // pppoa page
							showPPPoABody();
							break;
						case "Bridge":
							wizard_Step = 7; // bridge page
							if (isp_val.g_wanMode == "PTM") {
								wizard_back(wizard_Step);
							} else {
								showBridgeBody();
							}
							break;
					}
					break;
				case 9:
					wizard_Step = 8; // wifi page
					showWifiBody();
					break;
				case 10:
					wizard_Step = 9; // device password page
					showDevicePasswordBody();
					break;
			}

		}

		function showBeginBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_welcome);
			$("#wizard_wording").html(m_wizard_desc1);

			funTopology(true, false, false, false, "wizard_area1");

			setButton("btn_back", m_comm_Cancel, true, false);
			setButton("btn_next", m_wizard_next, true, true);

			$("#wizard_setupTable").show();
		}

		function showISPBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_isp_title);
			$("#wizard_wording").html(m_wizard_isp_desc);

			funTopology(true, true, false, false, "wizard_area1");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#detection").show();

			initISP();
		}

		function showConnectTypeBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_cfginter);
			$("#wizard_wording").html(m_wizard_pleaseselinter);

			funTopology(true, true, false, false, "wizard_area2");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#selectConnectionType").show();

			initConnectionType();
		}

		function showDHCPBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_dhcp);
			$("#wizard_wording").html(m_wizard_dhcpdesc);

			funTopology(true, true, false, false, "wizard_area1");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#dhcp_setupTable").show();

			initDHCP();
		}

		function showStaticBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_staticip);
			$("#wizard_wording").html(m_wizard_staticipdesc);

			funTopology(true, true, false, false, "wizard_area2");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#staticIP_setupTable").show();

			initStatic();
		}

		function showPPPoEBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_pppoe);
			$("#wizard_wording").html(m_wizard_pppoedesc);

			funTopology(true, true, false, false, "wizard_area1");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#pppoe_setupTable").show();

			initPPPoE();
		}

		function showPPPoABody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_pppoa);
			$("#wizard_wording").html(m_wizard_pppoadesc);

			funTopology(true, true, false, false, "wizard_area1");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#pppoa_setupTable").show();

			initPPPoA();
		}

		function showBridgeBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_bridge);
			$("#wizard_wording").html(m_wizard_bridgedesc);

			funTopology(true, true, false, false, "wizard_area1");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#bridge_setupTable").show();

			initBridge();
		}

		function showWifiBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_wifi);
			$("#wizard_wording").html(m_wizard_wifidesc);

			funTopology(true, false, true, false, "wizard_area1");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#wifi_setupTable").show();

			initWIFI();
		}

		function showDevicePasswordBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_deviceadmin);
			$("#wizard_wording").html(m_wizard_admindesc);

			funTopology(true, false, false, true, "wizard_area1");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_next, true, true);

			$("#devicePassword_setupTable").show();

			initPass();
		}

		function showConfirmBody() {
			hiddenAllBody();

			$("#wizard_title").html(m_wizard_summary);
			$("#wizard_wording").html(m_wizard_summarydesc);

			funTopology(true, true, true, false, "wizard_area1");

			setButton("btn_back", m_wizard_back, true, true);
			setButton("btn_next", m_wizard_finish, true, true);

			$("#confirm_setup").show();

			initConfirm();
		}

	</script>

	<script type="text/javascript">

		var isp_val = {
			"sessionKey": "",
			"wanType": "",
			"country": "",
			"vciView": "",
			"vpiView": "",
			"isp": "",
			"enc": "",
			"vlanid": ""
		};

		var change_isp_val = {
			"conntype": "",
			"conntype2": "",
			"encapsulation": "",
			"vpi": "",
			"vci": "",
			"mtu": "",
			"vlanid": "",
			"wanMode": "",
			"notISP_conntype": ""
		}

		function refreshCoutryList() {

			var wanType = $("#isp_wan_access_type").val();

			var wanMode = "ATM";
			if (wanType == "VDSL")
				wanMode = "PTM";

			$("#isp_country").selectbox('detach');

			$("#isp_country").empty();

			var coutry_count = 0;

			if (wanMode == "ATM") {
				for (var i = 0; i < isp_list.adsl.length; i++) {
					var countryname = isp_list.adsl[i].country_name;
					$("#isp_country").append('<option value="' + countryname + '">' + countryname + '</option>');
					coutry_count++;
				}
			} else {
				for (var i = 0; i < isp_list.vdsl.length; i++) {
					var countryname = isp_list.vdsl[i].country_name;
					$("#isp_country").append('<option value="' + countryname + '">' + countryname + '</option>');
					coutry_count++;
				}
			}

			$("#isp_country").append('<option value="" selected>' + m_wizard_notlist + '</option>');
			coutry_count++;

			var selectObj = new Object;
			var MH = coutry_count * 35;
			selectObj.maxHeight = ( MH < 260 ? MH : 260 );
			selectObj.direction = "up";
			$("#isp_country").selectbox(selectObj);
		}

		function refreshISPList() {

			var wanType = $("#isp_wan_access_type").val();

			var wanMode = "ATM";
			if (wanType == "VDSL")
				wanMode = "PTM";

			$("#isp_isp").selectbox('detach');

			$("#isp_isp").empty();

			var isp_count = 0;

			if (wanMode == "ATM") {
				for (var i = 0; i < isp_list.adsl.length; i++) {
					if ($("#isp_country").val() == isp_list.adsl[i].country_name) {
						for (var z = 0; z < isp_list.adsl[i].isp_list.length; z++) {
							var ispname = isp_list.adsl[i].isp_list[z].isp_name;
							$("#isp_isp").append('<option value="' + ispname + '">' + ispname + '</option>');
							isp_count++;
						}
					}
				}
			} else {
				for (var i = 0; i < isp_list.vdsl.length; i++) {
					if ($("#isp_country").val() == isp_list.vdsl[i].country_name) {
						for (var z = 0; z < isp_list.vdsl[i].isp_list.length; z++) {
							var ispname = isp_list.vdsl[i].isp_list[z].isp_name;
							$("#isp_isp").append('<option value="' + ispname + '">' + ispname + '</option>');
							isp_count++;
						}
					}
				}
			}

			$("#isp_isp").append('<option value="" selected>' + m_wizard_notlist + '</option>');
			isp_count++;

			var selectObj = new Object;
			var MH = isp_count * 35;
			selectObj.maxHeight = ( MH < 300 ? MH : 300 );
			selectObj.direction = "up";
			$("#isp_isp").selectbox(selectObj);
		}

		function doChangeWanMode() {
			refreshCoutryList();
			refreshISPList();
			doChangeISP()
		}

		function doChangeCountry() {
			refreshISPList();
			doChangeISP()
		}

		function doChangeISP() {

			hideISPErrorInfo();

			var wanType = $("#isp_wan_access_type").val();

			var g_wanMode = "ATM";
			if (wanType == "VDSL")
				g_wanMode = "PTM";

			$("#vpi_vlan_th").html("");
			$("#vpi_vlan_td").html("");
			$("#vci_th").html("");
			$("#vci_td").html("");

			change_isp_val = {
				"conntype": "",
				"conntype2": "",
				"encapsulation": "",
				"vpi": "",
				"vci": "",
				"mtu": "",
				"vlanid": "",
				"wanMode": g_wanMode,
				"notISP_conntype": ""
			}

			if ($("#isp_isp").val() == "") {

				if (change_isp_val.wanMode == "ATM") {
					$("#vpi_vlan_th").html(m_wizard_isp_vpi+":");
					$("#vpi_vlan_td").html('<input class="styled-text" size="30" id="isp_vpiView" name="isp_vpiView" type="text" style="width: 50px">');

					$("#vci_th").html(m_wizard_isp_vci+":");
					$("#vci_td").html('<input class="styled-text" size="30" id="isp_vciView" name="isp_vciView" type="text" style="width: 50px">');

					$("#isp_vpiView").val(isp_val.vpiView);
					$("#isp_vciView").val(isp_val.vciView);
				} else {
					$("#vpi_vlan_th").html(m_internet_vlanid);
					$("#vpi_vlan_td").html('<input class="styled-text" size="30" id="isp_vlanid" name="isp_vlanid" type="text" style="width: 50px">');
					$("#isp_vlanid").val(isp_val.vlanid);
				}

			} else {

				if (change_isp_val.wanMode == "ATM") {

					$("#vpi_vlan_th").html(m_wizard_isp_vpi+":");
					$("#vpi_vlan_td").html('<input class="styled-text" size="30" id="isp_vpiView" name="isp_vpiView" type="text" style="width: 50px" disabled>');

					$("#vci_th").html(m_wizard_isp_vci+":");
					$("#vci_td").html('<input class="styled-text" size="30" id="isp_vciView" name="isp_vciView" type="text" style="width: 50px" disabled>');
					$("#isp_vpiView").val(isp_val.vpiView);
					$("#isp_vciView").val(isp_val.vciView);
					for (var i = 0; i < isp_list.adsl.length; i++) {
						if ($("#isp_country").val() == isp_list.adsl[i].country_name) {
							for (var z = 0; z < isp_list.adsl[i].isp_list.length; z++) {
								if ($("#isp_isp").val() == isp_list.adsl[i].isp_list[z].isp_name) {
									change_isp_val.conntype = isp_list.adsl[i].isp_list[z].isp_set.conntype;
									change_isp_val.conntype2 = isp_list.adsl[i].isp_list[z].isp_set.conntype2;
									change_isp_val.encapsulation = isp_list.adsl[i].isp_list[z].isp_set.encapsulation;
									change_isp_val.vpi = isp_list.adsl[i].isp_list[z].isp_set.vpi;
									change_isp_val.vci = isp_list.adsl[i].isp_list[z].isp_set.vci;
									change_isp_val.mtu = isp_list.adsl[i].isp_list[z].isp_set.mtu;
									change_isp_val.vlanid = isp_list.adsl[i].isp_list[z].isp_set.vlanid;
									$("#isp_vpiView").val(change_isp_val.vpi);
									$("#isp_vciView").val(change_isp_val.vci);

									return change_isp_val;
								}
							}
						}
					}
				} else {

					$("#vpi_vlan_th").html(m_internet_vlanid);
					$("#vpi_vlan_td").html('<input class="styled-text" size="30" id="isp_vlanid" name="isp_vlanid" type="text" style="width: 50px" disabled>');
					$("#isp_vlanid").val(isp_val.vlanid);
					for (var i = 0; i < isp_list.vdsl.length; i++) {
						if ($("#isp_country").val() == isp_list.vdsl[i].country_name) {
							for (var z = 0; z < isp_list.vdsl[i].isp_list.length; z++) {
								if ($("#isp_isp").val() == isp_list.vdsl[i].isp_list[z].isp_name) {
									change_isp_val.conntype = isp_list.vdsl[i].isp_list[z].isp_set.conntype;
									change_isp_val.conntype2 = isp_list.vdsl[i].isp_list[z].isp_set.conntype2;
									change_isp_val.encapsulation = isp_list.vdsl[i].isp_list[z].isp_set.encapsulation;
									change_isp_val.vpi = isp_list.vdsl[i].isp_list[z].isp_set.vpi;
									change_isp_val.vci = isp_list.vdsl[i].isp_list[z].isp_set.vci;
									change_isp_val.mtu = isp_list.vdsl[i].isp_list[z].isp_set.mtu;
									change_isp_val.vlanid = isp_list.vdsl[i].isp_list[z].isp_set.vlanid;
									$("#isp_vlanid").val(change_isp_val.vlanid);
									return change_isp_val;
								}
							}
						}
					}
				}
			}

			return {};
		}

		function initISP() {

			$('.errTxt').hide();

			$.get("/cgi-bin/get/New_GUI/wizard_isp.asp", function() {

				var customize_bool = false;

				if(self.location.href.indexOf('firstAccess') != "-1") {
					if (lineState != "up" && WanMode == "Auto") {
						customize_bool = true;
					}
				}

				if (customize_bool) {
					$("#isp_wan_access_type").val("ADSL");
					$("#isp_wan_access_type").selectbox('change', "ADSL", $("#isp_wan_access_type").find('option:selected').text());

					refreshCoutryList();

					$("#isp_country").val("Italy");
					$("#isp_country").selectbox('change', "Italy", $("#isp_country").find('option:selected').text());

					refreshISPList();

					$("#isp_isp").val('Telecom Italia');
					$("#isp_isp").selectbox('change', 'Telecom Italia', $("#isp_isp").find('option:selected').text());
				} else {

					if (WanMode == "Auto") {
						WanMode = "ADSL";
						if(TransMode == "PTM")
							WanMode = "VDSL";
					}

					$("#isp_wan_access_type").val(WanMode);
					$("#isp_wan_access_type").selectbox('change', WanMode, $("#isp_wan_access_type").find('option:selected').text());

					refreshCoutryList();

					$("#isp_country").val(country);
					$("#isp_country").selectbox('change', country, $("#isp_country").find('option:selected').text());

					refreshISPList();

					$("#isp_isp").val(isp);
					$("#isp_isp").selectbox('change', isp, $("#isp_isp").find('option:selected').text());
				}

				isp_val.vpiView = vpi;
				isp_val.vciView = vci;
				isp_val.vlanid = vlanid;
				isp_val.country = decodeSpecialChr(country);
				isp_val.isp = decodeSpecialChr(isp);
				isp_val.data_list = data_list;

				doChangeISP();

			}, 'script');

		}

		function hideISPErrorInfo(){
			$("#isp_vpiView_error").html("");
			$("#isp_vciView_error").html("");
			$("#isp_vlanid_error").html("");
			$("#isp_vpiView_error_div").hide();
			$("#isp_vciView_error_div").hide();
			$("#isp_vlanid_error_div").hide();
		}

		function saveISP() {

			hideISPErrorInfo();

			if (change_isp_val.wanMode == "ATM") {
				if (!isNumber($("#isp_vpiView").val()) || ($("#isp_vpiView").val() < 0) || ($("#isp_vpiView").val() > 255)) {
					$("#isp_vpiView_error").html(_wan_dsl_vpi_error).show();
					$("#isp_vpiView").focus();
					$("#isp_vpiView").select();
					$("#isp_vpiView_error_div").show();
					return false;
				}

				if (!isNumber($("#isp_vciView").val()) || ($("#isp_vciView").val() < 32) || ($("#isp_vciView").val() > 65535)) {
					$("#isp_vciView_error").html(_wan_dsl_vci_error).show();
					$("#isp_vciView").focus();
					$("#isp_vciView").select();
					$("#isp_vciView_error_div").show();
					return false;
				}
				if (!checkVPIVCI($("#isp_vciView").val(), $("#isp_vpiView").val())) {
					$("#isp_vpiView_error").html(_wan_dsl_vpi_exist_error).show();
					$("#isp_vpiView").focus();
					$("#isp_vpiView").select();
					$("#isp_vpiView_error_div").show();
					return false;
				}
			}

			if (change_isp_val.wanMode == "PTM") {
				if ($("#isp_vlanid").val() != "") {
					if (!isNumber($("#isp_vlanid").val()) || (parseInt($("#isp_vlanid").val()) < 1) || (parseInt($("#isp_vlanid").val()) > 4094)) {
						$("#isp_vlanid_error").html(m_internet_alertvalanid).show();
						$("#isp_vlanid").focus();
						$("#isp_vlanid").select();
						$("#isp_vlanid_error_div").show();
						return false;
					}
				}
			}

			// showWaitImage();

			setTimeout(function() {

				$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {
					isp_val.sessionKey = sessionKey;
					isp_val.wanType = $("#isp_wan_access_type").val();
					isp_val.country = $("#isp_country").val();
					isp_val.isp = $("#isp_isp").val();

					if (change_isp_val.wanMode == "ATM") {
						isp_val.vciView = $("#isp_vciView").val();
						isp_val.vpiView = $("#isp_vpiView").val();
					} else {
						isp_val.vciView = "";
						isp_val.vpiView = "";
					}

					if (change_isp_val.wanMode == "PTM") {
						isp_val.vlanid = $("#isp_vlanid").val();
						if ($("#isp_vlanid").val() == "" || $("#isp_vlanid").val() == "0")
							isp_val.vlanid_switch = "No";
						else
							isp_val.vlanid_switch = "Yes";
					} else {
						isp_val.vlanid = "";
						isp_val.vlanid_switch = "No";
					}

					isp_val.g_wanMode = change_isp_val.wanMode;

					$.post("/cgi-bin/New_GUI/Set/wizard_isp_setting.asp", isp_val, function() {

						hideWaitImage();

						switch (change_isp_val.conntype) {
							case "":
								wizard_Step = 2; // select connect type
								showConnectTypeBody();
								break;
							case "Dynamic IP":
								wizard_Step = 3; // dhcp page
								if (isp_val.g_wanMode == "PTM") {
									wizard_next(wizard_Step);
								} else {
									showDHCPBody();
								}
								break;
							case "Static IP":
								wizard_Step = 4; // static page
								showStaticBody();
								break;
							case "PPPoE":
								wizard_Step = 5; // pppoe page
								showPPPoEBody();
								break;
							case "PPPoA":
								wizard_Step = 6; // pppoa page
								showPPPoABody();
								break;
							case "Bridge":
								wizard_Step = 7; // bridge page
								if (isp_val.g_wanMode == "PTM") {
									wizard_next(wizard_Step);
								} else {
									showBridgeBody();
								}
								break;
						}

					});

				});

			}, 500);

		}

	</script>

	<script type="text/javascript">
		
		var selectType = "Dynamic IP";

		function selectConnectionType(type) {

			switch(type) {
				case "dhcp":
					selectType = "Dynamic IP";
					break;
				case "pppoe":
					selectType = "PPPoE";
					break;
				case "pppoa":
					selectType = "PPPoA";
					break;
				case "bridge":
					selectType = "Bridge";
					break;
				case "static":
					selectType = "Static IP";
					break;
			}

			if (type == "dhcp" && document.getElementById('cb_dhcp').getAttribute('class') == 'unclick') {
				cb_dhcp.setAttribute("class", "clicked");
				cb_pppoe.setAttribute("class", "unclick");
				cb_bridge.setAttribute("class", "unclick");
				cb_static.setAttribute("class", "unclick");
				cb_pppoa.setAttribute("class", "unclick");
			} else if (type == "pppoe" && document.getElementById('cb_pppoe').getAttribute('class') == 'unclick') {
				cb_dhcp.setAttribute("class", "unclick");
				cb_pppoe.setAttribute("class", "clicked");
				cb_bridge.setAttribute("class", "unclick");
				cb_static.setAttribute("class", "unclick");
				cb_pppoa.setAttribute("class", "unclick");
			} else if (type == "pppoa" && document.getElementById('cb_pppoa').getAttribute('class') == 'unclick') {
				cb_dhcp.setAttribute("class", "unclick");
				cb_pppoe.setAttribute("class", "unclick");
				cb_pppoa.setAttribute("class", "clicked");
				cb_static.setAttribute("class", "unclick");
				cb_bridge.setAttribute("class", "unclick");
			} else if (type == "bridge" && document.getElementById('cb_bridge').getAttribute('class') == 'unclick') {
				cb_dhcp.setAttribute("class", "unclick");
				cb_pppoe.setAttribute("class", "unclick");
				cb_bridge.setAttribute("class", "clicked");
				cb_static.setAttribute("class", "unclick");
				cb_pppoa.setAttribute("class", "unclick");
			} else if (type == "static" && document.getElementById('cb_static').getAttribute('class') == 'unclick') {
				cb_dhcp.setAttribute("class", "unclick");
				cb_pppoe.setAttribute("class", "unclick");
				cb_bridge.setAttribute("class", "unclick");
				cb_static.setAttribute("class", "clicked");
				cb_pppoa.setAttribute("class", "unclick");
			}

		}

		function initConnectionType() {

			$('.errTxt').hide();

			$.get("/cgi-bin/get/New_GUI/wizard_connectType.asp", function() {

				var wanType = "adsl";
				switch (isp_val.wanType) {
					case "Auto":
						if (wan_conntype == "ATM") {
							$("#pppoa_option").show();
							$("#pppoa_text").show();
						} else {
							wanType = "vdsl";
							$("#pppoa_option").hide();
							$("#pppoa_text").hide();
						}
						break;
					case "ADSL":
						$("#pppoa_option").show();
						$("#pppoa_text").show();
						break;
					case "VDSL":
						wanType = "vdsl";
						$("#pppoa_option").hide();
						$("#pppoa_text").hide();
						break;
				}

				if (wanType == "vdsl") {
					connMode1 = connMode2;
					pppoe_pppoa = pppoe_enc;
				}

				var type = "dhcp";
				switch (parseInt(connMode1)) {
					case 0:
						type = "dhcp";
						break;
					case 1:
						type = "static";
						break;
					case 2:
						if (wan_conntype != "ATM") {
							type = "pppoe";
						} else {
							if (pppoe_pppoa.indexOf('PPPoA') != '-1')
								type = "pppoa";
							else
								type = "pppoe";
						}
						break;
					case 3:
						type = "bridge";
						break;
				}

				selectConnectionType(type);

			}, 'script');

		}

	</script>

	<script type="text/javascript">

		function initDHCP() {

			$('.errTxt').hide();

			$.get("/cgi-bin/get/New_GUI/wizard_isp.asp", function() {

				initEncaps("uiViewEncaps", "1483 Bridged IP LLC", "1483 Bridged IP VC-Mux", decodeSpecialChr(encap_adsl));

			}, 'script');

		}

		function saveDHCP() {

			// showWaitImage();

			setTimeout(function() {

				$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {

					var dhcp_val = {
						"sessionKey": sessionKey,
						"g_wanMode": change_isp_val.wanMode,
						"enc": $("#uiViewEncaps").val()
					}

					change_isp_val.notISP_conntype = "Dynamic IP";

					$.post("/cgi-bin/New_GUI/Set/wizard_dhcp_setting.asp", dhcp_val, function() {
						hideWaitImage();

						wizard_Step = 8; // wifi page
						showWifiBody();
					});

				});

			}, 500);

		}

	</script>

	<script type="text/javascript">

		function initStatic() {

			$('.errTxt').hide();

			$.get("/cgi-bin/get/New_GUI/wizard_static.asp", function() {

				if (staticip != "N/A")
					$("#static_ipAddress").val(staticip);
				if (staticnet != "N/A")
					$("#static_subnetMask").val(staticnet);
				if (staticngwy != "N/A")
					$("#static_gateway").val(staticngwy);

				initEncaps("static_uiViewEncaps", "1483 Bridged IP LLC", "1483 Bridged IP VC-Mux", decodeSpecialChr(encap_adsl));

			}, 'script');

		}

		function saveStatic() {

			$('.errTxt').hide();

			if (!is_valid_ip($("#static_ipAddress").val(), 0)) {
				$('#err_staticip').show().html("<br>" + m_wizard_err7);
				$("#static_ipAddress").focus();
				$("#static_ipAddress").select();
				return false;
			}

			if (!is_valid_mask($("#static_subnetMask").val())) {
				$('#err_staticsub').show().html("<br>" + m_wizard_err8);
				$("#static_subnetMask").focus();
				$("#static_subnetMask").select();
				return false;
			}

			if (!is_valid_ip2($("#static_ipAddress").val(), $("#static_subnetMask").val())) {
				$('#err_staticip').show().html("<br>" + m_wizard_err7);
				$("#static_ipAddress").focus();
				$("#static_ipAddress").select();
				return false;
			}

			if (!is_valid_gateway($("#static_ipAddress").val(), $("#static_subnetMask").val(), $("#static_gateway").val(), 0)) {
				$('#err_staticgateway').show().html("<br>" + m_wizard_err9);
				$("#static_gateway").focus();
				$("#static_gateway").select();
				return false;
			}

			if (is_valid_network($("#static_ipAddress").val(), $("#static_subnetMask").val())) {
				$('#err_staticip').show().html("<br>" + m_wizard_err7);
				$("#static_ipAddress").focus();
				$("#static_ipAddress").select();
				return false;
			}

			var net1 = get_network_id($("#static_ipAddress").val(), $("#static_subnetMask").val());
			var net2 = get_network_id($("#static_gateway").val(), $("#static_subnetMask").val());

			if (net1[0] != net2[0]) {
				$('#err_staticgateway').show().html("<br>" + m_wizard_err9);
				$("#static_gateway").focus();
				$("#static_gateway").select();
				return false;
			}

			// showWaitImage();

			setTimeout(function() {

				$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {

					var static_val = {
						"sessionKey": sessionKey,
						"g_wanMode": change_isp_val.wanMode,
						"static_ip": $("#static_ipAddress").val(),
						"static_netmask": $("#static_subnetMask").val(),
						"static_gateway": $("#static_gateway").val(),
						"enc": $("#static_uiViewEncaps").val()
					}

					change_isp_val.notISP_conntype = "Static IP";

					$.post("/cgi-bin/New_GUI/Set/wizard_static_setting.asp", static_val, function() {

						hideWaitImage();

						wizard_Step = 8; // wifi page
						showWifiBody();

					});

				});

			}, 500);

		}

	</script>

	<script type="text/javascript">

		function initPPPoE() {

			$('.errTxt').hide();

			$.get("/cgi-bin/get/New_GUI/wizard_ppp.asp", function() {

				if (change_isp_val.wanMode == "ATM") {

					$("#pppoe_username").val(decodeSpecialChr(pppname));
					$("#pppoe_password").val(decodeSpecialChr(pppwd));

				} else {

					$("#pppoe_username").val(decodeSpecialChr(pppname_v));
					$("#pppoe_password").val(decodeSpecialChr(pppwd_v));

				}

				initEncaps("ppp_uiViewEncaps", "PPPoE LLC", "PPPoE VC-Mux", decodeSpecialChr(encap_adsl));

			}, 'script');

		}

		function savePPPoE() {

			$('.errTxt').hide();

			if ($("#pppoe_username").val().length == 0 || ($("#pppoe_username").val().length != 0 && ($("#pppoe_username").val().length > 64 || $("#pppoe_username").val().length < 3))) {
				$('#err_pppoeusername').show().html("<br>" + _wan_dsl_wanName_error2);
				$("#pppoe_username").focus();
				$("#pppoe_username").select();
				return false;
			}

			if ($("#pppoe_password").val().length == 0 || ($("#pppoe_password").val().length != 0 && ($("#pppoe_password").val().length < 1 || $("#pppoe_password").val().length > 32))) {

				$('#err_pppoepassword').show().html("<br>" + m_wizard_err5);
				$("#pppoe_password").focus();
				$("#pppoe_password").select();
				return false;
			}

			// showWaitImage();

			setTimeout(function() {

				$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {

					var wan_val_ppp = {
						"sessionKey": sessionKey,
						"g_wanMode": change_isp_val.wanMode,
						"userView": $("#pppoe_username").val(),
						"pass1": $("#pppoe_password").val(),
						"enc": $("#ppp_uiViewEncaps").val()
					}

					change_isp_val.notISP_conntype = "PPPoE";

					$.post("/cgi-bin/New_GUI/Set/wizard_wan_setting.asp", wan_val_ppp, function() {
						hideWaitImage();

						wizard_Step = 8; // wifi page
						showWifiBody();
					});

				});

			}, 500);

		}

	</script>

	<script type="text/javascript">
		
		function initPPPoA() {

			$('.errTxt').hide();

			$.get("/cgi-bin/get/New_GUI/wizard_pppoa.asp", function() {

				$("#pppoa_username").val(decodeSpecialChr(pppoaname));
				$("#pppoa_password").val(decodeSpecialChr(pppoapwd));

				initEncaps("ppa_uiViewEncaps", "PPPoA LLC", "PPPoA VC-Mux", decodeSpecialChr(encap_adsl));

			}, 'script');

		}

		function savePPPoA() {

			$('.errTxt').hide();

			if ($("#pppoa_username").val().length == 0 || ($("#pppoa_username").val().length != 0 && ($("#pppoa_username").val().length > 64 || $("#pppoa_username").val().length < 3))) {
				$('#err_pppoausername').show().html("<br>" + _wan_dsl_wanName_error2);
				$("#pppoa_username").focus();
				$("#pppoa_username").select();
				return false;
			}

			if ($("#pppoa_password").val().length == 0 || ($("#pppoa_password").val().length != 0 && ($("#pppoa_password").val().length < 1 || $("#pppoa_password").val().length > 32))) {
				$('#err_pppoapassword').show().html("<br>" + m_wizard_err6);
				$("#pppoa_password").focus();
				$("#pppoa_password").select();
				return false;
			}

			// showWaitImage();

			setTimeout(function() {

				$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {

					var wan_val_pppoa = {
						"sessionKey": sessionKey,
						"g_wanMode": change_isp_val.wanMode,
						"userView": $("#pppoa_username").val(),
						"pass1": $("#pppoa_password").val(),
						"enc": $("#ppa_uiViewEncaps").val()
					}

					change_isp_val.notISP_conntype = "PPPoA";

					$.post("/cgi-bin/New_GUI/Set/wizard_pppoa_setting.asp", wan_val_pppoa, function() {

						hideWaitImage();

						wizard_Step = 8; // wifi page
						showWifiBody();

					});

				});

			}, 500);

		}

	</script>

	<script type="text/javascript">

		function initBridge() {

			$('.errTxt').hide();

			$.get("/cgi-bin/get/New_GUI/wizard_bridge.asp", function() {

				initEncaps("bridge_uiViewEncaps", "1483 Bridged Only LLC", "1483 Bridged Only VC-Mux", decodeSpecialChr(encap_adsl));

			}, 'script');

		}

		function saveBridge() {

			$('.errTxt').hide();

			// showWaitImage();

			setTimeout(function() {

				$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {

					var wan_val_bridge = {
						"sessionKey": sessionKey,
						"g_wanMode": change_isp_val.wanMode,
						"enc": $("#bridge_uiViewEncaps").val()
					}

					change_isp_val.notISP_conntype = "Bridge";

					$.post("/cgi-bin/New_GUI/Set/wizard_bridge_setting.asp", wan_val_bridge, function() {

						hideWaitImage();

						wizard_Step = 8; // wifi page
						showWifiBody();

					});

				});

			}, 500);
		}

	</script>

	<script type="text/javascript">
		
		var wifi_val = {
			"wiz_2lan_ssid": "",
			"wiz_2lan_pwd": "",
			"wiz_2lan_5ssid": "",
			"wiz_2lan_5pwd": "",
			"sessionKey": ""
		};

		function initWIFI() {

			$('.errTxt').hide();

			if(wifi_val.RekeyInterval == undefined) {

				$.get("/cgi-bin/get/New_GUI/wizard_wifi.asp", function() {

					$("#wiz_2lan_ssid").val(decodeSpecialChr(ssid));
					$("#wiz_2lan_pwd").val(decodeSpecialChr(key));
					$("#wiz_2lan_5ssid").val(decodeSpecialChr(ssid5));
					$("#wiz_2lan_5pwd").val(decodeSpecialChr(key5));

					dataWifi24Lists = dataLists_24;
					dataWifiacLists = dataLists_ac;

				}, 'script');

			} else {

				$("#wiz_2lan_ssid").val(wifi_val.wiz_2lan_ssid);
				$("#wiz_2lan_pwd").val(wifi_val.wiz_2lan_pwd);
				$("#wiz_2lan_5ssid").val(wifi_val.wiz_2lan_5ssid);
				$("#wiz_2lan_5pwd").val(wifi_val.wiz_2lan_5pwd);
			}

		}

		function saveWIFI() {

			$('.errTxt').hide();

			var ssid24 = $("#wiz_2lan_ssid").val();

			if (ssid24.length < 3 || ssid24.length > 32) {
				$('#err_ssid').show().html("<br/>" + m_wifi_waringssid);
				$("#wiz_2lan_ssid").focus();
				$("#wiz_2lan_ssid").select();
				return false;
			} else if (isSSIDInvalid(ssid24)) {
				$('#err_ssid').show().html("<br/>" + m_wifi_waringssid);
				$("#wiz_2lan_ssid").focus();
				$("#wiz_2lan_ssid").select();
				return false;
			}
			if (checkSSID(ssid24, 0) == false) {
				$('#err_ssid').show().html("<br/>" + m_wifi_waringssid2);
				$("#wiz_2lan_ssid").focus();
				$("#wiz_2lan_ssid").select();
				return false;
			}

			var ssid5 = $("#wiz_2lan_5ssid").val();

			if (ssid5.length < 3 || ssid5.length > 32) {
				$('#err_5ssid').show().html("<br/>" + m_wifi_waringssid);
				$("#wiz_2lan_5ssid").focus();
				$("#wiz_2lan_5ssid").select();
				return false;
			} else if (isSSIDInvalid(ssid5)) {
				$('#err_5ssid').show().html("<br/>" + m_wifi_waringssid);
				$("#wiz_2lan_5ssid").focus();
				$("#wiz_2lan_5ssid").select();
				return false;
			}
			if (checkSSID_ac(ssid5, 0) == false) {
				$('#err_5ssid').show().html("<br/>" + m_wifi_waringssid2);
				$("#wiz_2lan_5ssid").focus();
				$("#wiz_2lan_5ssid").select();
				return false;
			}

			if (($("#wiz_2lan_pwd").val().length < 8) || ($("#wiz_2lan_pwd").val().length > 63) || (isWPAKeyInvalid($("#wiz_2lan_pwd").val()))) {

				$("#err_wifipwd").show().html("<br/>" + m_wizard_err12);
				$("#wiz_2lan_pwd").focus();
				$("#wiz_2lan_pwd").select();
				return false;

			}

			if (strchk_unicode($("#wiz_2lan_pwd").val())) {

				$("#err_wifipwd").show().html("<br/>" + m_wizard_err13);
				$("#wiz_2lan_pwd").focus();
				$("#wiz_2lan_pwd").select();
				return false;

			}

			if (($("#wiz_2lan_5pwd").val().length < 8) || ($("#wiz_2lan_5pwd").val().length > 63) || (isWPAKeyInvalid($("#wiz_2lan_5pwd").val()))) {

				$("#err_5wifipwd").show().html("<br/>" + m_wizard_err12);
				$("#wiz_2lan_5pwd").focus();
				$("#wiz_2lan_5pwd").select();
				return false;

			}

			if (strchk_unicode($("#wiz_2lan_5pwd").val())) {

				$("#err_5wifipwd").show().html("<br/>" + m_wizard_err13);
				$("#wiz_2lan_5pwd").focus();
				$("#wiz_2lan_5pwd").select();
				return false;

			}

			wifi_val.wiz_2lan_ssid = $("#wiz_2lan_ssid").val();
			wifi_val.wiz_2lan_pwd = $("#wiz_2lan_pwd").val();
			wifi_val.wiz_2lan_5ssid = $("#wiz_2lan_5ssid").val();
			wifi_val.wiz_2lan_5pwd = $("#wiz_2lan_5pwd").val();
			wifi_val.WPSConfMode = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","WPSConfMode","s")%>');
			wifi_val.WPSConfStatus = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","WPSConfStatus","s")%>');
			wifi_val.HideSSID = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","HideSSID","s")%>');
			wifi_val.WMM = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","WMM","s")%>');
			wifi_val.EncrypType = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","EncrypType","s")%>');
			wifi_val.RekeyInterval = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","RekeyInterval","s")%>');

			wifi_val.WPSConfMode_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","WPSConfMode","s")%>');
			wifi_val.WPSConfStatus_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","WPSConfStatus","s")%>');
			wifi_val.HideSSID_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","HideSSID","s")%>');
			wifi_val.WMM_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","WMM","s")%>');
			wifi_val.EncrypType_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","EncrypType","s")%>');
			wifi_val.RekeyInterval_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","RekeyInterval","s")%>');

			// showWaitImage();

			hideWaitImage();

			wizard_Step = 9; // device password page
			showDevicePasswordBody();

			/*setTimeout(function() {

				$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {
					wifi_val.sessionKey = sessionKey;
					$.post("/cgi-bin/New_GUI/Set/wizard_wifi_setting.asp", wifi_val, function() {

						hideWaitImage();

						wizard_Step = 9; // device password page
						showDevicePasswordBody();

					});
				});

			}, 500);*/

		}

	</script>

	<script type="text/javascript">
		
		var pass_val = {
			"admin_pass": "",
			"sessionKey": ""
		};

		function initPass() {
			$('.errTxt').hide();
			$("#device_password").val(decodeSpecialChr('<%TCWebApi_get("Account_Entry0","web_passwd","s")%>'));
		}

		function savePass() {
			if (($("#device_password").val() == 0) || ($("#device_password").val().length > 15) || (!Prefixes_Rule_cgi_num($("#device_password").val()))) {
				$('#err_pwd').show().html("<br/>" + m_wizard_err14);

				$("#device_password").focus();
				$("#device_password").select();
				return false;
			}

			// showWaitImage();

			setTimeout(function() {

				$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {

					pass_val.sessionKey = sessionKey;
					pass_val.admin_pass = $("#device_password").val();
					$.post("/cgi-bin/New_GUI/Set/wizard_pass_setting.asp", pass_val, function() {

						hideWaitImage();

						wizard_Step = 10; // confirm page
						showConfirmBody();

					});

				});

			}, 500);

		}

	</script>

	<script type="text/javascript">
		
		function initConfirm() {			

			$('.errTxt').hide();

			$.get("/cgi-bin/get/New_GUI/wizard_info.asp", function() {

				var str = new String("");
				var connectStatus;

				if (connecttype1 == 0) {
					str = "Dynamic IP Address";
				} else if (connecttype1 == 1) {
					str = "Static IP Address";
				} else if (connecttype1 == 2) {
					if (pppoe_pppoa.indexOf('PPPoA') != '-1')
						str = "PPPoA";
					else
						str = "PPPoE";
				} else if (connecttype1 == 3) {
					str = "Bridge";
				}

				switch (wan_type) {
					case "ATM":
						connectStatus = connectStatus1;
						break;
					case "Ethernet":
						connectStatus = connectStatus2;
						break;
					case "PTM":
						connectStatus = connectStatus3;
						break;
				}

				if (connectStatus == "1")
					str += "(online)";
				else
					str += "(offline)";

				$("#confirm_connection_type").html(str);

			}, 'script');

			$("#confirm_wan_type").text($("#isp_wan_access_type").find("option:selected").text());

			$("#confirm_wifi_networkName24G").text(wifi_val.wiz_2lan_ssid);
			$("#confirm_wifi_password24G").text(wifi_val.wiz_2lan_pwd);
			$("#confirm_wifi_networkName5G").text(wifi_val.wiz_2lan_5ssid);
			$("#confirm_wifi_5password24G").text(wifi_val.wiz_2lan_5pwd);

			$("#confirm_device_password").text(pass_val.admin_pass);

		}

	</script>

	<script language="JavaScript">

		$(function() {

			$(".checkbox_on, .checkbox_off").click(function() {
				SetCheckBoxEnable($(this).attr("id"));
			});

			$("select").selectbox();

		});

	</script>

	<body onload="">

		<div id="wrapper">
			<!-- ------------------ Logo ------------------------ -->
			<div id="Lheader">
				<div id="logo">
					<img id="DLink_logo" src="/graphic/New_GUI/logo_2.gif" height="95" width="105">
				</div>
				<table class="versionTable2" id="versionTable2" border="0" cellspacing="0">
					<tbody></tbody>
					<thead>
						<tr>
							<td><script>prints(m_wizard_modelname);</script>:&nbsp;<label id="modelName"><%TCWebApi_get("SysInfo_Entry","ProductName","s")%></label></td>
							<td><script>prints(m_wizard_hw);</script>:&nbsp;<label id="HWversion"><%TCWebApi_get("DeviceInfo","HwVer","s")%></label></td>
							<td><script>prints(m_wizard_fw);</script>:&nbsp;<label id="FWversion"><%TCWebApi_get("DeviceInfo","FwVer","s")%></label></td>
						</tr>
					</thead>
				</table>
			</div>
			<!-- ------------------ Content -------------------- -->
			<div id="dialogBox_Background"></div>
			<div id="content">
				<div style="display: inline;" id="createPop_Manual">
					<div id="popRect">
						<div id="dialogBox" style="width: 616px; overflow-x: hidden; overflow-y: auto; max-height: 636px; top: 0px;">
							<div id="wizard_title_bg"><div id="wizard_title"><script>prints(m_wizard_welcome);</script></div>
						</div>
						<div id="closeCreatePopBtn" onclick="clearCreateRulePOP()" style="cursor:pointer"></div>
						<!--///////////////////////////////Topology//////////////////////////////////-->
						<div style="display: inline;" id="wizard_topology">
							<div id="topology">
								<div id="wizard_internet"></div>
								<div classname="wizard_wan_line_off" id="wizard_wan_line" class="wizard_wan_line_off"></div>
								<div classname="wizard_router_off" id="wizard_router" class="wizard_router_off"></div>
								<div classname="wizard_wifi_line_off" id="wizard_wifi_line" class="wizard_wifi_line_off"></div>
								<div id="wizard_wifi"></div>
							</div>
							<table id="wizard_deviceName" border="0">
								<tbody>
									<tr>
										<td><script>prints(m_wizard_internet);</script></td>
										<td><label id="modelName2"><%TCWebApi_get("SysInfo_Entry","ProductName","s")%></label></td>
										<td><script>prints(m_wizard_wificlient);</script></td>
									</tr>
								</tbody>
							</table>
						</div>
						<!--///////////////////////////////Settings//////////////////////////////////-->
						<div id="wizard_settings">
							<!--0.Welcome-->
							<div classname="wizard_area1" id="wizard_settings_area" class="wizard_area1">
								<div id="wizard_wording" class="wizard_wording_r"><script>prints(m_wizard_settingdesc0);</script></div>
								<div id="wizard_settings_body">
									<!-- 1. wizard begin -->
									<table style="display: inline;" id="wizard_setupTable" border="0">
										<tbody>
											<tr><th style="text-align: left;"><script>prints(m_wizard_settingdesc1);</script></th></tr>
											<tr><th style="text-align: left;"><script>prints(m_wizard_settingdesc2);</script></th></tr>
											<tr><th style="text-align: left;"><script>prints(m_wizard_settingdesc3);</script></th></tr>
										</tbody>
									</table>
									<!--2.ISP-->
									<div style="display: none;" id="detection">
										<table style="margin:10px 0px 0px 0px;" border="0">
											<tbody>
												<tr>
													<th style="text-align:right; width: 30%;">
														<script>prints(m_wizard_isp_wan_access_type);</script>:
													</th>
													<td style="width: 30%;">
														<select id="isp_wan_access_type" name="isp_wan_access_type" onchange="doChangeWanMode()">
															<script>
																var str = "";
																// str += "<option value='Auto'>"+_wan_dsl_setting_3g_mode_auto+"</option>";
																str += "<option value='VDSL'>"+_wan_dsl_setting_ptm+"</option>";
																str += "<option value='ADSL'>"+_wan_dsl_setting_adsl+"</option>";
																prints(str);
															</script>
														</select>
													</td>
													<th style="text-align:right;width: 15%;" id="vpi_vlan_th"></th>
													<td style="width: 15%;" id="vpi_vlan_td"></td>
												</tr>

												<tr id="isp_vpiView_error_div" style="display: none;">
													<td></td>
													<td></td>
													<td colspan='2'><span class="errTxt" id="isp_vpiView_error" style="color:#FB0314" ></td>
												</tr>

												<tr id="isp_vlanid_error_div" style="display: none;">
													<td></td>
													<td></td>
													<td colspan='2'><span class="errTxt" id="isp_vlanid_error" style="color:#FB0314" ></td>
												</tr>

												<tr>
													<th style="text-align:right;"><script>prints(m_wizard_isp_country);</script>:</th>
													<td>
														<select id="isp_country" name="isp_country" onchange="doChangeCountry()">
														</select>
													</td>
													<th style="text-align:right;" id="vci_th"></th>
													<td id="vci_td"></td>
												</tr>

												<tr id="isp_vciView_error_div" style="display: none;">
													<td></td>
													<td></td>
													<td colspan='2'><span class="errTxt" id="isp_vciView_error" style="color:#FB0314" ></td>
												</tr>

												<tr>
													<th style="text-align:right;"><script>prints(m_wizard_isp_isp);</script>:</th>
													<td>
														<select id="isp_isp" name="isp_isp" onchange="doChangeISP()">
														</select>
													</td>
													<th style="text-align:right;width: 15%;"></th>
													<td style="width: 15%;"></td>
												</tr>												
											</tbody>
										</table>
									</div>
									<!--3.Manually select connection type-->
									<div style="display: none;" id="selectConnectionType">
										<table id="connectionType_Table" style="margin:10px 0px 0px 0px;" border="0">
											<tbody>
												<tr>
													<td style="width:10px;">
														<div id="cb_dhcp" class="clicked" onclick="selectConnectionType('dhcp');"></div>
													</td>
													<th style="text-align: left;"><script>prints(m_wizard_dhcpadd);</script></th>
												</tr>
												<tr>
													<td></td>
													<td><script>prints(m_wizard_dhcpadddesc);</script></td>
												</tr>
												<tr>
													<td style="width:10px;">
														<div id="cb_static" class="unclick" onclick="selectConnectionType('static');"></div>
													</td>
													<th style="text-align: left;"><script>prints(m_wizard_staticipadd);</script></th>
												</tr>
												<tr>
													<td></td>
													<td><script>prints(m_wizard_staticipadddesc);</script></td>
												</tr>
												<tr>
													<td style="width:10px;">
														<div id="cb_pppoe" class="unclick" onclick="selectConnectionType('pppoe');"></div>
													</td>
													<th style="text-align: left;"><script>prints(m_wizard_pppoe);</script></th>
												</tr>
												<tr>
													<td></td>
													<td><script>prints(m_wizard_pppoedesc1);</script></td>
												</tr>
												<tr id="pppoa_option">
													<td style="width:10px;">
														<div id="cb_pppoa" class="unclick" onclick="selectConnectionType('pppoa');"></div>
													</td>
													<th style="text-align: left;"><script>prints(m_wizard_pppoa);</script></th>
												</tr>
												<tr id="pppoa_text">
													<td></td>
													<td><script>prints(m_wizard_pppoadesc1);</script></td>
												</tr>
												<tr>
													<td style="width:10px;">
														<div id="cb_bridge" class="unclick" onclick="selectConnectionType('bridge');"></div>
													</td>
													<th style="text-align: left;"> <script>prints(m_wizard_bridgemode);</script>   </th>
												</tr>
												<tr>
													<td></td>
													<td><script>prints(m_wizard_bridgemodedesc);</script></td>
												</tr>
											</tbody>
										</table>
									</div>
									<!--17.DHCP-->
									<table style="display: none;" id="dhcp_setupTable" border="0">
										<tbody>
											<tr>
												<th style="text-align:right;"><script>prints(m_comm_conntype);</script>:</th>
												<td style="width:250px;">
													<div class="styled-select">
														<select id="uiViewEncaps" name="uiViewEncaps">
															<script>
																var str = '';
																str += '<option value="1483 Bridged IP LLC" selected>'+m_internet_bridgeipllc+'</option>';
																str += '<option value="1483 Bridged IP VC-Mux">'+m_internet_bridgeipvc+'</option>';
																str += '<option value="1483 Routed IP LLC(IPoA)">'+m_internet_routedipllc+'</option>';
																str += '<option value="1483 Routed IP VC-Mux">'+m_internet_routeripvc+'</option>';
																prints(str);
															</script>
														</select>
													</div>
												</td>
											</tr>
										</tbody>
									</table>
									<!--5.Static IP Address-->
									<table style="display: none;" id="staticIP_setupTable" border="0">
										<tbody>
											<tr>
												<th style="text-align: right;"><script>prints(m_comm_ip);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="static_ipAddress" name="static_ipAddress" type="text">
													<span class="errTxt" id="err_staticip" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>
											<tr>
												<th style="text-align: right;"><script>prints(m_comm_submask);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="static_subnetMask" name="static_subnetMask" type="text">
													<span class="errTxt" id="err_staticsub" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>											
											<tr>
												<th style="text-align: right;"><script>prints(_wan_dsl_gatewayAddress_lbl);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="static_gateway" name="static_gateway" type="text">
													<span class="errTxt" id="err_staticgateway" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>
											<tr>
												<th style="text-align:right;"><script>prints(_wan_dsl_connectionType_lbl);</script>:</th>
												<td style="width:250px;">
													<div class="styled-select">
														<select id="static_uiViewEncaps" name="static_uiViewEncaps">
															<script>
																var str = '';
																str += '<option value="1483 Bridged IP LLC" selected>'+m_internet_bridgeipllc+'</option>';
																str += '<option value="1483 Bridged IP VC-Mux">'+m_internet_bridgeipvc+'</option>';
																str += '<option value="1483 Routed IP LLC(IPoA)">'+m_internet_routedipllc+'</option>';
																str += '<option value="1483 Routed IP VC-Mux">'+m_internet_routeripvc+'</option>';
																prints(str);
															</script>
														</select>
													</div>
												</td>
											</tr>
										</tbody>
									</table>									
									<!--4.PPPoE-->
									<table style="display: none;" id="pppoe_setupTable" border="0">
										<tbody>
											<tr>
												<th style="text-align:right;"><script>prints(_wan_access_username_lbl);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="pppoe_username" name="pppoe_username" type="text">
													<span class="errTxt" id="err_pppoeusername" style="display:none;color:#FB0314" </span>
												</td>
											</tr>
											<tr>
												<th style="text-align:right;"><script>prints(_wan_access_password_lbl);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="pppoe_password" name="pppoe_password" type="text" autocomplete="off">
													<span class="errTxt" id="err_pppoepassword" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>
											<tr>
												<th style="text-align:right;"><script>prints(m_comm_conntype);</script>:</th>
												<td style="width:250px;">
													<div class="styled-select">
														<select id="ppp_uiViewEncaps" name="ppp_uiViewEncaps">
															<script>
																var str = '';
																str += '<option value="PPPoE LLC" selected>'+m_internet_pppoellc+'</option>';
																str += '<option value="PPPoE VC-Mux">'+m_internet_pppoevc+'</option>';
																prints(str);
															</script>
														</select>
													</div>
												</td>
											</tr>
										</tbody>
									</table>
									<!--4.PPPoA-->
									<table style="display: none;" id="pppoa_setupTable" border="0">
										<tbody>
											<tr>
												<th style="text-align:right;"><script>I18N("h", _wan_access_username_lbl);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="pppoa_username" name="pppoa_username" type="text">
													<span class="errTxt" id="err_pppoausername" style="display:none;color:#FB0314"></span>
												</td>
											</tr>
											<tr>
												<th style="text-align:right;"><script>I18N("h", _wan_access_password_lbl);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="pppoa_password" name="pppoa_password" type="text" autocomplete="off">
													<span class="errTxt" id="err_pppoapassword" style="display:none;color:#FB0314"></span>
												</td>
											</tr>
											<tr>
												<th style="text-align:right;"><script>I18N("h", _wan_dsl_connectionType_lbl);</script>:</th>
												<td style="width:250px;">
													<div class="styled-select">
														<select id="ppa_uiViewEncaps" name="ppa_uiViewEncaps">
															<script>
																var str = '';
																str += '<option value="PPPoA LLC" selected>'+m_internet_pppoallc+'</option>';
																str += '<option value="PPPoA VC-Mux">'+m_internet_pppoavc+'</option>';
																prints(str);
															</script>
														</select>
													</div>
												</td>
											</tr>
										</tbody>
									</table>
									<!--16.Bridge-->
									<table style="display: none;" id="bridge_setupTable" border="0">
										<tbody>
											<tr>
												<th style="text-align:right;"><script>prints(m_comm_conntype);</script>:</th>
												<td style="width:250px;">
													<div class="styled-select">
														<select id="bridge_uiViewEncaps" name="bridge_uiViewEncaps">
															<script>
																var str = '';
																str += '<option value="1483 Bridged Only LLC" selected>'+m_internet_bridgeonly+'</option>';
																str += '<option value="1483 Bridged Only VC-Mux">'+m_internet_bridgevc+'</option>';
																prints(str);
															</script>
														</select>
													</div>
												</td>
											</tr>
										</tbody>
									</table>
									<!--6.Wi-Fi-->
									<table style="display: none;" id="wifi_setupTable" border="0">
										<tbody>
											<tr>
												<th style="text-align:right;"><script>prints(m_wizard_24ssid);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="wiz_2lan_ssid" maxlength="32" name="wiz_2lan_ssid" type="text">
													<span class="errTxt" id="err_ssid" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>
											<tr>
												<th style="text-align:right;"><script>prints(m_wizard_wlpwd);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="wiz_2lan_pwd" maxlength="32" name="wiz_2lan_pwd" type="text">
													<span class="errTxt" id="err_wifipwd" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>

											<tr>
												<th style="text-align:right;"><script>prints(m_wizard_5ssid);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="wiz_2lan_5ssid" maxlength="32" name="wiz_2lan_5ssid" type="text">
													<span class="errTxt" id="err_5ssid" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>
											<tr>
												<th style="text-align:right;"><script>prints(m_wizard_wlpwd);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="wiz_2lan_5pwd" maxlength="32" name="wiz_2lan_5pwd" type="text">
													<span class="errTxt" id="err_5wifipwd" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>
										</tbody>
									</table>
									<!--7.Device Password-->
									<table style="display: none;" id="devicePassword_setupTable" border="0">
										<tbody>
											<tr><th>&nbsp;</th><td></td></tr>
											<tr>
												<th style="text-align:right;"><script>prints(m_wizard_adminpwd);</script>:</th>
												<td style="width:250px;">
													<input class="styled-text" size="30" id="device_password" name="device_password" type="text" autocomplete="off">
													<span class="errTxt" id="err_pwd" style="display:none;color:#FB0314" ></span>
												</td>
											</tr>
										</tbody>
									</table>
									<p></p>
									<!--8.Confirm-->
									<div id="confirm_setup" style="display: none;">
										<table id="confirm_setupTable" border="0">
											<tbody>
												<tr>
													<th><script>prints(m_wizard_isp_wan_access_type);</script>:</th>
													<td><label id="confirm_wan_type"></label></td>
												</tr>	
												<tr>
													<th><script>prints(m_comm_conntype);</script>:</th>
													<td><label id="confirm_connection_type"></label></td>
												</tr>											
												<tr>
													<th><script>prints(m_wizard_24ssid);</script>:</th>
													<td><label id="confirm_wifi_networkName24G"></label></td>
												</tr>
												<tr>
													<th><script>prints(m_wizard_wlpwd);</script>:</th>
													<td><label id="confirm_wifi_password24G"></label></td>
												</tr>
												<tr>
													<th><script>prints(m_wizard_5ssid);</script>:</th>
													<td><label id="confirm_wifi_networkName5G"></label></td>
												</tr>
												<tr>
													<th><script>prints(m_wizard_wlpwd);</script>:</th>
													<td><label id="confirm_wifi_5password24G"></label></td>
												</tr>
												<tr>
													<th><script>prints(m_wizard_adminpwd);</script>:</th>
													<td><label id="confirm_device_password"></label></td>
												</tr>
											</tbody>
										</table>
									</div>																	
								</div>
							</div>
						</div>
						<table id="buttonTable" style="margin: 0px;" border="0">
							<tbody>
								<tr>
									<th></th>
									<td style="text-align:right;" width="20px"><button style="display: none;" type="button" class="styled-button_enable" id="btn_back" onclick="wizard_back(wizard_Step);"><script>I18N("h", m_comm_Cancel);</script></button></td>
									<td style="text-align:left;" width="20px"><button type="button" class="styled-button_enable" id="btn_next" onclick="wizard_next(wizard_Step);"><script>I18N("h", m_wizard_next);</script></button></td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
			<div id="CreatePopAlertMessage" style="display:none">
				<div id="AlertPopRect">
					<div id="AlertPopBody">
						<table class="myAlertPop_table_b" id="waitSettingFinish" style="display:none" border="0" cellspacing="0">
							<tbody>
								<tr>
									<td colspan="2">
										<center><div id="Loading_pop_image"></div></center>
									</td>
								</tr>
								<tr>
								 	<td><label id="reciprocal_Number">&nbsp;</label></td>
								</tr>
								<tr>
									<td colspan="2">
										<div id="dialog_msg_black" style="margin: 20px 0 0 0;"><script>I18N("h", m_wizard_youchangesdesc);</script></div>
									</td>
								</tr>
							</tbody>
						</table>
						<table class="myAlertPop_table_b" id="waitSettingFinish_Setting" style="display:none" border="0" cellspacing="0">
							<tbody>
								<tr>
									<td>
										<center><div id="Loading_pop_image2"></div></center>
									</td>
								</tr>
								<tr>
									<td><label id="reciprocal_Number_Setting"></label></td>
								</tr>
								<tr>
									<td id="dialog_msg_black2"><script>I18N("h", m_comm_changesdesc);</script></td>
								</tr>
							</tbody>
						</table>
						<!-- Reboot -->
						<table class="myAlertPop_table_b" id="REBOOT" style="display:none" border="0" cellspacing="0">
							<tbody>
								<tr>
									<td>
										<center><div id="Loading_pop_image2"></div></center>
									</td>
								</tr>
								<tr>
									<td><label id="reboot_wait_time"></label></td>
								</tr>
								<tr>
									<td id="dialog_msg_black2"><script>I18N("h", m_wizard_reboot);</script></td>
								</tr>
							</tbody>
						</table>
						<!-- Successs Reboot -->
						<table class="myAlertPop_table_b" id="SuccessREBOOT" style="display:none" border="0" cellspacing="0">
							<tbody>
								<tr>
									<td>
										<center><div class="popMessage_icon" style="top: 0px;"></div></center>
									</td>
								</tr>
								<tr>
									<td><label><script>I18N("h", m_systme_rebootok);</script></label></td>
								</tr>
								<tr>
									<td id="dialog_msg_black2" style="padding: 60px 0;">
										<center>
											<div class="popMessage_button" onclick="javascript: self.location.href = '/';"><script>I18N("h", m_comm_ok);</script></div>
										</center>
									</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>

			<br><br><br><br><br><br><br><br><br><br><br><br>
			<br><br><br><br><br><br><br><br><br><br><br><br>
			<div id="footer" border="0">
				<div id="copyright"><script>prints(m_comm_copyright);</script></div>
				<div id="help">
					<a target="_blank" href="http://www.dlink.com/support" style="cursor:pointer;text-Decoration:underline">
						
							<script>prints(m_home_gethelp);</script>
						
					</a>
				</div>
			</div>
		</div>
	</div>
	</body>
</html>