<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns= "http://www.w3c.org/1999/xhtml">

<head>
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/css">
<link rel=stylesheet type="text/css" href="/layout/New_GUI/jquery.selectbox.css?v=20140910163551" />
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJQ.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/configuration/DeviceConfig.js?v=TimeStamp_QzwsxDcRfvTGByHn"></script>

<!--<script src="/LanguageFamily/en/msg_multipe.js" type="text/javascript"></script>-->
<script type="text/javascript">
	var StaticRules = 32;
	var staticLists = new Array();
	var clientLists = new Array();
	var static_modify = -1;					// Add/Modify static
	var lan_value = {
		"lan_ip1": "<%TCWebApi_get("Lan_Entry0","IP","s")%>",
		"lan_netmask1": "<%TCWebApi_get("Lan_Entry0","netmask","s")%>",
		"lan2_enable": "<%TCWebApi_get("LanAlias_Entry0","Active","s")%>",
		"lan_ip2": "<%TCWebApi_get("LanAlias_Entry0","IP","s")%>",
		"lan_netmask2": "<%TCWebApi_get("LanAlias_Entry0","netmask","s")%>",
		"lan_dhcp_type": "<%TCWebApi_get("Lan_Dhcp","type","s")%>",
		"lan_dhcp_start": "<%TCWebApi_get("Dhcpd_Common","start","s")%>",
		"lan_dhcp_count": "<%TCWebApi_get("Dhcpd_Common","pool_count","s")%>",
		"lan_dhcp_lease": "<%TCWebApi_get("Dhcpd_Common","lease","s")%>",
		"lan_dhcp_option60_vendorID": "<%TCWebApi_get("Dhcpd_Option60","VendorID","s")%>",
		"lan_dhcp_pridns": "<%TCWebApi_get("Dproxy_Entry","Lan_PriDNS","s")%>",
		"lan_dhcp_secdns": "<%TCWebApi_get("Dproxy_Entry","Lan_SecDNS","s")%>",
		"lan_dhcp_relay_server": "<%TCWebApi_get("DhcpRelay_Entry","Server","s")%>",
		"upnp_active": "<%TCWebApi_get("Upnpd_Entry","Active","s")%>"
	};

	var lan_ip_flag = false;

	for(var i in lan_value) {
		if(lan_value[i] == "N/A")
			lan_value[i] = "";
	}

	function Load_HTML() {
		$("#header").load("header.asp");
	}
	
	function Initial() {
		initialMenu();
	}
	function encodeSpecialChr(str)
	{
		str=str.replace(/&/g,"&amp;");
		str=str.replace(/</g,"&lt;");
		str=str.replace(/>/g,"&gt;");
		str=str.replace(/"/g,"&quot;");
		str=str.replace(/'/g,"&#39;");
		str=str.replace(/;/g,"\;");
		str=str.replace(/=/g,"&#61;");
		str=str.replace(/\+/g,"&#43;");
		
		return str;
	}
	function InitLAN() {
		$("#lan_ip_1").val(lan_value.lan_ip1);
		$("#lan_mask_1").val(lan_value.lan_netmask1);

		if(lan_value.lan2_enable == "Yes") {
			SetCheckBoxEnable("second_enable", true, true);
			$("#lan_ip_2").removeProp("disabled");
			$("#lan_mask_2").removeProp("disabled");
		} else {
			SetCheckBoxEnable("second_enable", true, false);
			$("#lan_ip_2").prop("disabled", true);
			$("#lan_mask_2").prop("disabled", true);
		}
		$("#lan_ip_2").val(lan_value.lan_ip2);
		$("#lan_mask_2").val(lan_value.lan_netmask2);

		$("tbody[id='dhcp_enable']").hide();
		$("tbody[id='dhcp_relay']").hide();

		
		$("#pool_count").val(lan_value.lan_dhcp_count);

		if(parseInt(lan_value.lan_dhcp_type) >= 0 && parseInt(lan_value.lan_dhcp_type) <= 2) {
			$("div[name='dhcpradio']").eq(lan_value.lan_dhcp_type).attr('class', 'clicked');
			$("#dhcpradioVal").val(lan_value.lan_dhcp_type);
			var tbody_id = $("div[name='dhcpradio']").eq(lan_value.lan_dhcp_type).attr('rel');
			if(tbody_id != "") {
				$("tbody[id='"+tbody_id+"']").show();
			}
		} else {
			$("div[name='dhcpradio']").eq(0).attr('class', 'clicked');
		}

		$("#uiViewStartIP").val(lan_value.lan_dhcp_start);
		var lan_dhcp_s_list = lan_value.lan_dhcp_start.split(".");
		lan_dhcp_s_list[3] = parseInt(lan_dhcp_s_list[3]) + parseInt(lan_value.lan_dhcp_count) - 1;
		$("#uiViewEndIP").val(lan_dhcp_s_list.join("."));

		$("#uiViewLease").val(lan_value.lan_dhcp_lease);

		$("#option60_venderid").val(lan_value.lan_dhcp_option60_vendorID);

		$("#pridns").val(lan_value.lan_dhcp_pridns);
		$("#secdns").val(lan_value.lan_dhcp_secdns);

		$("#server_ip").val(lan_value.lan_dhcp_relay_server);	

		SetCheckBoxEnable("upnp_status", true, (lan_value.upnp_active == "Yes"?true:false));
		
		$("#main").show();
	}

	function doSave() {
		$("label[class='error']").html("");
		
		var lanIPvalue;
		if(is_valid_ip($("#lan_ip_1").val(),0) == false) {
			$("#lan_ip_1_error").html("<br/>"+m_network_error_1);
			return false;
		}

		if($("#lan_mask_1").val() == "") {
			$("#lan_mask_1_error").html("<br/>"+m_network_error_2);
			return false;
		}
		if (!is_valid_mask($("#lan_mask_1").val())) {
			$("#lan_mask_1_error").html("<br/>"+m_network_error_2);
			return false;
		}
		if (!is_valid_ip2($("#lan_ip_1").val(),$("#lan_mask_1").val())) {
			$("#lan_mask_1_error").html("<br/>"+m_network_error_2);
			return false;
		}

		if($("#lan_ip_2").val() != "0.0.0.0") {
			if(is_valid_ip($("#lan_ip_2").val(),0) == false) {
				$("#lan_ip_2_error").html("<br/>"+m_network_error_1);
				return false;
			}
		}
		if($("#lan_mask_2").val() == "") {
			$("#lan_mask_2_error").html("<br/>"+m_network_error_2);
			return false;
		}

		if (!is_valid_mask($("#lan_mask_2").val())) {
			$("#lan_mask_2_error").html("<br/>"+m_network_error_2);
			return false;
		}
		if($("#lan_ip_2").val() != "0.0.0.0") {
			if (!is_valid_ip2($("#lan_ip_2").val(),$("#lan_mask_2").val())) {
				$("#lan_mask_2_error").html("<br/>"+m_network_error_2);
				return false;
			}
		}

		if($("#lan_ip_1").val() == $("#lan_ip_2").val()) {
			$("#lan_ip_2_error").html("<br/>"+m_network_error_3);
			return false;
		}

		if($(".advancedBlock").is(":visible") ) {
			if($("div[name='dhcpradio']").eq(1).attr("class") == "clicked") {
				if (!is_valid_ip($("#uiViewStartIP").val(),0)) {
					$("#uiViewStartIP_error").html("<br/>"+m_network_error_4);
					return false;
				}

				if(checkDhcp($("#uiViewStartIP").val())==false) {
					$("#uiViewStartIP_error").html("<br/>"+m_network_error_5);
					return false;
				}
										

				if (!is_valid_ip($("#uiViewEndIP").val(),0)) {
					$("#uiViewEndIP_error").html("<br/>"+m_network_error_6);
					return false;
				}

				if(checkDhcp($("#uiViewEndIP").val())==false) {
					$("#uiViewEndIP_error").html("<br/>"+m_network_error_5);
					return false;
				}

				var sIP=MathandAbs($("#uiViewStartIP").val()).split(".");
				var eIP=MathandAbs($("#uiViewEndIP").val()).split(".");

				lanIPvalue = $("#lan_ip_1").val().split(".");
				var sIPValue=parseInt(sIP[0])*255*255*255+parseInt(sIP[1])*255*255+parseInt(sIP[2])*255+parseInt(sIP[3]);
				var eIPValue=parseInt(eIP[0])*255*255*255+parseInt(eIP[1])*255*255+parseInt(eIP[2])*255+parseInt(eIP[3]);

				if(sIPValue>eIPValue) {
					$("#uiViewStartIP_error").html("<br/>"+m_network_error_7);
					return false;
				}

				if((parseInt(lanIPvalue[3])<=parseInt(eIP[3]))&&(parseInt(lanIPvalue[3])>=parseInt(sIP[3]))) {
					$("#uiViewStartIP_error").html("<br/>"+m_network_error_8);
					return false;
				}
				
				if($("#option60_venderid").val().length>32) {
					$("#option60_venderid_error").html("<br/>"+m_network_error_9);
					return false;
				}
				
				var pdns = $.trim($("#pridns").val());
				var sdns = $.trim($("#secdns").val());				

				if (pdns != "" && sdns != "") {
					if (!is_valid_ip(pdns,0)) {
						$("#pridns_error").html("<br/>"+m_network_dns_error1);
						return false;
					}

					if (!is_valid_ip(sdns,0)) {
						$("#secdns_error").html("<br/>"+m_network_dns_error2);
						return false;
					}

					if(pdns == sdns) {
						$("#secdns_error").html("<br/>"+m_network_dns_error4);
						return false;
					}
				} else if (pdns != "" && sdns == "") {
					if (!is_valid_ip(pdns,0)) {
						$("#pridns_error").html("<br/>"+m_network_dns_error1);
						return false;
					}
				} else if (pdns == "" && sdns == "") {

				} else {
					$("#secdns_error").html("<br/>"+m_network_dns_error3);
					return false;
				}

				var startIP = $("#uiViewStartIP").val().split(".");
				var endIP = $("#uiViewEndIP").val().split(".");				

				lan_value.lan_dhcp_start = startIP.join(".");
				lan_value.lan_dhcp_count = (parseInt(endIP[3]) - parseInt(startIP[3]) + 1);

				lan_value.lan_dhcp_lease = $("#uiViewLease").val();
				lan_value.lan_dhcp_option60_vendorID = $("#option60_venderid").val();

				lan_value.lan_dhcp_pridns = $("#pridns").val();
				lan_value.lan_dhcp_secdns = $("#secdns").val();
			} else if($("div[name='dhcpradio']").eq(2).attr("class") == "clicked") {
				if (!is_valid_ip($("#server_ip").val(),0)) {
					$("#server_ip_error").html("<br/>"+_lan_wlan_serverip_error);
					return false;
				}

				lan_value.lan_dhcp_relay_server = $("#server_ip").val();
			}	

			if($("div[name='dhcpradio']").eq(0).attr("class") == "clicked")
				lan_value.lan_dhcp_type = 0;
			else if($("div[name='dhcpradio']").eq(1).attr("class") == "clicked")
				lan_value.lan_dhcp_type = 1;
			else if($("div[name='dhcpradio']").eq(2).attr("class") == "clicked")
				lan_value.lan_dhcp_type = 2;
			else
				lan_value.lan_dhcp_type = 0;

			if(lan_value.lan_ip1 != $("#lan_ip_1").val()) {
				lan_ip_flag = true;
			}
		} else {
			if(lan_value.lan_ip1 != $("#lan_ip_1").val()) {
				lan_ip_flag = true;
				var lan_ip1_list = $("#lan_ip_1").val().split(".");
				lan_ip1_list[3] = parseInt(lan_ip1_list[3]) + 1;

				lan_value.lan_dhcp_start = lan_ip1_list.join(".");
				lan_value.lan_dhcp_count = 255-parseInt(lan_ip1_list[3]);
			}
		}

		lan_value.lan_ip1 = $("#lan_ip_1").val();
		lan_value.lan_netmask1 = $("#lan_mask_1").val();
		lan_value.lan2_active  = ($("#second_enable_ck").attr("checked")?"Yes":"No");
		if($("#second_enable_ck").attr("checked")) {
			lan_value.lan_ip2 = $("#lan_ip_2").val();
			lan_value.lan_netmask2 = $("#lan_mask_2").val();
		}		

		lan_value.upnp_active  = ($("#upnp_status_ck").attr("checked")?"Yes":"No");

		document.getElementById("CreatePopAlertMessage").style.display = "inline";
		document.getElementById("waitSettingFinish").style.display = "inline";
		Start_reciprocal_Number_RestoreConfiguration();

		$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey){
			lan_value.sessionKey = sessionKey;
			setTimeout('$.post("/cgi-bin/New_GUI/Set/Network.asp", lan_value, function(){save_flag = true;});', 300);
		});
	}

	var save_flag = false;
	var _ReciprocalNumber = 10;
	function Start_reciprocal_Number_RestoreConfiguration() {
		if (_ReciprocalNumber >= 0) {
			document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", m_comm_Sec);
			_ReciprocalNumber --;
			setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
		} else {
			if(lan_ip_flag) {
				top.location.href = "http://"+lan_value.lan_ip1;
			} else {
				if(save_flag) {
					document.getElementById("waitSettingFinish").style.display = "none";
					document.getElementById("SuccessSettings").style.display = "inline";
				} else {
					setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
				}
			}
		}
	}

	function checkDhcp(ip) {
		var checkresult = true;
		var lanip;

		lanip = $("#lan_ip_1").val().split(".");
		var dhcpip = MathandAbs(ip).split(".");

		if((lanip[0] != dhcpip[0])||(lanip[1] != dhcpip[1])||(lanip[2] != dhcpip[2])) {
			checkresult = false;
			return checkresult;
		} else {
	        return checkresult;
	    }
	}

	function showAdv() {
		$(".advancedBlock").toggle();
	}

	function clearCreateRulePOP() {
		$("#createPop").hide();
		document.getElementById("createButton").disabled = false;
	}

	function initPopDCHPRule(ip_addr) {
		$("label[class='error']").html("");
		$("#dhcp_mac_addr").val("");
		$("#dhcp_mac_addr_label").html("");
		
		$("#pop_dhcp_ip_addr").html("<select style='width: 150px' name='dhcp_ip_addr' id='dhcp_ip_addr'></select>");

		var ip_addr_s = lan_value.lan_dhcp_start.split(".");
		for(var i=parseInt(ip_addr_s[3]);i<=(parseInt(ip_addr_s[3])+parseInt(lan_value.lan_dhcp_count)-1);i++) {
			var ipadd=parseInt(ip_addr_s[0])+"."+parseInt(ip_addr_s[1])+"."+parseInt(ip_addr_s[2])+"."+parseInt(i);
			if(ipadd == ip_addr) {
				$("#dhcp_ip_addr").append("<option value='"+ipadd+"' selected>"+ipadd+"</option>");
			} else {
				var z=0;
				for (var j=0; j<staticLists.length; j++) {
					if(staticLists[j][0] == ipadd)
						z ++;
				}
				if(z == 0) {
					for (var j=0; j<clientLists.length; j++) {			
						if(clientLists[j][0] == ipadd)
							z ++;
					}
				}

				if((z == 0) && (ipadd != "") && (ipadd != null) && (ipadd != "undefined") && (ipadd != undefined)) {
					$("#dhcp_ip_addr").append("<option value='"+ipadd+"'>"+ipadd+"</option>");
				}
			}			
		}

		$("#dhcp_ip_addr").selectbox();
	}

	function createDCHPRule() {
		initPopDCHPRule();
		$("#dhcp_table_mac_label").hide();
		$("#dhcp_table_mac_text").show();
		$("#popTitle").html(m_comm_createnew);
		$("#createPop").show();
		document.getElementById("createButton").disabled = true;
	}

	function EditRow_Auto(mac_addr) {
		var auto_ip = "";
		if(clientLists.length > 0) {
			for( var i = 0; i < clientLists.length; i++ ) {
				if(clientLists[i][1].toUpperCase() == mac_addr.toUpperCase()) {
					auto_ip = clientLists[i][0];
					break;
				}
			}
		} 

		initPopDCHPRule(auto_ip);
		$("#dhcp_table_mac_label").show();
		$("#dhcp_table_mac_text").hide();
		$("#dhcp_mac_addr_label").html(encodeSpecialChr(mac_addr));
		$("#popTitle").html("Edit Rule");
		$("#createPop").show();
		document.getElementById("createButton").disabled = true;
	}

	function EditRow_Static(mac_addr) {
		static_modify = -1;
		var auto_flag = false;
		var static_ip = "";
		if(clientLists.length > 0) {
			for( var i = 0; i < clientLists.length; i++ ) {
				if(clientLists[i][1].toUpperCase() == mac_addr.toUpperCase()) {
					auto_flag = true;
					break;
				}
			}
		}

		if(staticLists.length > 0) {
			for( var i = 0; i < staticLists.length; i++ ) {
				if(staticLists[i][1].toUpperCase() == mac_addr.toUpperCase()) {
					static_ip = staticLists[i][5];
					static_modify = i;
					break;
				}
			}
		}

		initPopDCHPRule(static_ip);
		if(auto_flag) {
			$("#dhcp_table_mac_label").show();
			$("#dhcp_table_mac_text").hide();
			$("#dhcp_mac_addr_label").html(encodeSpecialChr(mac_addr));
		} else {
			$("#dhcp_table_mac_label").hide();
			$("#dhcp_table_mac_text").show();
			$("#dhcp_mac_addr").val(mac_addr);
		}
		

		$("#popTitle").html("Edit Rule");
		$("#createPop").show();
		document.getElementById("createButton").disabled = true;
	}

	function deleteDate_Static(mac_addr) {
		var deleteId = -1;
		if(confirm(m_comm_deldesc)) {
			for(var i = 0; i < staticLists.length; i++) {
				if(staticLists[i][1].toLowerCase() == mac_addr.toLowerCase()) {
					deleteId = i;
					break;
				}
			}
		}

		if(deleteId != -1) {
			$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey){
				document.getElementById("CreatePopAlertMessage").style.display = "inline";
				document.getElementById("waitSettingFinish").style.display = "inline";
				Start_reciprocal_Number_RestoreConfiguration();

				setTimeout('$.post("/cgi-bin/New_GUI/Set/Network_DHCPTable_Delete.asp", { sessionKey: "'+sessionKey+'", deleteId: "'+deleteId+'" }, function(){save_flag = true;});', 300);
			});
		}		
	}

	function uiDoSave() {
		$("label[class='error']").html("");

		var dhcpRule_id = 0;
		var ip_addr = $("#dhcp_ip_addr").val();
		var mac_addr = "";
		
		if($("#dhcp_table_mac_text").is(":visible") ) {				// Add/Modify static
			mac_addr = $("#dhcp_mac_addr").val();
			if( mac_addr != "") {
				if (mac_addr.search(":") != -1)    
					var tmp=mac_addr.split(":");
				else            
					var tmp=[6];

				if(tmp[0].toString() == "01") {
					$("#dhcp_mac_addr_error").html("<br/>"+m_network_error_10);
					return;
				}

				if (!(checkMAC(tmp[0])&&checkMAC(tmp[1])&&checkMAC(tmp[2])&&checkMAC(tmp[3])&&checkMAC(tmp[4])&&checkMAC(tmp[5]))) {
					$("#dhcp_mac_addr_error").html("<br/>"+m_network_error_10);
					return;
			    	}
			    	
			    	var tmp_mac_addr = mac_addr.toLocaleLowerCase();
				if(mac_addr=="00:00:00:00:00:00"||tmp_mac_addr=="ff:ff:ff:ff:ff:ff") {
					$("#dhcp_mac_addr_error").html("<br/>"+m_network_error_10);
					return;
				}				

				if(mac_addr.indexOf("33:33") == 0) {
					$("#dhcp_mac_addr_error").html("<br/>"+m_network_error_10);
					return;
				}

				for( var i = 0; i < staticLists.length; i++ ) {
					if(static_modify == i)
						continue;
						
					if( staticLists[i][1] == mac_addr) {
						$("#dhcp_mac_addr_error").html("<br/>"+m_network_error_11);
						return;
					}
				}
			} else {
				$("#dhcp_mac_addr_error").html("<br/>"+m_network_error_10);
				return;
			}

			if(static_modify != -1) {							// modify static
				dhcpRule_id = static_modify;
			} else {											// add static
				if(staticLists.length > 0) {
					for( var i = 0; i < staticLists.length; i++ ) {
						if(staticLists[i][1] == "") {
							dhcpRule_id = i;
							break;
						}
					}
				} 
			}
		} else {													// Modify Auto 
			mac_addr = $("#dhcp_mac_addr_label").html();
			if(static_modify != -1) {
				dhcpRule_id = static_modify;
			} else {
				if(staticLists.length > 0) {
					for( var i = 0; i < staticLists.length; i++ ) {
						if(staticLists[i][1] == "") {
							dhcpRule_id = i;
							break;
						}
					}
				} 
			}			
		}

		$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey){
			document.getElementById("CreatePopAlertMessage").style.display = "inline";
			document.getElementById("waitSettingFinish").style.display = "inline";
			Start_reciprocal_Number_RestoreConfiguration();

			setTimeout('$.post("/cgi-bin/New_GUI/Set/Network_DHCPTable_AddEdit.asp", { sessionKey: "'+sessionKey+'", dhcpRule_id: "'+dhcpRule_id+'", ip_addr: "'+ip_addr+'", mac_addr: "'+mac_addr+'" }, function(){save_flag = true;});', 300);
		});
	}

	function checkMAC(m) {
		var allowChar="01234567890ABCEDF";
		if(m==null)
			return false;

		if(m.length!=2)
			return false;
			
		m=m.toUpperCase();
		
		for (var i=0; i < m.length; i++) {
			if (allowChar.indexOf(m.charAt(i)) == -1) return false;
		}
		
		if (m.length==0) return false;
		return true;
	}

	function getDhcpTable(){		
		$.get("/cgi-bin/get/New_GUI/Network_DHCPTable.cgi", function(){
			var flagforlanhost =-1;
			staticLists.length = 0;
			clientLists.length = 0;
			for(var j = 0; j< StaticRules; j++) {
				var static_ip = eval("dhcpStatic"+j+"_ip");
				var static_mac = eval("dhcpStatic"+j+"_mac");
				var static_active = eval("dhcpStatic"+j+"_active");
				var staticflag =0;
				
				for(var i = 0; i < ClientRules; i++) {
					var all_mac = eval("dhcpClient"+i+"_mac");
					var all_hostname = eval("dhcpClient"+i+"_hostname");
					var all_ip = eval("dhcpClient"+i+"_ip");
					var all_active = eval("dhcpClient"+i+"_active");
					var all_hostname = eval("dhcpClient"+i+"_hostname");
					var all_type = eval("dhcpClient"+i+"_type");
					var all_types = eval("dhcpClient"+i+"_types");
					if(all_types == "N/A")
						all_types = "";

				    if(static_mac!="N/A") {
						if(static_mac.toUpperCase()==all_mac.toUpperCase()) {
							if(all_ip != "N/A") {
								if(all_type == "802.11n")
									staticLists.push([all_ip,all_mac,all_active,"Wireless 802.11n",all_hostname,static_ip]);
								else if(all_type == "802.11ac")
									staticLists.push([all_ip,all_mac,all_active,"Wireless 802.11ac",all_hostname,static_ip]);
								else if(all_type == "Ethernet")
									staticLists.push([all_ip,all_mac,all_active,"Ethernet",all_hostname,static_ip]);
								else if(all_type.search("Ethernet") != "-1")
									staticLists.push([all_ip,all_mac,all_active,"Ethernet",all_hostname,static_ip]);
								else
									staticLists.push([all_ip,all_mac,all_active,"-",all_hostname,static_ip]);
								staticflag=1;
								flagforlanhost=i;
								break;
							}

						}
				    }
				}
				
				if(staticflag==0) {
					if(static_ip != "N/A")
						staticLists.push([static_ip,static_mac,static_active,"-","",static_ip]);
					else
						staticLists.push(["","","","-","",""]);
				}
			}

			for(var i = 0; i < ClientRules; i++) {
				var alladd =  eval("dhcpClient"+i+"_add");
				if(alladd =="DHCP") {
					var client_ip = eval("dhcpClient"+i+"_ip");
					var client_mac = eval("dhcpClient"+i+"_mac");
					var client_hostname = eval("dhcpClient"+i+"_hostname");
					var client_type = eval("dhcpClient"+i+"_type");
					var client_types = eval("dhcpClient"+i+"_types");
					if(client_types == "N/A")
						client_types = "";
					var client_active = eval("dhcpClient"+i+"_active");
					if(client_ip != "N/A") {
						if(client_type == "802.11n")
							clientLists.push([client_ip,client_mac,client_hostname,"Wireless 802.11n",client_active]);
						else if(client_type == "802.11ac")
							clientLists.push([client_ip,client_mac,client_hostname,"Wireless 802.11ac",client_active]);
						else if(client_type == "Ethernet")
							clientLists.push([client_ip,client_mac,client_hostname,"Ethernet",client_active]);
						else if(client_type.search("Ethernet") != "-1")
							clientLists.push([client_ip,client_mac,client_hostname,"Ethernet",client_active]);
						else
							clientLists.push([client_ip,client_mac,client_hostname,"-",client_active]);
					} else
						clientLists.push(["","","","",""]);
				}
			}

			var str_html = new String();
			str_html += "<table class='mainTable' border='0' cellspacing='0'>";
			str_html += "	<tbody>";
			str_html += "		<tr>";
			str_html += "			<th style='text-align: center;'>"+m_comm_Active+"</th>";
			str_html += "			<th style='text-align: center;'>"+m_comm_hostname+"</th>";
			str_html += "			<th style='text-align: center;'>"+m_comm_ip+"</th>";
			str_html += "			<th style='text-align: center;'>"+m_comm_mac+"</th>";
			str_html += "			<th style='text-align: center;'>"+m_comm_status+"</th>";
			str_html += "			<th style='text-align: center;'>"+m_comm_interface+"</th>";
			str_html += "			<th style='text-align: center;'>"+m_comm_Edit+"</th>";
			str_html += "			<th style='text-align: center;'>"+m_comm_Delete+"</th>";
			str_html += "		</tr>";

			for(var i = 0; i < staticLists.length; i++) {
				if(staticLists[i][0] != "") {
					str_html += "<tr>";
					if(parseInt(staticLists[i][2]) == 1)
						str_html += "<td align=center style='color: blue;'>Active</td>";
					else
						str_html += "<td align=center style='color: red;'>Deactive</td>";
					if(staticLists[i][4] != "")
						str_html += "<td align=center>"+staticLists[i][4]+"</td>";
					else
						str_html += "<td align=center>&nbsp;-&nbsp;</td>";

					str_html += "	<td align=center>"+staticLists[i][0]+"</td>";
					str_html += "	<td align=center>"+encodeSpecialChr(staticLists[i][1])+"</td>";
					str_html += "	<td align=center>Static</td>";
					str_html += "	<td align=center>"+staticLists[i][3]+"</td>";
					var strCode = encodeSpecialChr(staticLists[i][1]);
					str_html += "	<td><img src='/graphic/New_GUI/edit_btn.gif' width=28 height=28 style='cursor:pointer' onclick=\"EditRow_Static('"+strCode+"')\"/></td>";
					str_html += "	<td><img src='/graphic/New_GUI/trash.gif' width=41 height=41 style='cursor:pointer' onclick=\"deleteDate_Static('"+strCode+"')\"/></td>";
					str_html += "</tr>";
				}
			}

			for( var i = 0; i < clientLists.length; i++) {
				if(clientLists[i][0] != "") {
					var z = 0;
					for( var j = 0; j < staticLists.length; j++) {
						if(clientLists[i][0] == staticLists[j][0])
							z++;
					}

					if(z == 0) {
						str_html += "<tr>";
					
						if(parseInt(clientLists[i][4]) == 1)
							str_html += "<td align=center style='color: blue;'>"+m_comm_Active+"</td>";
						else
							str_html += "<td align=center style='color: red;'>"+m_comm_Deactive+"</td>";
						if(clientLists[i][2] != "")
							str_html += "<td align=center>"+clientLists[i][2]+"</td>";
						else
							str_html += "<td align=center>&nbsp;-&nbsp;</td>";
						str_html += "	<td align=center>"+clientLists[i][0]+"</td>";
						str_html += "	<td align=center>"+encodeSpecialChr(clientLists[i][1])+"</td>";
						str_html += "	<td align=center>Auto</td>";
						if(parseInt(clientLists[i][4]) == 1)
							str_html += "	<td align=center>"+clientLists[i][3]+"</td>";
						else
							str_html += "	<td align=center>&nbsp;-&nbsp;</td>";
						var strCode = encodeSpecialChr(clientLists[i][1]);
						str_html += "	<td><img src='/graphic/New_GUI/edit_btn.gif' width=28 height=28 style='cursor:pointer' onclick=\"EditRow_Auto('"+strCode+"')\"/></td>";
						str_html += "	<td>&nbsp;</td>";
						str_html += "</tr>";
					}
				}
			}
		
			str_html += "	</tbody>";
			str_html += "</table>";


			$("#dhcp_table").html(str_html);
		}, 'script');
	}
</script>
<script language="JavaScript">
	$(function() {
		$("button, div[name='dhcpradio']").click(function () { save_button_changed(); });
		$("input, textarea, select").change(function () { save_button_changed(); });
		$("input, textarea").keypress(function () { save_button_changed(); });

		$(".checkbox_on, .checkbox_off").click(function() {	SetCheckBoxEnable($(this).attr("id"));	});

		$("input[type='text']").each(function() {	$(this).parent().append("<label id='"+$(this).attr("id")+"_error' name='"+$(this).attr("id")+"_error' class='error'></label>");	});

		$("div[name='dhcpradio']").each(function(){
			$(this).click(function() {
				var a = $(this);
				$("div[name='dhcpradio']").each(function(){
					var tbody_id = $(this).attr('rel');
					if(tbody_id != "") {
						if($("tbody[id='"+tbody_id+"']").is(":visible") && (tbody_id != a.attr('rel')))
							$("tbody[id='"+tbody_id+"']").hide();
					}
				});
				
				$("div[name='dhcpradio']").attr('class', 'unclick');
				$(this).attr('class', 'clicked');
				$("tbody[id='"+$(this).attr('rel')+"']").show();
			});
		});

		$("#second_enable").click(function(){
			if($("#second_enable_ck").attr("checked")) {
				$("#lan_ip_2").removeProp("disabled");
				$("#lan_mask_2").removeProp("disabled");
			} else {
				$("#lan_ip_2").prop("disabled", true);
				$("#lan_mask_2").prop("disabled", true);
			}
		});

		var selectWidth = new Object;
		selectWidth.width = 234;
		
		$("select").selectbox(selectWidth);

		/*getDhcpTable();

		setInterval("getDhcpTable()", 20000);*/
	});
</script>
<style>
.block th {
    font-weight: normal;
    text-align: right;
    width: 240px;
}
</style>
</head>

<body>
	<form method="POST" action="">
		<input type="hidden" name="sessionKey" id="sessionKey">
		<input type="hidden" name="pool_count" id="pool_count">
		<input type="hidden" name="dhcpradioVal" id="dhcpradioVal">
		<div id="wrapper">
			<!-------------------- Logo ------------------------->
			<div id="header"></div>
			<!-------------------- Menu ------------------------->
			<div id="menu"></div>
			<!-------------------- Content ---------------------->
			<div id="content">
				<!-------------------- info ------------------------->
				<div id="info">
					<div id="FunctionName"><script>I18N("h", m_comm_Network);</script></div>
					<div id="wallimage"><img src="/graphic/New_GUI/page_network2.png" alt="" width="195" height="119"/></div>
					<div id="directions">
						<!-- <script>I18N("h", "Use this section to configure the network settings for your device. You can enter a name for your device in the management link field, and use the link to access web UI  in a web browser. Recommend to change the management link if there are more than one D-Link devices within the network.");</script> -->
						<!--<script>I18N("h", "Use this section to configure the local network settings of your router. The IP Address that is configured here is the IP Address that you use to access the Web-based management interface. If you change the IP Address here, you may need to adjust your PC's network settings to access the network again.");</script> -->
						<script>prints(m_network_desc1);</script><br/>
						 <script>prints(m_network_desc2);</script><br/>
						 <script>prints(m_network_desc3);</script><br/>
					</div>
				</div>
				<!-------------------- funcBar ---------------------->
				<div id="funcBar">
					<div id="pagePath">&nbsp;<script>I18N("h", m_comm_settings);</script> >> <script>I18N("h", m_comm_Network);</script></div>
					<ul id="rightFunc">
						<li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click()" style="cursor:pointer; display:none"><script>I18N("h", m_comm_Save);</script></div></li>
						<li style="display:block"><div id="Save_Disable_btn"><script>I18N("h", m_comm_Save);</script></div></li>
						<input id="sumbit_CheckData" class="submit" type="button" value="Submit" style="display:none" onClick="doSave();"/>
					</ul>
				</div>
	     	<!-------------------- main ---------------------->
	     	<div id="main" style="display:none">
				<!-------------------- LAN Router Settings ---------------------->
				<div>
					<table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;">
						<tbody>
							<tr>
								<td><div class ="title"><script>prints(m_network_routersetting);</script></div></td>
								<td></td>
							</tr>

							<tr>
								<th><script>I18N("h", m_network_routerip);</script>:</th>
								<td><input class="styled-text" type="text" name="lan_ip_1" maxlength="32" size="30" id="lan_ip_1"></td>
							</tr>

							<tr>
								<th><script>I18N("h", m_comm_submask);</script>:</th>
								<td><input class="styled-text" type="text" name="lan_mask_1" maxlength="32" size="30" id="lan_mask_1"></td>
							</tr>

							<tr>
								<th><script>prints(m_network_second_enable);</script> :</th>
								<td>
									<div id="second_enable" class="checkbox_on">
										<input type="checkbox" id="second_enable_ck" name="second_enable_ck">
									</div>
								</td>
							</tr>

							<tr>
								<th><script>prints(m_network_routerip_2);</script>:</th>
								<td><input class="styled-text" type="text" name="lan_ip_2" maxlength="32" size="30" id="lan_ip_2"></td>
							</tr>

							<tr>
								<th><script>prints(m_network_subnet_2);</script>:</th>
								<td><input class="styled-text" type="text" name="lan_mask_2" maxlength="32" size="30" id="lan_mask_2"></td>
							</tr>
						</tbody>
					</table>						
				</div>
				<div class="advButton" onclick="showAdv();"><script>I18N("h", m_comm_advancedsetting);</script>...</div>
				<hr />

				<!-------------------- DHCP Settings  ---------------------->
				<div class="advancedBlock" style="display: none;">
					<table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;">
						<tr>
							<td style="width: 205px;">&nbsp;</td>
							<td style="width: 26px;"><div name="dhcpradio" class='unclick'></div></td>
							<td style='width: 150px;'><script>prints(m_network_disabledhcp);</script></td>
							<td><script>prints(m_network_disabledesc1);</script></td>
						</tr>

						<tr>
							<td style="width: 205px;">&nbsp;</td>
							<td style="width: 26px;"><div rel="dhcp_enable" name="dhcpradio" class='unclick'></div></td>
							<td style='width: 150px;'><script>prints(m_network_enabledhcp);</script></td>
							<td><script>prints(m_network_enabledesc);</script></td>
						</tr>

						<tbody id="dhcp_enable">
							<tr>
								<td style="width: 205px;">&nbsp;</td>
								<td style="width: 26px;">&nbsp;</td>
								<td style='width: 150px;'><script>prints(m_network_dhcpiprange);</script> :</td>
								<td>
									<input class="styled-text" type="text" name="uiViewStartIP" maxlength="32" size="30" id="uiViewStartIP">
									&nbsp;to&nbsp;
									<input class="styled-text" type="text" name="uiViewEndIP" maxlength="32" size="30" id="uiViewEndIP">
								</td>
							</tr>

							<tr>
								<td style="width: 205px;">&nbsp;</td>
								<td style="width: 26px;">&nbsp;</td>
								<td style='width: 150px;'><script>prints(m_network_dhcpleasetime);</script> :</td>
								<td>
									<div class="styled-select" >
										<select name="uiViewLease" id="uiViewLease">
										<script>
											prints("<option value=\"3600\">1 " + m_comm_Hour);
											prints("<option value=\"7200\">2 " + m_comm_Hours);
											prints("<option value=\"10800\">3 " + m_comm_Hours);
											prints("<option value=\"86400\">1 " + m_comm_day);
											prints("<option value=\"172800\">2 " + m_comm_days);
											prints("<option value=\"259200\">3 " + m_comm_days);
											prints("<option value=\"604800\">1 " + m_comm_Week);
										</script>
										</select>
									</div>
								</td>
							</tr>

							<tr>
								<td style="width: 205px;">&nbsp;</td>
								<td style="width: 26px;">&nbsp;</td>
								<td style='width: 150px;'><script>prints(m_network_option60);</script> :</td>
								<td>
									<input class="styled-text" type="text" name="option60_venderid" maxlength="32" size="30" id="option60_venderid">
								</td>
							</tr>

							<tr>
								<td style="width: 205px;">&nbsp;</td>
								<td style="width: 26px;">&nbsp;</td>
								<td style='width: 150px;'><script>prints(m_comm_pridns);</script> :</td>
								<td>
									<input class="styled-text" type="text" name="pridns" maxlength="32" size="30" id="pridns">
								</td>
							</tr>

							<tr>
								<td style="width: 205px;">&nbsp;</td>
								<td style="width: 26px;">&nbsp;</td>
								<td style='width: 150px;'><script>prints(m_comm_sec_dns);</script> :</td>
								<td>
									<input class="styled-text" type="text" name="secdns" maxlength="32" size="30" id="secdns">
								</td>
							</tr>
						</tbody>

						<tr>
							<td style="width: 205px;">&nbsp;</td>
							<td style="width: 26px;"><div rel="dhcp_relay" name="dhcpradio" class='unclick'></div></td>
							<td style='width: 150px;'><script>prints(m_network_dhcprelay);</script></td>
							<td>&nbsp;</td>
						</tr>

						<tbody id="dhcp_relay">
							<tr>
								<td style="width: 205px;">&nbsp;</td>
								<td style="width: 26px;">&nbsp;</td>
								<td style='width: 150px;'><script>prints(m_network_serverip);</script> :</td>
								<td><input class="styled-text" type="text" name="server_ip" maxlength="32" size="30" id="server_ip"></td>
							</tr>
						</tbody>
					</table>					
     			</div>     			
     			<!-- <hr class="advancedBlock" style="display: none;"/> -->

     			<!-- <div class="advancedBlock" style="display: none;"> -->
     			<div style="display: none;">
     				<table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;">
							<tr>
								<td><div class ="title"><script>prints(m_network_dhcptable);</script></div></td>
								<td></td>
							</tr>
						<tr>
							<td colspan="2" id="dhcp_table"></td>
						</tr>
					</table>
					<br />
					&nbsp;<button type="button" id="createButton" name="createButton" class="styled_button_s"  onclick="createDCHPRule()"><script>prints(m_network_addrule);</script></button>
     			</div>
				<br />
     			<hr class="advancedBlock" style="display: none;"/>
     			

     			<div>
					<table class="block" border="0" cellspacing="0" style="margin: 10px 0 0 0;">
						<tr>
							<td><div class ="title"><script>prints(m_network_upnpsettings);</script></div></td>
							<td></td>
						</tr>

						<tr>
							<th><script>I18N("h", m_network_UPnP);</script>:</th>
							<td>
								<div id="upnp_status" class="checkbox_on">
									<input type="checkbox" id="upnp_status_ck" name="upnp_status_ck">
								</div>
							</td>
						</tr>
					</table>						
				</div>

				<!-- --------------------PopUp--------------------- -->			
				<div id="createPop" style="display:none;overflow:scroll">
					<div class="dialogBox"  style="width:616px">
					<div id="closeCreatePopBtn" onclick="clearCreateRulePOP()" style="cursor:pointer"></div>
						<table class="myCreatePop_table" border="0" cellspacing="0" id="tblVirtualServer">
							<tbody>
								<tr>
								 	<td colspan="4"><div class="popTitle" id="popTitle"></div></td>
								</tr>

								<tr>
							     	<th><script>prints(m_comm_ip);</script>:</th>
									<td valign="top" colspan="3">
										<div class="styled-select" id="pop_dhcp_ip_addr">
											
										</div>
									</td>
								</tr>
								<tr style="display: none" id="dhcp_table_mac_text">
							     	<th><script>prints(m_comm_mac);</script>:</th>							     		
									<td valign="top" colspan="3">
										<input class="styled-text" type="text" name="dhcp_mac_addr" maxlength="32" size="30" id="dhcp_mac_addr">
									</td>
								</tr>
								<tr style="display: none" id="dhcp_table_mac_label">
							     	<th><script>prints(m_comm_mac);</script>:</th>							     		
									<td valign="top" colspan="3">
										<label id="dhcp_mac_addr_label"></label>
									</td>
								</tr>
								<tr>
								<td id="save_td" colspan="3">
									<center><button type="button" class="styled_button_s" id="save_buttonFocus" onclick="uiDoSave();"><script>prints(m_comm_Apply);</script></button></center>	
								</td>
							</tr>
							</tbody>							
						</table>
					</div>
				</div>

     			<div id="CreatePopAlertMessage" style="display:none">
					<div id="AlertPopRect">
						<div id="AlertPopBody">
							<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none">
							   <tbody>
									 <tr>
									 	<td>
											<center><div id="Loading_pop_image2"></div></center>
										</td>
									 </tr>
									 <tr>
									 	<td><center><label id="reciprocal_Number">10</label></center></td>
									 </tr>
									 <tr>
									 	<td id="dialog_msg_black2"><script>I18N("h", m_comm_changesdesc);</script></td>
									 </tr>
							   </tbody>
							</table>
							<table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0"  style="display:none">
							   <tbody>
									 <tr>
									 	<td>
											<center><div id="Information_pop_image"></div></center>
										</td>
									 </tr>
									 <tr>
										 <td>
										 	<div id="dialog_msg_black"><script>I18N("h", m_comm_settingsave);</script></div>
										 </td>
									 </tr>
									 <tr>
										 <td>
										 	<center><div id="Confirm_btn" onclick="javascript: self.location.href = self.location.href;" style="cursor:pointer"><script>I18N("h", m_comm_ok);</script></div></center>
										 </td>
									 </tr>
							   </tbody>
							</table>
						</div>
					</div>
				</div>
				<div id="DetectRouterConnection" style="display:none"></div>
				<div id="footer" border="0">
					<div id="copyright"><script>prints(m_comm_copyright);</script></div>
					<div id="help">
						<a target="_blank" href="http://www.dlink.com/support" style="cursor:pointer;text-Decoration:underline">
							
								<script>prints(m_home_gethelp);</script>
							
						</a>
					</div>
				</div>
			</div>
		</div>
	</form>
</body>
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Settings");
	InitLAN();
</script>
</html>
