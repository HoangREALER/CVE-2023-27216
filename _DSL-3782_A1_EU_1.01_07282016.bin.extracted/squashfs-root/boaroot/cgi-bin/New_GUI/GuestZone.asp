<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns= "http://www.w3c.org/1999/xhtml">
<head>
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/css">
<link rel=stylesheet type="text/css" href="/layout/New_GUI/jquery.selectbox.css?v=20140910163551" />
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJQ.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>

<script>
	function decodeSpecialChr(str) {
		str = str.replace(/&amp;/g, "&");
		str = str.replace(/&lt;/g, "<");
		str = str.replace(/&gt;/g, ">");
		str = str.replace(/&quot;/g, "\"");
		str = str.replace(/&#39;/g, "'");
		str = str.replace(/&#59;/g, ";");
		str = str.replace(/&#61;/g, "=");
		str = str.replace(/&#43;/g, "+");
		str = str.replace(/&#45;/g, "-");
		return str;
	}

	function isSSIDInvalid(source) {
		var sourcestr = new String(source);
		var tempstr;
		for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
			tempstr = sourcestr.substr(strposition, 1);
			if (tempstr.charCodeAt(0) == 45 || tempstr.charCodeAt(0) == 95 || tempstr.charCodeAt(0) == 46 || tempstr.charCodeAt(0) == 64 ||(tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
				continue;
			else
				return true;
		}
		return false;
	}

	function strchk_unicode(str) {
		var strlen = str.length;
		if (strlen > 0) {
			var c = '';
			for (var i = 0; i < strlen; i++) {
				c = escape(str.charAt(i));
				if (c.charAt(0) == '%' && c.charAt(1) == 'u')
					return true;
			}
		}
		return false;
	}

	function Prefixes_Rule_WEP_KEY(TelNum) {
		for (var i = 0; i < TelNum.length; i++) {
			if (TelNum.charAt(i) == '\"') return false;
			if (TelNum.charAt(i) == ' ') return false;
			if (TelNum.charAt(i) == '\\') return false;
			if (TelNum.charAt(i) == '%') return false;
			if (TelNum.charAt(i) == '#') return false;
		}
		return true;
	}

	function isHex(cmpStr) {
		var regStr = /[a-fA-F0-9]/;
		for (i = 0; i < cmpStr.length; i++) {
			if (cmpStr.charAt(i).search(regStr) == -1)
				return false;
		}
		return true;
	}

	var msg_length = 0;

	function check_key(keyvalue, lan_wlan_cipher, lan_wlan_type) {
		var keylength = parseInt(lan_wlan_cipher);
		var keytype = parseInt(lan_wlan_type);
		var ascii_length = (keylength / 8) - 3;
		var hex_length = ascii_length * 2;

		if (keytype == 1)
			my_length = ascii_length;
		else
			my_length = hex_length;

		msg_length = my_length;

		if (keytype == 1) {
			if (!Prefixes_Rule_WEP_KEY(keyvalue))
				return false;
		}

		if (keytype != 1) {
			if (!isHex(keyvalue))
				return false;
		}

		if ((keytype == 1) && (keyvalue == 0))
			return false;

		if ((keyvalue.length != my_length && keyvalue != ""))
			return false;

		return true;
	}

	function isWPAKeyInvalid(source) {
		var sourcestr = new String(source);
		var tempstr;
		if (sourcestr == "")
			return false;

		for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
			tempstr = sourcestr.substr(strposition, 1);
			if ((tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
				continue;
			else
				return true;
		}
		return false;
	}

	var guest_val = {
		"guest24_status": '<%tcWebApi_get("WLan_Common","SSIDseperation","s")%>',
		"guest24_ssid": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","SSID","s")%>'),

		"guest24_authmode": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","AuthMode","s")%>'),
		"guest24_defKeyID": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","DefaultKeyID","s")%>'),
		"guest24_key1": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","Key1Str","s")%>'),
		"guest24_key2": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","Key2Str","s")%>'),
		"guest24_key3": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","Key3Str","s")%>'),
		"guest24_key4": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","Key4Str","s")%>'),
		"guest24_wpapsk": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WPAPSK","s")%>'),
		"WEPAuthType": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WEPAuthType","s")%>'),
		"EncrypType": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","EncrypType","s")%>'),
		"RekeyInterval": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","RekeyInterval","s")%>'),

		"WPSConfMode": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WPSConfMode","s")%>'),
		"WPSConfStatus": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WPSConfStatus","s")%>'),
		"HideSSID": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","HideSSID","s")%>'),
		"WMM": decodeSpecialChr('<%tcWebApi_get("WLan_Entry1","WMM","s")%>'),
		// ////////////////////////////////////////

		"guest5_status": '<%tcWebApi_get("WLan11ac_Common","SSIDseperation","s")%>',
		"guest5_ssid": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","SSID","s")%>'),

		"guest5_authmode": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","AuthMode","s")%>'),
		"guest5_defKeyID": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","DefaultKeyID","s")%>'),
		"guest5_key1": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","Key1Str","s")%>'),
		"guest5_key2": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","Key2Str","s")%>'),
		"guest5_key3": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","Key3Str","s")%>'),
		"guest5_key4": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","Key4Str","s")%>'),
		"guest5_wpapsk": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WPAPSK","s")%>'),
		"WEPAuthType_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WEPAuthType","s")%>'),
		"EncrypType_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","EncrypType","s")%>'),
		"RekeyInterval_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","RekeyInterval","s")%>'),

		"WPSConfMode_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WPSConfMode","s")%>'),
		"WPSConfStatus_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WPSConfStatus","s")%>'),
		"HideSSID_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","HideSSID","s")%>'),
		"WMM_ac": decodeSpecialChr('<%tcWebApi_get("WLan11ac_Entry1","WMM","s")%>'),
	};

	function checkSSID(name, id) {
		var en_ssid_index_0 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","SSIDON","s")%>');
		var en_ssid_index_1 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry1","SSIDON","s")%>');
		var en_ssid_index_2 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry2","SSIDON","s")%>');
		var en_ssid_index_3 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry3","SSIDON","s")%>');
		var conn_ssid_0 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry0","SSID","s")%>');
		var conn_ssid_1 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry1","SSID","s")%>');
		var conn_ssid_2 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry2","SSID","s")%>');
		var conn_ssid_3 = decodeSpecialChr('<%TCWebApi_get("WLan_Entry3","SSID","s")%>');
		var dataLists = [
			[en_ssid_index_0, conn_ssid_0],
			[en_ssid_index_1, conn_ssid_1],
			[en_ssid_index_2, conn_ssid_2],
			[en_ssid_index_3, conn_ssid_3]
		];
		for (var i = 0; i < dataLists.length; i++) {
			if (dataLists[i][0] == 1) {
				if (id != i) {
					if (name == dataLists[i][1])
						return false;
				}
			}
		}
		return true;
	}

	function checkSSID_ac(name, id) {
		var en_ssid_index_0_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","SSIDON","s")%>');
		var en_ssid_index_1_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry1","SSIDON","s")%>');
		var en_ssid_index_2_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry2","SSIDON","s")%>');
		var en_ssid_index_3_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry3","SSIDON","s")%>');
		var conn_ssid_0_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry0","SSID","s")%>');
		var conn_ssid_1_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry1","SSID","s")%>');
		var conn_ssid_2_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry2","SSID","s")%>');
		var conn_ssid_3_ac = decodeSpecialChr('<%TCWebApi_get("WLan11ac_Entry3","SSID","s")%>');
		var dataLists_ac = [
			[en_ssid_index_0_ac, conn_ssid_0_ac],
			[en_ssid_index_1_ac, conn_ssid_1_ac],
			[en_ssid_index_2_ac, conn_ssid_2_ac],
			[en_ssid_index_3_ac, conn_ssid_3_ac]
		];
		for (var i = 0; i < dataLists_ac.length; i++) {
			if (dataLists_ac[i][0] == 1) {
				if (id != i) {
					if (name == dataLists_ac[i][1])
						return false;
				}
			}
		}
		return true;
	}

	
	$(document).ready(function() {
		if (guest_val.guest24_status == "1") {
			SetCheckBoxEnable("status_gz_24", true, true);
		} else {
			SetCheckBoxEnable("status_gz_24", true, false);
		}		

		$("#wifiName_24g").val(guest_val.guest24_ssid);

		var wifi2_key;
		if (guest_val.guest24_authmode == "OPEN") {
			wifi2_key = "";
			$("#select_security_24g").val("0");
			$("#select_security_24g").selectbox('change', "0", $("#select_security_24g").find('option:selected').text());
		} else if (guest_val.guest24_authmode == "WEP-64Bits") {
			wifi2_key = eval("guest_val.guest24_key" + guest_val.guest24_defKeyID);
			$("#select_security_24g").val("1");
			$("#select_security_24g").selectbox('change', "1", $("#select_security_24g").find('option:selected').text());
		} else if (guest_val.guest24_authmode == "WEP-128Bits") {
			wifi2_key = eval("guest_val.guest24_key" + guest_val.guest24_defKeyID);
			$("#select_security_24g").val("2");
			$("#select_security_24g").selectbox('change', "2", $("#select_security_24g").find('option:selected').text());
		} else if (guest_val.guest24_authmode == "WPAPSK" || guest_val.guest24_authmode == "WPA") {
			wifi2_key = guest_val.guest24_wpapsk;
			$("#select_security_24g").val("3");
			$("#select_security_24g").selectbox('change', "3", $("#select_security_24g").find('option:selected').text());
		} else if (guest_val.guest24_authmode == "WPA2PSK" || guest_val.guest24_authmode == "WPA2") {
			wifi2_key = guest_val.guest24_wpapsk;
			$("#select_security_24g").val("4");
			$("#select_security_24g").selectbox('change', "4", $("#select_security_24g").find('option:selected').text());
		} else if (guest_val.guest24_authmode == "WPAPSKWPA2PSK" || guest_val.guest24_authmode == "WPA1WPA2") {
			wifi2_key = guest_val.guest24_wpapsk;
			$("#select_security_24g").val("5");
			$("#select_security_24g").selectbox('change', "5", $("#select_security_24g").find('option:selected').text());
		}
		if (wifi2_key == "" || wifi2_key == "N/A")
			wifi2_key = "";

		$("#wifikey_24g").val(wifi2_key);		
		// //////////////////////////////////////////////////////////

		if (guest_val.guest5_status == "1") {
			SetCheckBoxEnable("status_gz_5", true, true);
		} else {
			SetCheckBoxEnable("status_gz_5", true, false);
		}		

		$("#wifiName_5g").val(guest_val.guest5_ssid);		



		var wifi5_key;
		if (guest_val.guest5_authmode == "OPEN") {
			wifi5_key = "";
			$("#select_security_5g").val("0");
			$("#select_security_5g").selectbox('change', "0", $("#select_security_5g").find('option:selected').text());
		} else if (guest_val.guest5_authmode == "WEP-64Bits") {
			wifi5_key = eval("guest_val.guest5_key" + guest_val.guest5_defKeyID);
			$("#select_security_5g").val("1");
			$("#select_security_5g").selectbox('change', "1", $("#select_security_5g").find('option:selected').text());
		} else if (guest_val.guest5_authmode == "WEP-128Bits") {
			wifi5_key = eval("guest_val.guest5_key" + guest_val.guest5_defKeyID);
			$("#select_security_5g").val("2");
			$("#select_security_5g").selectbox('change', "2", $("#select_security_5g").find('option:selected').text());
		} else if (guest_val.guest5_authmode == "WPAPSK" || guest_val.guest5_authmode == "WPA") {
			wifi5_key = guest_val.guest5_wpapsk;
			$("#select_security_5g").val("3");
			$("#select_security_5g").selectbox('change', "3", $("#select_security_5g").find('option:selected').text());
		} else if (guest_val.guest5_authmode == "WPA2PSK" || guest_val.guest5_authmode == "WPA2") {
			wifi5_key = guest_val.guest5_wpapsk;
			$("#select_security_5g").val("4");
			$("#select_security_5g").selectbox('change', "4", $("#select_security_5g").find('option:selected').text());
		} else if (guest_val.guest5_authmode == "WPAPSKWPA2PSK" || guest_val.guest5_authmode == "WPA1WPA2") {
			wifi5_key = guest_val.guest5_wpapsk;
			$("#select_security_5g").val("5");
			$("#select_security_5g").selectbox('change', "5", $("#select_security_5g").find('option:selected').text());
		}
		if (wifi5_key == "" || wifi5_key == "N/A")
			wifi5_key = "";

		$("#wifikey_5g").val(wifi5_key);		


		$("select").selectbox();

		doClickStatus24();
		doClickStatus5();
	});

	var save_flag = false;
	var _ReciprocalNumber = 10;

	function Start_reciprocal_Number_RestoreConfiguration() {
		if (_ReciprocalNumber >= 0) {
			document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", m_comm_Sec);
			_ReciprocalNumber--;
			setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
		} else {
			if (save_flag) {
				document.getElementById("waitSettingFinish").style.display = "none";
				document.getElementById("SuccessSettings").style.display = "inline";
			} else {
				setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
			}
		}
	}

	function Prefixes_Rule_cgi_num(TelNum) {
		for (var i = 0; i < TelNum.length; i++) {
			if (TelNum.charCodeAt(i) < 48 || TelNum.charCodeAt(i) > 122)
				return false;
			else {
				if (TelNum.charCodeAt(i) > 57 && TelNum.charCodeAt(i) < 65)
					return false;
				if (TelNum.charCodeAt(i) > 90 && TelNum.charCodeAt(i) < 97)
					return false;
			}
		}
		return true;
	}
</script>

<script type="text/javascript">
	function Load_HTML()	{	$("#header").load("header.asp");	}
	function Initial() {
		initialMenu();
	}
	function GetXML()	{	document.getElementById("main").style.display = "inline";	}
</script>
<script language="JavaScript">
	$(function() {
		$("select").change(function() {
			save_button_changed();
		});
		$("input").keydown(function() {
			save_button_changed();
		});

		$(".checkbox_on, .checkbox_off").click(function() {
			save_button_changed();
		});

		$("input[type='text']").each(function() {
			$(this).parent().append("<label id='" + $(this).attr("id") + "_error' name='" + $(this).attr("id") + "_error' class='error'></label>");
		});

		$(".checkbox_on, .checkbox_off").click(function() {	SetCheckBoxEnable($(this).attr("id"));	});

		$("#Save_btn").click(function() {
			$("label[class='error']").html("");

			if($("#status_gz_24_ck").attr("checked")) {
				if ($("#wifiName_24g").val().length < 3 || $("#wifiName_24g").val().length > 32) {
					$("#wifiName_24g_error").html("<br/>"+m_wifi_waringssid);
					return;
				} else if (isSSIDInvalid($("#wifiName_24g").val())) {
					$("#wifiName_24g_error").html("<br/>"+m_wifi_waringssid);
					return;
				}

				if (checkSSID($("#wifiName_24g").val(), 1) == false) {
					$("#wifiName_24g_error").html("<br/>"+m_wifi_waringssid2);
					return;
				}

				switch ($("#select_security_24g").val()) {
					case "0":
						break;
					case "1":
						if ($("#wifikey_24g").val().length == 5) {
							if (!check_key($("#wifikey_24g").val(), 64, 1)) {
								$("#wifikey_24g_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_ASCII_error).show();
								return;
							}
						} else if ($("#wifikey_24g").val().length == 10) {
							if (!check_key($("#wifikey_24g").val(), 64, 2)) {
								$("#wifikey_24g_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_hex_error).show();
								return;
							}
						} else {
							$("#wifikey_24g_error").html(_wlan_conn_wizard_network_error).show();
							return;
						}
						break;
					case "2":
						if ($("#wifikey_24g").val().length == 13) {
							if (!check_key($("#wifikey_24g").val(), 128, 1)) {
								$("#wifikey_24g_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_ASCII_error).show();
								return;
							}
						} else if ($("#wifikey_24g").val().length == 26) {
							if (!check_key($("#wifikey_24g").val(), 128, 2)) {
								$("#wifikey_24g_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_hex_error).show();
								return;
							}
						} else {
							$("#wifikey_24g_error").html(_wlan_conn_wizard_network_error).show();
							return;
						}
						break;
					case "3":
					case "4":
					case "5":
						if (($("#wifikey_24g").val().length < 8) || ($("#wifikey_24g").val().length > 63) || (isWPAKeyInvalid($("#wifikey_24g").val()))) {
							if ($("#select_security_24g").val() == "3")
								$("#wifikey_24g_error").html(_lan_wlan_string_errorA + "WPA-PSK" + _lan_wlan_string_errorB).show();
							if ($("#select_security_24g").val() == "4")
								$("#wifikey_24g_error").html(_lan_wlan_string_errorA + "WPA2-PSK" + _lan_wlan_string_errorB).show();
							if ($("#select_security_24g").val() == "5")
								$("#wifikey_24g_error").html(_lan_wlan_string_errorA + "WPA/WPA2-PSK" + _lan_wlan_string_errorB).show();
							return;
						}

						if (strchk_unicode($("#wifikey_24g").val())) {
							$("#wifikey_24g_error").html(_lan_wlan_string_errorC).show();
							return;
						}
						break;
				}

			}

			// ////////////////////////////////////////////////////////

			if($("#status_gz_5_ck").attr("checked")) {
				if ($("#wifiName_5g").val().length < 3 || $("#wifiName_5g").val().length > 32) {
					$("#wifiName_5g_error").html("<br/>"+m_wifi_waringssid);
					return;
				} else if (isSSIDInvalid($("#wifiName_5g").val())) {
					$("#wifiName_5g_error").html("<br/>"+m_wifi_waringssid);
					return;
				}
				if (checkSSID_ac($("#wifiName_5g").val(), 1) == false) {
					$("#wifiName_5g_error").html("<br/>"+m_wifi_waringssid2);
					return;
				}

				switch ($("#select_security_5g").val()) {
					case "0":
						break;
					case "1":
						if ($("#wifikey_5g").val().length == 5) {
							if (!check_key($("#wifikey_5g").val(), 64, 1)) {
								$("#wifikey_5g_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_ASCII_error).show();
								return;
							}
						} else if ($("#wifikey_5g").val().length == 10) {
							if (!check_key($("#wifikey_5g").val(), 64, 2)) {
								$("#wifikey_5g_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_hex_error).show();
								return;
							}
						} else {
							$("#wifikey_5g_error").html(_wlan_conn_wizard_network_error).show();
							return;
						}
						break;
					case "2":
						if ($("#wifikey_5g").val().length == 13) {
							if (!check_key($("#wifikey_5g").val(), 128, 1)) {
								$("#wifikey_5g_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_ASCII_error).show();
								return;
							}
						} else if ($("#wifikey_5g").val().length == 26) {
							if (!check_key($("#wifikey_5g").val(), 128, 2)) {
								$("#wifikey_5g_error").html(_lan_wlan_encryption_A_1_error + msg_length + _lan_wlan_encryption_hex_error).show();
								return;
							}
						} else {
							$("#wifikey_5g_error").html(_wlan_conn_wizard_network_error).show();
							return;
						}
						break;
					case "3":
					case "4":
					case "5":
						if (($("#wifikey_5g").val().length < 8) || ($("#wifikey_5g").val().length > 63) || (isWPAKeyInvalid($("#wifikey_5g").val()))) {
							if ($("#select_security_5g").val() == "3")
								$("#wifikey_5g_error").html(_lan_wlan_string_errorA + "WPA-PSK" + _lan_wlan_string_errorB).show();
							if ($("#select_security_5g").val() == "4")
								$("#wifikey_5g_error").html(_lan_wlan_string_errorA + "WPA2-PSK" + _lan_wlan_string_errorB).show();
							if ($("#select_security_5g").val() == "5")
								$("#wifikey_5g_error").html(_lan_wlan_string_errorA + "WPA/WPA2-PSK" + _lan_wlan_string_errorB).show();
							return;
						}

						if (strchk_unicode($("#wifikey_5g").val())) {
							$("#wifikey_5g_error").html(_lan_wlan_string_errorC).show();
							return;
						}
						break;
				}
			}

			if($("#status_gz_24_ck").attr("checked")) {
				guest_val.guest24_status = 1;
				guest_val.guest24_ssid = $("#wifiName_24g").val();
				guest_val.guest24_security = $("#select_security_24g").val();
				guest_val.guest24_key = $("#wifikey_24g").val();
			} else {
				guest_val.guest24_status = 0;
			}

			if($("#status_gz_5_ck").attr("checked")) {
				guest_val.guest5_status = 1;
				guest_val.guest5_ssid = $("#wifiName_5g").val();
				guest_val.guest5_security = $("#select_security_5g").val();
				guest_val.guest5_key = $("#wifikey_5g").val();
			} else {
				guest_val.guest5_status = 0;
			}

			document.getElementById("CreatePopAlertMessage").style.display = "inline";
			document.getElementById("waitSettingFinish").style.display = "inline";
			Start_reciprocal_Number_RestoreConfiguration();

			$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey) {
				guest_val.sessionKey = sessionKey;
				guest_val.guest_zone = 1;
				setTimeout('$.post("/cgi-bin/New_GUI/Set/GuestZone.asp", guest_val, function(){save_flag = true;});', 300);
			});
		});

		$("#status_gz_24").click(function(){
			doClickStatus24();
		});

		$("#status_gz_5").click(function(){
			doClickStatus5();
		});

		$("#select_security_24g").change(function(event) {
			if($("#select_security_24g").val() == "0")
				$("#wifikey_24g").prop("disabled", true);
			else
				$("#wifikey_24g").removeProp('disabled');
		});

		$("#select_security_5g").change(function(event) {
			if($("#select_security_5g").val() == "0")
				$("#wifikey_5g").prop("disabled", true);
			else
				$("#wifikey_5g").removeProp('disabled');
		});
	});

	function doClickStatus24(){
		if($("#status_gz_24_ck").attr("checked")) {
			$("#wifiName_24g").removeProp("disabled");
			$("#select_security_24g").selectbox("enable");
			if($("#select_security_24g").val() == "0")
				$("#wifikey_24g").prop("disabled", true);
			else
				$("#wifikey_24g").removeProp('disabled');
		} else {
			$("#wifiName_24g").prop("disabled", true);
			$("#select_security_24g").selectbox("disable");
			$("#wifikey_24g").prop("disabled", true);
		}
	}

	function doClickStatus5(){
		if($("#status_gz_5_ck").attr("checked")) {
			$("#wifiName_5g").removeProp("disabled");
			$("#select_security_5g").selectbox("enable");
			if($("#select_security_5g").val() == "0")
				$("#wifikey_5g").prop("disabled", true);
			else
				$("#wifikey_5g").removeProp('disabled');
		} else {
			$("#wifiName_5g").prop("disabled", true);
			$("#select_security_5g").selectbox("disable");
			$("#wifikey_5g").prop("disabled", true);
		}
	}

	function save_button_changed() {
		document.getElementById("Save_Disable_btn").style.display = "none";
		document.getElementById("Save_btn").style.display = "block";
		changeFlag = true;
		checkFlag = true;
	}
</script>
</head>

<body>
	<div id="wrapper">
		<!-------------------- Logo ------------------------->
		<div id="header"></div>
		<!-------------------- Menu ------------------------->
		<div id="menu"></div>
		<div id="menu_edge"></div>
		<!-------------------- Content ---------------------->
		<div id="content">
			<!-------------------- info ---------------------->
	  		<div id="info">
			  	<div id="FunctionName"><script>prints(m_wifi_guest);</script></div>
			  	<div id="wall"><img src="/graphic/New_GUI/Guest.png?v=20140910163551" alt="" width="195" height="119"/></div>
			    <div id="directions">
					<script>prints(m_wifi_guest_desc);</script>
				</div>
			</div>
		    <!-------------------- funcBar ---------------------->
		    <div id="funcBar">
				<div id="pagePath"><script>prints(m_comm_settings);</script> >> <script>prints(m_wifi_guest);</script></div>
				<ul id="rightFunc">
					<li style="display:block"><div id="Save_btn" style="cursor:pointer; display:none"><script>prints(m_comm_Save);</script></div></li>
					<li style="display:block"><div id="Save_Disable_btn"><script>prints(m_comm_Save);</script></div></li>
					<li style="display:block"><a href="javascript:CheckHTMLStatus('WiFi');" style="text-decoration:none;"><div id="page_btn" class="linkstyle_1"><script>prints(m_menu_settings_wifi);</script></div></a></li>
				</ul>
			</div>
	    	<!-- ------------------ main ----------------------- -->
	     	
	     	<div id="main">	
				<!-------------------- Wi-Fi 2.4GHz ---------------------->
				<table class="block" style="margin: 10px 0 0 0;">
					<tbody>
						<tr>
							<td><div class ="title"><script>prints(m_wifi_guest_24);</script></div></td>
						</tr>
						<tr>
							<th><script>I18N("h", m_wifi_guest_status);</script>:</th>
							<td><div id="status_gz_24" class="checkbox_on"><input type="checkbox" name="status_gz_24" id="status_gz_24_ck" checked></div></td>
						</tr>
						<tr>
							<th><script>I18N("h", m_wifi_guest_ssid);</script>:</th>
							<td><input class="styled-text" type="text" name="wifiName_24g" size="30" maxlength="32" id="wifiName_24g"></td>
						</tr>						

						<tr>
							<th><script>I18N("h", m_comm_pwd);</script>:</th>
							<td><input class="styled-text" type="text" name="wifikey_24g" size="30" maxlength="32" id="wifikey_24g"></td>
						</tr>

						<tr>
							<th><script>I18N("h", m_wifi_security);</script>:</th>
							<td>
								<div class="styled-select">
									<select id="select_security_24g" name="select_security_24g">
										<script>
											prints("<option value='0'>" + m_comm_None + "</option>");
											prints("<option value='1'>" + m_wifi_wep64 + "</option>");
											prints("<option value='2'>" + m_wifi_wep128 + "</option>");
											prints("<option value='4'>" + m_wifi_wpa2 + "</option>");
											prints("<option value='5'>" + m_wifi_wpawpa2 + "</option>");
										</script>
									</select>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
				<hr />
				<!-------------------- Wi-Fi 5GHz  ---------------------->
				<table class="block" style="margin: 10px 0 0 0;">
					<tbody>
						<tr>
							<td><div class ="title">5GHz</div></td>
						</tr>
						<tr>
							<th><script>I18N("h", m_wifi_guest_status);</script>:</th>
							<td><div id="status_gz_5" class="checkbox_on"><input type="checkbox" name="status_gz_5" id="status_gz_5_ck" checked></div></td>
						</tr>
						<tr>
							<th><script>I18N("h", m_wifi_guest_ssid);</script>:</th>
							<td><input class="styled-text" type="text" name="wifiName_5g" size="30" maxlength="32" id="wifiName_5g"></input></td>
						</tr>						

						<tr>
							<th><script>I18N("h", m_comm_pwd);</script>:</th>
							<td><input class="styled-text" type="text" name="wifikey_5g" size="30" maxlength="32" id="wifikey_5g"></td>
						</tr>

						<tr>
							<th><script>I18N("h", m_wifi_security);</script>:</th>
							<td>
								<div class="styled-select">
									<select id="select_security_5g" name="select_security_5g">
										<script>
											prints("<option value='0'>" + m_comm_None + "</option>");
											prints("<option value='1'>" + m_wifi_wep64 + "</option>");
											prints("<option value='2'>" + m_wifi_wep128 + "</option>");
											prints("<option value='4'>" + m_wifi_wpa2 + "</option>");
											prints("<option value='5'>" + m_wifi_wpawpa2 + "</option>");
										</script>
									</select>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
		 	</div>
			

			<div id="CreatePopAlertMessage" style="display:none">
				<div id="AlertPopRect">
					<div id="AlertPopBody">
						<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Loading_pop_image2"></div></center>
									</td>
								 </tr>
								 <tr>
								 	<td><center><label id="reciprocal_Number">10</label></center></td>
								 </tr>
								 <tr>
								 	<td id="dialog_msg_black2"><script>I18N("h", m_comm_changesdesc);</script></td>
								 </tr>
						   </tbody>
						</table>
						<table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0"  style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Information_pop_image"></div></center>
									</td>
								 </tr>
								 <tr>
									 <td>
									 	<div id="dialog_msg_black"><script>I18N("h", m_comm_settingsave);</script></div>
									 </td>
								 </tr>
								 <tr>
									 <td>
									 	<center><div id="Confirm_btn" onclick="javascript: self.location.href = self.location.href;" style="cursor:pointer"><script>I18N("h", m_comm_ok);</script></div></center>
									 </td>
								 </tr>
						   </tbody>
						</table>
					</div>
				</div>
			</div>		
		 <div id="DetectRouterConnection" style="display:none"></div>
		 <div id="footer" border="0">
			<div id="copyright"><script>prints(m_comm_copyright);</script></div>
			<div id="help">
				<a target="_blank" href="http://www.dlink.com/support" style="cursor:pointer;text-Decoration:underline">
					
						<script>prints(m_home_gethelp);</script>
					
				</a>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Management");
	GetXML();
</script>
</html>