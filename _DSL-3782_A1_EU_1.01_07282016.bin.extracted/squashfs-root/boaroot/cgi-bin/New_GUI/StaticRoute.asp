<%
If Request_Form("buttonType")="delete" Then
	If Request_Form("enable_0")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","0")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_1")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","1")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_2")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","2")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_3")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","3")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_4")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","4")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_5")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","5")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_6")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","6")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_7")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","7")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_8")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","8")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_9")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","9")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_10")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","10")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_11")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","11")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_12")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","12")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_13")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","13")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_14")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","14")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
	If Request_Form("enable_15")="1" then
		TcWebApi_Set_Str("WebCurSet_Entry","route_id","15")
		tcWebApi_unset("Route_Entry")
		TcWebApi_Set_Str("Route_Entry","Active","No")
		TCWebApi_commit("Route_Entry")
	End If
elseif Request_Form("buttonType")="apply" then
	tcWebApi_set("WebCurSet_Entry","route_id","editRow")

	tcWebApi_unset("Route_Entry")
	TcWebApi_Set_Str("Route_Entry","Active","No")
	TCWebApi_commit("Route_Entry")

	TcWebApi_Set_Str("Route_Entry","Active","Yes")

	TCWebAPI_set("Route_Entry","DST_IP","destination")
	TCWebAPI_set("Route_Entry","Sub_mask","netmask")

	If Request_Form("gateRadio")="Yes" then
		TCWebAPI_set("Route_Entry","Gateway","gateway")
		TCWebAPI_set("Route_Entry","Device","emptyValue")
	else
		TCWebAPI_set("Route_Entry","Device","Route_index")
		TCWebAPI_set("Route_Entry","Gateway","emptyValue")
	End If
	TCWebAPI_set("Route_Entry","metric","metric")
	TCWebApi_commit("Route_Entry")
End If
%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns= "http://www.w3c.org/1999/xhtml">

<head>
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/css">
<link rel=stylesheet type="text/css" href="/layout/New_GUI/jquery.selectbox.css?v=20140910163551" />
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialCSS.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialJQ.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/initialValidate.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/__comm.js?v=20140910163551"></script>
<script type="text/javascript" charset="utf-8" src="/js/New_GUI/__js_comm.js?v=20140910163551"></script>

<!-- get -->
<script src="/cgi-bin/get/New_GUI/StaticRoute.asp" type="text/javascript"></script>
<!-- get -->

<!-- js -->
<script src="/js/New_GUI/Advanced/StaticRoute.js" type="text/javascript"></script> 
<!-- js -->

<script type="text/javascript">
	function Load_HTML() {
		$("#header").load("header.asp");
	}

	function Initial() {
		initialMenu();
	}

	function GetXML() {
		document.getElementById("main").style.display = "inline";
	}
</script>

<script type="text/javascript">	
	
	$(document).ready(function() {
		$("#RemainingRules").html(16 - AddRoutingCount);
		uiDoOnLoad();
		hideSaveBtn();
	});

</script>

<style>
.myCreatePop_table th{width:220px;text-align:right;margin:0;padding:0}
</style>

</head>

<body>
<form name="frm" id="frm" METHOD="POST">
<input type="hidden" name="sessionKey" id="sessionKey" value="<% tcWebApi_get("Account_Login","sessionKey","s") %>">
<input type="hidden" name="editRow" id="editRow" value="-1">
<input type="hidden" name="buttonType" id="buttonType">
<input type="hidden" name="emptyValue" id="emptyValue" value="">
<input type="hidden" name="Route_index" id="Route_index">
<input type="hidden" name="gateRadio" id="gateRadio">
<input type="hidden" name="conn_type" id="conn_type" value="<% tcWebApi_get("Wan_Common","TransMode","s") %>">
	<div id="wrapper">
		<!-- ------------------ Logo ----------------------- -->
		<div id="header"></div>
		<!-- ------------------ Menu ----------------------- -->
		<div id="menu"></div>
		<div id="menu_edge"></div>
		<!-- ------------------ Content -------------------- -->
		<div id="content">
			<!-- ------------------ info -------------------- -->
	  		<div id="info">
			  	<div id="FunctionName"><script>prints(m_staroute_header);</script></div>
			  	<div id="wallimage"><img id="page_StaticRoute" src="/graphic/New_GUI/page_StaticRoute.png" alt="" width="195" height="119"/></div>
			    <div id="directions">
					<script>prints(m_staroute_desc);</script>
					<label id="Get_Help" onClick="showOnlineHelp('Ip Filter');" style="cursor:pointer;display:none;text-Decoration:underline"><script>prints(m_comm_clickhelp);</script></label>
				</div>
			</div>
		    <!-- ------------------ funcBar -------------------- -->
		<div id="funcBar">
			<div id="pagePath"><script>prints(m_comm_features);</script> >> <script>prints(m_staroute_header);</script></div>
			<ul id="rightFunc">
				<li style="display:block"><div id="Save_btn" onclick="" style="cursor:pointer; display:none"></div></li>
				<li style="display:block"><div id="Save_Disable_btn"></div></li>
			</ul>
		</div>
	    	<!-- ------------------ main ----------------------- -->
	     	<div id="main" style="display:none">
		   	<!-- ------------------ table -------------------- -->		   
			<table class="mainTable" border="0" cellspacing="0">
			<thead>
				<tr>
					<th><script>prints(m_home_Network);</script></th>
					<th><script>prints(m_staroute_dessubmask);</script></th>
					<th><script>prints(m_staroute_Device);</script></th>
					<th><script>prints(m_staroute_gatewayip);</script></th>
					<th><script>prints(m_staroute_Metric);</script></th>
					<th><script>prints(m_comm_Edit);</script></th>
					<th><script>prints(m_comm_Delete);</script></th>
				</tr>
				<script>gen_table();</script>
			</thead>
			<tbody></tbody>
			</table>
			<br />
			<br />
				<button type="button" id="createButton" name="createButton" class="styled_button_s"  onclick="createUserButton()"><script>prints(m_comm_addrule);</script></button>
				&nbsp;&nbsp;<script>prints(m_comm_Remaining);</script>:&nbsp;<label id="RemainingRules"></label>
			<br />
			<!-- --------------------PopUp--------------------- -->
			<div id="createPop" style="display:none">
				<div class="dialogBox"  style="width:616px">
				<div id="closeCreatePopBtn" onclick="clearCreateRulePOP()" style="cursor:pointer"></div>
					<table class="myCreatePop_table" border="0" cellspacing="0">
						<tbody>
							<tr>
							 	<td colspan="3"><div class ="popTitle" id="popTitle"></div></td>
							</tr>
							<tr>
						     	<th><script>prints(m_staroute_desadd);</script>:</th>
								<td valign="top" colspan="2">
									<input class="styled-text" type="text" name="destination" size="27" id="destination">
									<label id="destination_error" name="destination_error" class="error"></label>
								</td>
							</tr>
							<tr>
						     	<th><script>prints(m_staroute_dessubmask);</script>:</th>								
								<td valign="top" colspan="2">
									<input class="styled-text" type="text" name="netmask" size="27" id="netmask">
									<label id="netmask_error" name="netmask_error" class="error"></label>
								</td>
							</tr>
							<tr>
								<th><script>prints(m_staroute_gatewayip);</script>:</th>
								<td style="width:10px;"><div id="gateRadio0" name="gateRadio0" class="clicked" OnClick="ChangGateWay(0);"></div></td>
								<td style="font-weight:bold;">
									<input class="styled-text" type="text" name="gateway" size="27" id="gateway">
									<label id="gateway_error" name="gateway_error" class="error"></label>
								</td>
							</tr>
							<tr id="routerinterface">
								<th></th>
								<td style="width:10px;"><div id="gateRadio1" name="gateRadio1" class="unclick" OnClick="ChangGateWay(1);"></div></div></td>
								<td style="font-weight:bold;">
									<table>
									<tr>
										<td>
											<div class="styled-select">
												<select id="Route_PVC_Index" name="Route_PVC_Index" onchange="ChangeInterface()"></select>			
											</div>
										</td>
										<td>
											<div class="styled-select">											
												<span id="Span_Route_Service_Index" name="Span_Route_Service_Index" style="display:none">
                                					<select id="Route_Service_Index" name="Route_Service_Index"></select>
                                				</span>
											</div>
										</td>
									</tr>
									</table>
								</td>
							</tr>						
							<tr>
						     	<th><script>prints(m_staroute_Metric);</script>:</th>
								<td valign="top" colspan="2">
									<input class="styled-text" type="text" name="metric" size="27" id="metric" >
									<label id="metric_error" name="metric_error" class="error"></label>
								</td>
							</tr>						
							<tr>
								<td id="save_td" colspan="3">
									<center><button type="button" class="styled_button_s" id="save_buttonFocus" onclick="uiDoSave();"><script>prints(m_comm_Apply);</script></button></center>	
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>	

			<!-- ------------------ alert pop ----------------------- -->			    
		 	<div id="CreatePopAlertMessage" style="display:none">
				<div id="AlertPopRect">
					<div id="AlertPopBody">
						<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0" style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Loading_pop_image2"></div></center>
									</td>
								 </tr>
								 <tr>
								 	<td><center><label id="reciprocal_Number"></label></center></td>
								 </tr>
								 <tr>
								 	<td id="dialog_msg_black2"><script>prints(m_comm_changesdesc);</script></td>
								 </tr>
						   </tbody>
						</table>
						<table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0"  style="display:none">
						   <tbody>
								 <tr>
								 	<td>
										<center><div id="Information_pop_image"></div></center>
									</td>
								 </tr>
								 <tr>
									 <td>
									 	<div id="dialog_msg_black"><script>prints(m_comm_settingsave);</script></div>
									 </td>
								 </tr>
								 <tr>
									 <td>
									 	<center><div id="Confirm_btn" onclick="javascript: self.location.href = self.location.href;" style="cursor:pointer"><script>prints(m_comm_ok);</script></div></center>
									 </td>
								 </tr>
						   </tbody>
						</table>
					</div>
				</div>
			</div>
			
			 <div id="DetectRouterConnection" style="display:none"></div>
		</div>
		<div id="footer" border="0">
			<div id="copyright"><script>prints(m_comm_copyright);</script></div>
			<div id="help">
				<a target="_blank" href="http://www.dlink.com/support" style="cursor:pointer;text-Decoration:underline">					
					<script>prints(m_home_gethelp);</script>					
				</a>
			</div>
		</div>
	</div>
</form>
</body>
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Advanced");
	GetXML();
</script>
</html>