try {
	if(!isNaN(top.deviceName) || !(typeof top.deviceName== 'undefined'))
		top.document.title = top.deviceName;
	else
		top.location.href = "http://"+self.location.hostname;
} catch(err){
	top.location.href = "http://"+self.location.hostname;
}

var result_url=document.location.href.split("/");
var a=0;
for(var i=0;i<result_url.length;i++) {
	if(result_url[i].indexOf(".asp") != -1) {
		a = i;
		break;
	}
}
var result = result_url[a].substring(0,result_url[a].indexOf(".asp"));
var xgiFilename=result+".xgi?"; // we need the variable in all web pages;
var thisFilename=result+".asp"; // we need the variable in all web pages;
var baseFilename=result; // we need the variable in all web pages; */
function NewMenuItem(cactory,thisname,thisURL,ShowTag,SubLevel) {
	var theExp=/\S*\/(\S*).asp/;
	var ssp=thisURL.match(theExp);
	this.index=cactory;
	this.name=thisname;
	this.url=thisURL;
	if(ssp)
		this.basefile=ssp[1];
	else
		this.basefile=thisURL;
	this.show=ShowTag;
	this.level=SubLevel;
}
var ie5=document.all && !window.opera;
var ns6=document.getElementById;
var defaultMenuWidth="130px"; //set default menu width.
var baseTop = 147;
var basewidth = 127;
var MenuList=new Array();
var TabStr=["SETUP","ADVANCED","MAINTENANCE","STATUS","HELP"];
var Idx_home=0;
var Idx_adv=1;
var Idx_tools=2;
var Idx_status=3;
var Idx_help=4;

function addMenuTab(cactory,thisname,thisURL,ShowTag,SubLevel) {
    MenuList[MenuList.length]=new NewMenuItem(cactory,thisname,thisURL,ShowTag,SubLevel);
}

function findCactoryByUrl() {

    for(i=0;i<MenuList.length;i++) {
		if(MenuList[i].url.indexOf(baseFilename)==0 || baseFilename.indexOf(MenuList[i].basefile)==0)
			return MenuList[i].index;
    }
    if(baseFilename.indexOf("sp_")!=-1)
			return Idx_home;
    else if(baseFilename.indexOf("ad_")!=-1)
			return Idx_adv;
    else if(baseFilename.indexOf("mt_")!=-1)
			return Idx_tools;
    else if(baseFilename.indexOf("st_")!=-1)
			return Idx_status;
    else if(baseFilename.indexOf("help_")!=-1)
			return Idx_help;
    alert("unknow file "+baseFilename);
}
function showmenu(e, which, count){
	if (!document.all&&!document.getElementById)
		return;
	clearhidemenu();
	menuobj=document.getElementById("popitmenu");
	menuobj.innerHTML=which;
	menuobj.contentwidth=menuobj.offsetWidth;
	menuobj.contentheight=menuobj.offsetHeight;
	eventX=ie5? event.clientX : e.clientX;
	eventY=ie5? event.clientY : e.clientY;
	//Find out how close the mouse is to the corner of the window;

	var rightedge=ie5? iecompattest().clientWidth-eventX : window.innerWidth-eventX;
	var bottomedge=ie5? iecompattest().clientHeight-eventY : window.innerHeight-eventY;
	var tempEl = count;
	var baseLeft = 0;
	var tempTop =0;

	while (tempEl != null) {
		baseLeft += tempEl.offsetLeft;
		tempTop += tempEl.offsetTop;
		tempEl = tempEl.offsetParent;
	}

	if (rightedge<menuobj.contentwidth)
		menuobj.style.left=baseLeft+basewidth;
	else
		menuobj.style.left=baseLeft+basewidth;

	if (bottomedge<menuobj.contentheight)
		menuobj.style.top= tempTop;
	else
		menuobj.style.top=tempTop;

	menuobj.style.visibility="visible";
	return false;
}

function iecompattest() {
	if(document.compatMode && document.compatMode.indexOf("CSS")!=-1)
		return document.documentElement;
	else
		return document.body;
}

function contains_ns6(a, b) {
	while (b.parentNode)
		if ((b = b.parentNode) == a)
		return true;
	return false;
}

function delayhidemenu(){
	delayhide=setTimeout("hidemenu()",300);
}

function clearhidemenu(){
	if (window.delayhide)
		clearTimeout(delayhide);
}

function hidemenu(){
	if (window.menuobj)
		menuobj.style.visibility="hidden";
}

function dynamichide(e){
	if (ie5&&!menuobj.contains(e.toElement))
		hidemenu();
	else if (ns6&&e.currentTarget!= e.relatedTarget&& !contains_ns6(e.currentTarget, e.relatedTarget))
		hidemenu();
}
var linkset=new Array();
function initLinkSet()
{
	/***********TK*******
	var unlock="<?ConfigGet(/runtime/web/unlock)?>";
	*/
	var unlock="0";
	linkset[0]='<table border="0" cellpadding="0" cellspacing="0"><tr><td id="sidenav_container"><DIV id="sidenav"><ul>';
	linkset[0]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_routing.asp">'+mn_srouting+'</A></div></LI>';
	linkset[0]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_rip.asp">'+mn_rip+'</A></div></LI>';
	linkset[0]+='</LI></ul></DIV></td></tr></table>';

	linkset[1]='<table border="0" cellpadding="0" cellspacing="0"><tr><td id="sidenav_container"><DIV id="sidenav"><ul>';
	linkset[1]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_wlan_access.asp">'+mn_wlan_access+'</A></div></LI>';
	linkset[1]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_multiple_wlan.asp">'+mn_multiple_wlan+'</A></div></LI>';
	linkset[1]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_wlan_performance.asp">'+mn_wlan_performance+'</A></div>';
	linkset[1]+='</LI></ul></DIV></td></tr></table>';

	linkset[2]='<table border="0" cellpadding="0" cellspacing="0"><tr><td id="sidenav_container"><DIV id="sidenav"><ul>';
	if(parseInt(unlock) == 1)
		linkset[2]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_portmap.asp">'+mn_portmap+'</A></div></LI>';
	linkset[2]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_igmp.asp">'+mn_igmp+'</A></div></LI>';
	linkset[2]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_qos.asp">'+mn_qos+'</A></div></LI>';
	linkset[2]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_upnp.asp">'+mn_UPnP+'</A></div></LI>';
	linkset[2]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_acl.asp">ACL</A></div></LI>';
	linkset[2]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_tr069.asp">'+mn_tr069+'</A></div></LI>';
	linkset[2]+='<LI><div id=sidenavon><A href="/cgi-bin/ADVANCED/ad_samba.asp">'+mn_samba+'</A></div></LI>';

	linkset[2]+='</LI></ul></DIV></td></tr></table>';
}

function GenLeftMenuItem() {
	initLinkSet();
	cat=findCactoryByUrl();
	var matched=0;
	var str="<ul>";
	for(i=0;i<MenuList.length;i++) {
		if(MenuList[i].show != 0) {
			if(MenuList[i].index!=cat)
				continue;

			if((MenuList[i].url.indexOf(baseFilename)==0 || baseFilename.indexOf(MenuList[i].basefile)==0) && !matched) {//is myself and match first one			
				if (MenuList[i].url.indexOf("st_stat")>=0)
					str+="<li><div id='sidenavoff'><a href='"+MenuList[i].url+"'>"+MenuList[i].name+"</a></div></li>"
				else {
					if(MenuList[i].level == "-1")
						str+="<li><div id='sidenavoff'><a href='"+MenuList[i].url+"'>"+MenuList[i].name+"</a></div></li>";
					else
						str+="<li><div id='sidenavoff' onMouseover='showmenu(event,linkset["+MenuList[i].level+"], this)' onMouseout='delayhidemenu()' ><a href='"+MenuList[i].url+"'>"+MenuList[i].name+"</a></div></li>";
				}

				matched=1;
			} else {
				if (MenuList[i].url.indexOf("st_stat")>=0)
					str+="<li><div id='sidenavon'><a href='"+MenuList[i].url+"'>"+MenuList[i].name+"</a></div></li>"
				else {
					if(MenuList[i].level == "-1")
						str+="<li><div id='sidenavon'><a href='"+MenuList[i].url+"'>"+MenuList[i].name+"</a></div></li>"
					else
						str+="<li><div id='sidenavon' onMouseover='showmenu(event,linkset["+MenuList[i].level+"], this)' onMouseout='delayhidemenu()' ><a href='"+MenuList[i].url+"'>"+MenuList[i].name+"</a></div></li>";
				}
			}
		}
	}
	str+="</ul>";
	document.write(str);
}

function GenTopMenuItem() {
	var cat=findCactoryByUrl();
	var TabUrl=new Array();
	var myindex=0;//home index sa=tart
	var str="";
	for(i=0;i<MenuList.length;i++) {
		if(myindex==MenuList[i].index)
			TabUrl[myindex++]=MenuList[i].url;
	}
	for(i=0;i<TabUrl.length;i++) {
		if(cat==i)
			tmp="topnavon";
		else
			tmp="topnavoff";
		str+="<td id="+tmp+"><a href='"+TabUrl[i]+"'>"+TabStr[i]+"</a></td>"
	}
	document.write(str);
}

function st_stat() {
	top.fPanel.location.href="st_stat_wait.xgi?&set/runtime/dsl/set_ready=1";
}

addMenuTab(Idx_home,mn_wizard,"/cgi-bin/SETUP/sp_home.asp",1,-1);
addMenuTab(Idx_home,mn_wan,"/cgi-bin/SETUP/sp_wan.asp",1,-1);
addMenuTab(Idx_home,mn_wlan,"/cgi-bin/ADVANCED/ad_wireless.asp",1,-1);
addMenuTab(Idx_home,mn_lan,"/cgi-bin/SETUP/sp_lan.asp",1,-1);
addMenuTab(Idx_home,mn_time,"/cgi-bin/SETUP/sp_time.asp",1,-1);
addMenuTab(Idx_home,mn_logout,"/cgi-bin/SETUP/sp_logout.asp",1,-1);

// addMenuTab(Idx_adv,mn_wlan2,"/cgi-bin/ADVANCED/ad_wlan_access.asp",1,1);
addMenuTab(Idx_adv,mn_wlan2,"/cgi-bin/ADVANCED/ad_wlan_all.asp",1,1);
addMenuTab(Idx_adv,mn_virtual_server,"/cgi-bin/ADVANCED/ad_virtual_server.asp",1,-1);
addMenuTab(Idx_adv,mn_application,"/cgi-bin/ADVANCED/ad_applications.asp",1,-1);
addMenuTab(Idx_adv,mn_dmz,"/cgi-bin/ADVANCED/ad_dmz.asp",1,-1);
addMenuTab(Idx_adv,mn_parental_control,"/cgi-bin/ADVANCED/ad_parental_control.asp",1,-1);
addMenuTab(Idx_adv,mn_filter,"/cgi-bin/ADVANCED/ad_filter.asp",1,-1);
addMenuTab(Idx_adv,mn_adsl,"/cgi-bin/ADVANCED/ad_adsl.asp",1,-1);
addMenuTab(Idx_adv,mn_firewall,"/cgi-bin/ADVANCED/ad_firewall.asp",1,-1);
addMenuTab(Idx_adv,mn_dns,"/cgi-bin/ADVANCED/ad_dns.asp",1,-1);
addMenuTab(Idx_adv,mn_Dynamic_dns,"/cgi-bin/ADVANCED/ad_dynamic_dns.asp",1,-1);
addMenuTab(Idx_adv,mn_network,"/cgi-bin/ADVANCED/ad_network_all.asp",1,2);
addMenuTab(Idx_adv,mn_routing,"/cgi-bin/ADVANCED/ad_routing_all.asp",1,0);
addMenuTab(Idx_adv,mn_logout,"/cgi-bin/ADVANCED/ad_logout.asp",1,-1);

addMenuTab(Idx_tools,mn_admin,"/cgi-bin/MAINTENANCE/mt_admin.asp",1,-1);
addMenuTab(Idx_tools,mn_system,"/cgi-bin/MAINTENANCE/mt_system.asp",1,-1);
addMenuTab(Idx_tools,mn_firmware,"/cgi-bin/MAINTENANCE/mt_firmware.asp",1,-1);
addMenuTab(Idx_tools,mn_test,"/cgi-bin/MAINTENANCE/mt_test.asp?5,0",1,-1);
if( top.isIPv6Supported == "Yes")
	addMenuTab(Idx_tools,mn_ipv6,"/cgi-bin/MAINTENANCE/mt_ipv6.asp",1,-1);

addMenuTab(Idx_tools,mn_sh,"/cgi-bin/MAINTENANCE/mt_sh.asp",1,-1);
addMenuTab(Idx_tools,mn_remotelog,"/cgi-bin/MAINTENANCE/mt_remotelog.asp",1,-1);
addMenuTab(Idx_tools,mn_logout,"/cgi-bin/MAINTENANCE/mt_logout.asp",1,-1);

addMenuTab(Idx_status,mn_devinfo,"/cgi-bin/STATUS/st_deviceinfo.asp",1,-1);
addMenuTab(Idx_status,mn_log,"/cgi-bin/STATUS/st_log.asp",1,-1);
addMenuTab(Idx_status,mn_stats,"/cgi-bin/STATUS/st_stat.asp?0",1,-1);
addMenuTab(Idx_status,mn_logout,"/cgi-bin/STATUS/st_lout.asp",1,-1);

addMenuTab(Idx_help,mn_help_menu,"/cgi-bin/HELP/help_menu.asp",1,-1);
addMenuTab(Idx_help,mn_setup,"/cgi-bin/HELP/help_setup.asp",1,-1);
addMenuTab(Idx_help,mn_adv,"/cgi-bin/HELP/help_adv.asp",1,-1);
addMenuTab(Idx_help,mn_maintenance,"/cgi-bin/HELP/help_tools.asp",1,-1);
addMenuTab(Idx_help,mn_status,"/cgi-bin/HELP/help_status.asp",1,-1);
addMenuTab(Idx_help,mn_logout,"/cgi-bin/HELP/help_logout.asp",1,-1);