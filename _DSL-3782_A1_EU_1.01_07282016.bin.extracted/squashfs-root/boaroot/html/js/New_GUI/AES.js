function AES_Init(){AES_Sbox_Inv=new Array(256);for(var a=0;a<256;a++){AES_Sbox_Inv[AES_Sbox[a]]=a}AES_ShiftRowTab_Inv=new Array(16);for(var a=0;a<16;a++){AES_ShiftRowTab_Inv[AES_ShiftRowTab[a]]=a}AES_xtime=new Array(256);for(var a=0;a<128;a++){AES_xtime[a]=a<<1;AES_xtime[128+a]=(a<<1)^27}}function AES_Done(){delete AES_Sbox_Inv;delete AES_ShiftRowTab_Inv;delete AES_xtime}function AES_Encrypt(d,c){var a=c.length;AES_AddRoundKey(d,c.slice(0,16));for(var b=16;b<a-16;b+=16){AES_SubBytes(d,AES_Sbox);AES_ShiftRows(d,AES_ShiftRowTab);AES_MixColumns(d);AES_AddRoundKey(d,c.slice(b,b+16))}AES_SubBytes(d,AES_Sbox);AES_ShiftRows(d,AES_ShiftRowTab);AES_AddRoundKey(d,c.slice(b,a));return d}function AES_Decrypt(d,c){var a=c.length;AES_AddRoundKey(d,c.slice(a-16,a));AES_ShiftRows(d,AES_ShiftRowTab_Inv);AES_SubBytes(d,AES_Sbox_Inv);for(var b=a-32;b>=16;b-=16){AES_AddRoundKey(d,c.slice(b,b+16));AES_MixColumns_Inv(d);AES_ShiftRows(d,AES_ShiftRowTab_Inv);AES_SubBytes(d,AES_Sbox_Inv)}AES_AddRoundKey(d,c.slice(0,16));return d}AES_Sbox=new Array(99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22);AES_ShiftRowTab=new Array(0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11);function AES_SubBytes(c,a){for(var b=0;b<16;b++){c[b]=a[c[b]]}}function AES_AddRoundKey(c,a){for(var b=0;b<16;b++){c[b]^=a[b]}}function AES_ShiftRows(c,d){var b=new Array().concat(c);for(var a=0;a<16;a++){c[a]=b[d[a]]}}function AES_MixColumns(g){for(var d=0;d<16;d+=4){var f=g[d+0],c=g[d+1];var b=g[d+2],a=g[d+3];var e=f^c^b^a;g[d+0]^=e^AES_xtime[f^c];g[d+1]^=e^AES_xtime[c^b];g[d+2]^=e^AES_xtime[b^a];g[d+3]^=e^AES_xtime[a^f]}}function AES_MixColumns_Inv(a){for(var b=0;b<16;b+=4){var l=a[b+0],k=a[b+1];var j=a[b+2],g=a[b+3];var c=l^k^j^g;var f=AES_xtime[c];var e=AES_xtime[AES_xtime[f^l^j]]^c;var d=AES_xtime[AES_xtime[f^k^g]]^c;a[b+0]^=e^AES_xtime[l^k];a[b+1]^=d^AES_xtime[k^j];a[b+2]^=e^AES_xtime[j^g];a[b+3]^=d^AES_xtime[g^l]}}function hexstr2array(b,d){var a=new Array(d);var c=0;for(c=0;c<d;c++){if(c<b.length/2){a[c]=parseInt(b.substr(c*2,2),16)}else{a[c]=0}}return a}function str2hexstr(d){var c="";for(var b=0;b<d.length;b=b+1){c=c+d.charCodeAt(b).toString(16)}return c}function array2hexstr(c){var a=c.length;var b="";for(var e=0;e<a;e++){var d=c[e].toString(16);if(d.length==1){d="0"+d}b=b+d}return b}function hexstr2str(b){var a="";for(var c=0;c<b.length;c=c+2){var d=b.substr(c,2);if(d=="00"){break}else{a=a+String.fromCharCode(parseInt(d,16))}}return a}function AES_Encrypt128(a){var l=str2hexstr(a);var g=localStorage.getItem("PrivateKey");if(g.length>32){g=g.substr(0,32)}var k=hexstr2array(g,32);var f=hexstr2array(l,64);var b="";var h=new Array(64);AES_Init();for(var e=0;e<4;e++){var c=new Array(16);for(var d=0;d<16;d++){c[d]=f[e*16+d]}c=AES_Encrypt(c,k);for(var d=0;d<16;d++){h[e*16+d]=c[d]}}b=array2hexstr(h);AES_Done();return b}function AES_Decrypt128(e){var f=localStorage.getItem("PrivateKey");if(f.length>32){f=f.substr(0,32)}var k=hexstr2array(f,32);var g=hexstr2array(e,64);var a="";var h=new Array(64);AES_Init();for(var d=0;d<4;d++){var b=new Array(16);for(var c=0;c<16;c++){b[c]=g[d*16+c]}b=AES_Decrypt(b,k);for(var c=0;c<16;c++){h[d*16+c]=b[c]}}a=array2hexstr(h);a=hexstr2str(a);AES_Done();return a};