var maxScheduleRule = 10;
var ScheduleList = new Array();

CountSchedule();

function CountSchedule() {
	for (var i = 0; i < maxScheduleRule; i++) {
		var port_name = eval("port" + i + "_name");
		if (port_name != "N/A") {
			ScheduleList.push(port_name);
		} else {
			ScheduleList.push("");
		}
	}
}

var msg_length;
var submittype = 0;
var cipherType = "";

function wpa(ip, port, secret) {
	this.ip = ip;
	this.port = port;
	this.secret = secret;
}

function normal(wep, encryption, type, defkey, key1, key2, key3, key4) {
	this.wep = wep;
	this.encryption = encryption;
	this.type = type;
	this.defkey = defkey;
	this.key1 = key1;
	this.key2 = key2;
	this.key3 = key3;
	this.key4 = key4;
}

function wireless(radio, wmm, ssid, country, channel, autoChannel, superG, auth, normal, wpa, wpapsk) {
	this.radio = radio;
	this.wmm = wmm;
	this.ssid = ssid;
	this.country = country;
	this.channel = channel;
	this.autoChannel = autoChannel;
	this.superG = superG;
	this.auth = auth;
	this.normal = normal;
	this.wpa = wpa;
	this.wpapsk = wpapsk;
}

var countdown = 0;
var countdown2 = 0;

function slip_url(original_url) {
	var url = original_url;
	while (url.indexOf('?') != -1) {
		j = url.indexOf('?') + 1;
		url = url.substring(j, url.length);
	}
	return url;
}

function returnToHome() {
	self.location.href = "WiFi.asp";
}

function doChannelBandwidthChange() {
	var f = document.getElementById("wifi_form");

	if (f.channelMode.value == 1) {
		$("#WLANExtensionChannel").selectbox("detach");
		document.getElementById("show_extension_channel").style.display = "";
		if ((f.lan_wlan_channel.value == 1) || (f.lan_wlan_channel.value == 2) || (f.lan_wlan_channel.value == 3) || (f.lan_wlan_channel.value == 4)) {
			f.WLANExtensionChannel.value = 1;
			document.getElementById("show_extension_channel").style.display = "none";
		} else if ((f.lan_wlan_channel.value == 8) || (f.lan_wlan_channel.value == 9) || (f.lan_wlan_channel.value == 10) || (f.lan_wlan_channel.value == 11) || (f.lan_wlan_channel.value == 12) || (f.lan_wlan_channel.value == 13)) {
			f.WLANExtensionChannel.value = 0;
			document.getElementById("show_extension_channel").style.display = "none";
		} else if(f.lan_wlan_channel.value == 0){
			f.WLANExtensionChannel.value = 1;
			document.getElementById("show_extension_channel").style.display = "none";
		} else {
			document.getElementById("show_extension_channel").style.display = "";
			f.WLANExtensionChannel.value = extension_channel;
		}
		$("#WLANExtensionChannel").selectbox("attach");
	} else {
		document.getElementById("show_extension_channel").style.display = "none";
	}
}

function modefor802_change_ac() {
	var f = document.getElementById("wifi_form");
	if (f.bgMode_ac.value == "2") {
		document.getElementById("showCW_ac").style.display = "none";
	} else {
		document.getElementById("showCW_ac").style.display = "";
		if (f.bgMode_ac.value == "8") {
			$("#select_channel_0_ac").selectbox("detach");
			f.channelMode_ac.length = 0;
			$("<option value='0'>20 MHz</option>").appendTo("#select_channel_0_ac");
			$("<option value='1'>20/40 MHz</option>").appendTo("#select_channel_0_ac");
			$("#select_channel_0_ac").selectbox("attach");
		} else {
			$("#select_channel_0_ac").selectbox("detach");
			f.channelMode_ac.length = 0;
			$("<option value='0'>20 MHz</option>").appendTo("#select_channel_0_ac");
			$("<option value='1'>20/40 MHz</option>").appendTo("#select_channel_0_ac");
			$("<option value='2'>20/40/80 MHz</option>").appendTo("#select_channel_0_ac");
			$("#select_channel_0_ac").selectbox("attach");
		}
	}
}

function show_channel_width() {
	var f = document.getElementById("wifi_form");

	if ((f.bgMode.value == 6) || (f.bgMode.value == 7) || (f.bgMode.value == 9)) {
		$("#select_channel_0").selectbox("enable");
		document.getElementById("showCW").style.display = "";
		if (parseInt(channelwidth) == 1) {
			if (parseInt(bss_coexistence) == 1)
				f.channelMode.value = 1;
			else
				f.channelMode.value = 2;
		} else
			f.channelMode.value = 0;
		doChannelBandwidthChange();

		document.getElementById("show_short_guard_interval").style.display = "";
		if (parseInt(sgi) == 1)
			SetCheckBoxEnable("sgi", true, true);
		else
			SetCheckBoxEnable("sgi", true, false);
	} else {
		$("#select_channel_0").selectbox("disable");
		document.getElementById("showCW").style.display = "none";
		document.getElementById("show_extension_channel").style.display = "none";
		document.getElementById("show_short_guard_interval").style.display = "none";
	}
}

function show_channel_width_ac() {
	var f = document.getElementById("wifi_form");
	$("#select_channel_0_ac").selectbox("enable");
	document.getElementById("showCW_ac").style.display = "";
	document.getElementById("show_extension_channel_ac").style.display = "none";
	modefor802_change_ac();
	$("#select_channel_0_ac").selectbox("detach");
	if (f.bgMode_ac.value == "8") {
		if (parseInt(channelwidth_ac) == "0")
			f.channelMode_ac.value = 0;
		else
			f.channelMode_ac.value = 1;
	} else if ((f.bgMode_ac.value == "14") || (f.bgMode_ac.value == "15")) {
		if (parseInt(channelwidth_ac) == "0") {
			f.channelMode_ac.value = 0;
		} else {
			if (parseInt(vhtwidth) == "0") {
				f.channelMode_ac.value = 1;
			} else {
				f.channelMode_ac.value = 2;
			}
		}
	} else
		f.channelMode_ac.value = 0;

	if (f.bgMode_ac.value != "2") {
		document.getElementById("show_short_guard_interval_ac").style.display = "";
		if (parseInt(sgi_ac) == 1)
			SetCheckBoxEnable("sgi_ac", true, true);
		else
			SetCheckBoxEnable("sgi_ac", true, false);
	} else
		document.getElementById("show_short_guard_interval_ac").style.display = "none";
	$("#select_channel_0_ac").selectbox("attach");
}

function doExtChaLockChange() {
	var f = document.getElementById("wifi_form");
	if ((f.bgMode.value == 6) || (f.bgMode.value == 7) || (f.bgMode.value == 9)) {
		if (f.channelMode.value == 1) {
			doChannelBandwidthChange();
		}
	}
}

function initPerf() {
	var f = document.getElementById("wifi_form");
	f.beaconInterval.value = S_Interval;
	f.dtim.value = Dttm;

	if (Tx_power != 'N/A')
		f.antennaPower.value = Tx_power;
	else
		f.antennaPower.value = "100";

	f.fragThreshold.value = F_thr;
	f.bgMode.value = mode_802;
	$("#lan_wlan_channel").selectbox("enable");
	if (channel != "N/A")
		f.lan_wlan_channel.value = parseInt(channel);

	show_channel_width();
}

function initPerf_ac() {
	var f = document.getElementById("wifi_form");
	f.beaconInterval_ac.value = S_Interval_ac;
	f.dtim_ac.value = Dttm_ac;

	if (Tx_power_ac != 'N/A')
		f.antennaPower_ac.value = Tx_power_ac;
	else
		f.antennaPower_ac.value = "100";

	f.bgMode_ac.value = mode_802_ac;

	$("#lan_wlan_channel_ac").selectbox("enable");
	if (channel_ac != "N/A")
		f.lan_wlan_channel_ac.value = parseInt(channel_ac);

	show_channel_width_ac();
	if ((mode_802_ac == 14) || (mode_802_ac == 15))
		document.getElementById("ieee_80211h").disabled = true;
	if (ieee80211h == 1)
		SetCheckBoxEnable("ieee_80211h", true, true);
	else
		SetCheckBoxEnable("ieee_80211h", true, false);
}

function checkParameter_adv() {
	var f = document.getElementById("wifi_form");

	if (!(isNumber(f.beaconInterval.value)) || parseInt(f.beaconInterval.value) < 20 || parseInt(f.beaconInterval.value) > 1000) {
		$("#beaconInterval_error").html("<br/>" + m_wifi_waringsignalinterval);
		f.beaconInterval.focus();
		f.beaconInterval.select();
		return false;
	}

	if (!(isNumber(f.dtim.value)) || parseInt(f.dtim.value) < 1 || parseInt(f.dtim.value) > 255) {
		$("#dtim_error").html("<br/>" + m_wifi_waringditm);
		f.dtim.focus();
		f.dtim.select();
		return false;
	}

	if (!(isNumber(f.fragThreshold.value)) || parseInt(f.fragThreshold.value) < 256 || parseInt(f.fragThreshold.value) > 2346) {
		$("#fragThreshold_error").html("<br/>" + m_wifi_waringthre);
		f.fragThreshold.focus();
		f.fragThreshold.select();
		return false;
	}

	if (f.fragThreshold.value % 2) {
		$("#fragThreshold_error").html("<br/>" + m_wifi_waringfra);
		f.fragThreshold.focus();
		f.fragThreshold.select();
		return false;
	}
	return true;
}

function checkParameter_adv_ac() {
	var f = document.getElementById("wifi_form");

	if (!(isNumber(f.beaconInterval_ac.value)) || parseInt(f.beaconInterval_ac.value) < 40 || parseInt(f.beaconInterval_ac.value) > 1000) {
		$("#beaconInterval_ac_error").html("<br/>" + m_wifi_waringsignaliterval1);
		f.beaconInterval_ac.focus();
		f.beaconInterval_ac.select();
		return false;
	}

	if (!(isNumber(f.dtim_ac.value)) || parseInt(f.dtim_ac.value) < 1 || parseInt(f.dtim_ac.value) > 255) {
		$("#dtim_ac_error").html("<br/>" + m_wifi_waringditm);
		f.dtim_ac.focus();
		f.dtim_ac.select();
		return false;
	}
	return true;
}

function initWireless_page() {
	var f = document.getElementById("wifi_form");

	if (smode == 1 || smode == 5 || smode == 8) {
		showWEP();
		show24WEP_pwd();
		f.lan_wlan_security.value = 1;
	}

	if (smode == 10 || smode == 12 || smode == 11) {
		showWEP();
		show24WEP_pwd();
		f.lan_wlan_security.value = 2;
	}

	if (smode == 6 || smode == 2) {
		showWPA('wpa');
		f.lan_wlan_security.value = 3;

	}

	if (smode == 7 || smode == 3) {
		showWPA('wpa2');
		f.lan_wlan_security.value = 4;


	}

	if (smode == 9 || smode == 4) {
		showWPA('wpawpa2');
		f.lan_wlan_security.value = 5;

	}
	if (smode == 0) {
		f.lan_wlan_security.value = 0;
		var str = "";
		$("#security_tbody").html(str);
	}

	document.getElementById("RADIO_2GHz").style.display = "block";

	var currentURL = document.location.search;

	if (hidden_ssid == 1)
		SetCheckBoxEnable("hide_24", true, true);
	else
		SetCheckBoxEnable("hide_24", true, false);

	document.getElementById("wifi").style.display = "block";
	if (parseInt(wi_enable) == 7)
		SetCheckBoxEnable("wifi_enable_24", true, true);
	else
		SetCheckBoxEnable("wifi_enable_24", true, false);
	wps_enable(0);

	if (en_accpoint == 1)
		SetCheckBoxEnable("status_24", true, true);
	else
		SetCheckBoxEnable("status_24", true, false);

	f.sssid.value = decodeSpecialChr(dataLists[0][1]);

	if (mode_802 == "9" || mode_802 == "7" || mode_802 == "6") {
		SetCheckBoxEnable("wmm_24", true, true);
	} else {
		if (wmm == 1)
			SetCheckBoxEnable("wmm_24", true, true);
		else
			SetCheckBoxEnable("wmm_24", true, false);
	}
	if (preamble_type == 1)
		SetCheckBoxEnable("checkbox_is_pt", true, true);
	else
		SetCheckBoxEnable("checkbox_is_pt", true, false);

	if (smode == 0)
		f.lan_wlan_security.value = 0;

	if (smode == 6 || smode == 7 || smode == 9) {
		if (smode == 6)
			f.lan_wlan_security.value = 3;
		else if (smode == 7)
			f.lan_wlan_security.value = 4;
		else if (smode == 9)
			f.lan_wlan_security.value = 5;

		document.getElementById("wpatype_8021x").setAttribute("class", "unclick");
		document.getElementById("wpatype_psk").setAttribute("class", "clicked");
		$(".ShowWPA1").hide();
		show24WPA_pwd();
		if (currentURL.indexOf("smode") == -1) {
			if ((wireless_encrypttype != "TKIP") && (wireless_encrypttype != "AES") && ((wireless_encrypttype != "TKIPAES"))) {
				if (mode_802 == "6") {
					f.cipher_type.value = "TKIPAES";
				} else {
					if (smode == 6)
						f.cipher_type.value = "TKIP";
					else if (smode == 7)
						f.cipher_type.value = "AES";
					else
						f.cipher_type.value = "TKIPAES";
				}
				if (f.cipher_type.value == "")
					f.cipher_type.value = "TKIPAES";
			} else {
				if (mode_802 == "6") {
					if (f.lan_wlan_security.value == 3)
						f.cipher_type.value = "TKIPAES";
					else {
						if (wireless_encrypttype != "TKIP")
							f.cipher_type.value = wireless_encrypttype;
						else
							f.cipher_type.value = "TKIPAES";
					}
				} else {
					if (wireless_encrypttype == "AES") {
						if (smode == 6)
							f.cipher_type.value = "TKIP";
						else
							f.cipher_type.value = wireless_encrypttype;
					} else
						f.cipher_type.value = wireless_encrypttype;
				}
				if (f.cipher_type.value == "")
					f.cipher_type.value = "TKIPAES";
				cipherType = f.cipher_type.value;
			}
		} else if (smode == 9) {
			if ((wireless_encrypttype != "TKIP") && (wireless_encrypttype != "AES") && ((wireless_encrypttype != "TKIPAES"))) {
				if (mode_802 == "6") {
					f.cipher_type.value = "TKIPAES";
				} else {
					if (smode == 6)
						f.cipher_type.value = "TKIP";
					else if (smode == 7)
						f.cipher_type.value = "AES";
					else
						f.cipher_type.value = "TKIPAES";
				}
				if (f.cipher_type.value == "")
					f.cipher_type.value = "TKIPAES";
			} else {
				if (mode_802 == "6") {
					if (f.lan_wlan_security.value == 3)
						f.cipher_type.value = "TKIPAES";
					else {
						if (wireless_encrypttype != "TKIP")
							f.cipher_type.value = wireless_encrypttype;
						else
							f.cipher_type.value = "TKIPAES";
					}
				} else {
					if (wireless_encrypttype == "AES") {
						if (smode == 6)
							f.cipher_type.value = "TKIP";
						else
							f.cipher_type.value = wireless_encrypttype;
					} else
						f.cipher_type.value = wireless_encrypttype;
				}
				if (f.cipher_type.value == "")
					f.cipher_type.value = "TKIPAES";
				cipherType = f.cipher_type.value;
			}
		}

		f.lan_wlan_groupkeyinterval.value = groupkey;
		f.lan_wlan_string.value = wpapsk;
	} else if (smode == 2 || smode == 3 || smode == 4) {
		if (smode == 2)
			f.lan_wlan_security.value = 3;
		else if (smode == 3)
			f.lan_wlan_security.value = 4;
		else if (smode == 4)
			f.lan_wlan_security.value = 5;

		document.getElementById("wpatype_8021x").setAttribute("class", "clicked");
		document.getElementById("wpatype_psk").setAttribute("class", "unclick");
		if (currentURL.indexOf("smode") == -1) {
			if ((wireless_encrypttype != "TKIP") && (wireless_encrypttype != "AES") && ((wireless_encrypttype != "TKIPAES"))) {
				if (mode_802 == "6") {
					f.cipher_type.value = "TKIPAES";
				} else {
					if (smode == 2)
						f.cipher_type.value = "TKIP";
					else if (smode == 3)
						f.cipher_type.value = "AES";
					else
						f.cipher_type.value = "TKIPAES";
				}
				if (f.cipher_type.value == "")
					f.cipher_type.value = "TKIPAES";
			} else {
				if (mode_802 == "6") {
					if (f.lan_wlan_security.value == 3)
						f.cipher_type.value = "TKIPAES";
					else {
						if (wireless_encrypttype != "TKIP")
							f.cipher_type.value = wireless_encrypttype;
						else
							f.cipher_type.value = "TKIPAES";
					}
				} else {
					if (wireless_encrypttype == "AES") {
						if (smode == 2)
							f.cipher_type.value = "TKIP";
						else
							f.cipher_type.value = wireless_encrypttype;
					} else
						f.cipher_type.value = wireless_encrypttype;
				}
				if (f.cipher_type.value == "")
					f.cipher_type.value = "TKIPAES";
			}
		}

		$(".ShowWPA1").show();
		show24WPA_defPwd();
		f.lan_wlan_groupkeyinterval.value = groupkey;
		f.lan_wlan_serverip.value = serverip;
		f.lan_wlan_port.value = wlan_port;
		f.lan_wlan_secret.value = decodeSpecialChr(wlan_secret);
	}

	if (smode == 1 || smode == 5 || smode == 8) {
		f.lan_wlan_security.value = 1;
		$("#lan_wlan_authtype").val(wepautype).selectbox();
	}

	if (smode == 10 || smode == 12 || smode == 11) {
		f.lan_wlan_security.value = 2;
		$("#lan_wlan_authtype").val(wepautype).selectbox();
	}

	if ((smode == 1) || (smode == 5) || (smode == 8) || (smode == 10) || (smode == 11) || (smode == 12)) {
		numx = wireless_wep_selection;
		if ((numx == 1) || (numx == 2) || (numx == 3) || (numx == 4)) {
			numx--;
			f.lan_wlan_encryption_A.value = decodeSpecialChr(wireless_wep_key_1);
		}
	}

	Disable_wirless("upload");
	var selectSchedule = document.getElementById("pf_Schedule");
	for (var i = 0; i < maxScheduleRule; i++) {
		if (ScheduleList[i] != "")
			selectSchedule.options.add(new Option(ScheduleList[i], ScheduleList[i]));
	}
	selectSchedule.value = sch;
	$("#pf_Schedule").selectbox();
	$("#cipher_type").selectbox();
}

function Disable_wirless(tmp) {
	var f = document.getElementById("wifi_form");
	point_control(tmp, 0);
	if (f.status_24_ck.checked) {
		document.getElementById("sssid").disabled = false;
	} else {
		document.getElementById("sssid").disabled = true;
		document.getElementById("wifi_enable_24").disabled = true;
		document.getElementById("hide_24").disabled = true;
		document.getElementById("wmm_24").disabled = true;
	}
}

function changeSecurity(ssidindex) {
	var f = document.getElementById("wifi_form");

	if (f.lan_wlan_security.value == 0) {
		if (confirm(_change_security_info) == true)
			smode = 0;
		else
			security_type();
	}

	if (f.lan_wlan_security.value == 1) {
		if (parseInt(mode_802) == 6) {
			alert(_error_wepand802_chance);
			security_type();
			return false;
		}
		smode = 1;
	}

	if (f.lan_wlan_security.value == 2) {
		if (parseInt(mode_802) == 6) {
			alert(_error_wepand802_chance);
			security_type();
			return false;
		}

		smode = 10;
	}

	if (f.lan_wlan_security.value == 3)
		smode = 6;
	if (f.lan_wlan_security.value == 4)
		smode = 7;
	if (f.lan_wlan_security.value == 5)
		smode = 9;

	f.wirelessesavecfgflag.value = 0;
	f.WirelessSecuritytypeFlag.value = 1;
	f.WirelessSSIDChangeFlag.value = 0;
	f.wirelesseEnablessidflag.value = 0;
	f.wirelessewpswificfg.value = 0;
	f.wirelessehiddenssidflag.value = 0;
	f.wirelessewmmstatusflag.value = 0;
	f.Wirelesswepkeyflag.value = 0;
	f.WirelessSecuritytypeValue.value = 0;
	f.closewpsflag.value = 0;
	f.resetuncfgwpsenablecfg.value = 0;
	f.wpsclosesetactivestatusflag.value = 0;
	f.wirelesstotalstatusflag.value = 0;
	f.savecfg.value = 0;
	f.autochancecheckflag.value = 0;
	f.conexistencecheckflag.value = 0;
	f.wirelesssgiflag.value = 0;
	f.wirelessptflag.value = 0;

	initWireless_page();
}

function security_type() {
	var f = document.getElementById("wifi_form");
	if (wireless_authtype == "OPEN")
		f.lan_wlan_security.value = 0;
	else if (decodeSpecialChr(wireless_authtype) == "WEP-64Bits")
		f.lan_wlan_security.value = 1;
	else if (decodeSpecialChr(wireless_authtype) == "WEP-128Bits")
		f.lan_wlan_security.value = 2;
	else if (wireless_authtype == "WPAPSK" || wireless_authtype == "WPA")
		f.lan_wlan_security.value = 3;
	else if (wireless_authtype == "WPA2PSK" || wireless_authtype == "WPA2")
		f.lan_wlan_security.value = 4;
	else if (wireless_authtype == "WPAPSKWPA2PSK" || wireless_authtype == "WPA1WPA2")
		f.lan_wlan_security.value = 5;
}

function checkSSID_ac(name, id) {
	for (var i = 0; i < dataLists_ac.length; i++) {
		if (dataLists_ac[i][0] == 1) {
			if (id != i) {
				if (name == dataLists_ac[i][1])
					return false;
			}
		}
	}
	return true;
}

function checkSSID(name, id) {
	for (var i = 0; i < dataLists.length; i++) {
		if (dataLists[i][0] == 1) {
			if (id != i) {
				if (name == dataLists[i][1])
					return false;
			}
		}
	}
	return true;
}

function isSSIDInvalid(source) {
	var sourcestr = new String(source);
	var tempstr;
	for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
		tempstr = sourcestr.substr(strposition, 1);
		if (tempstr.charCodeAt(0) == 45 || tempstr.charCodeAt(0) == 95 || tempstr.charCodeAt(0) == 46 || tempstr.charCodeAt(0) == 64 || (tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
			continue;
		else
			return true;
	}
	return false;
}

function doSave(num) {
	var wps_error_2_flag = 0;
	var wps_error_flag = 0;
	var wps_error_1_flag = 0;
	var wps_error_3_flag = 0;
	var _wps_error_flag = 0;
	var wps_error_4_flag = 0;
	$("label[class='error']").html("");
	var f = document.getElementById("wifi_form");

	if (f.bgMode.value == "6") {
		if (f.lan_wlan_security.value == 1 || f.lan_wlan_security.value == 2) {
			alert(m_wifi_waringwep);
			return false;
		}
		if (f.lan_wlan_security.value == 3 || f.lan_wlan_security.value == 5) {
			alert(m_wifi_wpatkip);
			return false;
		}
	}
	if (f.bgMode.value == "6" || f.bgMode.value == "7" || f.bgMode.value == "9") {
		if (f.wmm_24_ck.checked == false) {
			alert(m_wifi_waringwmm);
			return false;
		}
	}

	if (!checkparameter())
		return false;
	else {
		if (f.lan_wlan_security.value == 0) {
			f.WirelessSecuritytypeFlag.value = 2;
			f.WirelessSecuritytypeValue.value = "OPEN";
		} else if (f.lan_wlan_security.value == 1 || f.lan_wlan_security.value == 2) {
			if (f.lan_wlan_security.value == 1) {
				f.WirelessSecuritytypeValue.value = "WEP-64Bits";
			} else if (f.lan_wlan_security.value == 2) {
				f.WirelessSecuritytypeValue.value = "WEP-128Bits";
			}
			f.WirelessSecuritytypeFlag.value = 3;
			f.Wirelesswepkeyflag.value = 1;

		} else if (f.lan_wlan_security.value == 3 || f.lan_wlan_security.value == 4 || f.lan_wlan_security.value == 5) {
			if (f.lan_wlan_security.value == 3) {
				if (document.getElementById('wpatype_8021x').getAttribute('class') == 'clicked') {
					f.WirelessSecuritytypeFlag.value = 4;
					f.WirelessSecuritytypeValue.value = "WPA";

				} else {
					f.WirelessSecuritytypeFlag.value = 5;
					f.WirelessSecuritytypeValue.value = "WPAPSK";
				}
			}

			if (f.lan_wlan_security.value == 4) {
				if (document.getElementById('wpatype_8021x').getAttribute('class') == 'clicked') {
					f.WirelessSecuritytypeFlag.value = 4;
					f.WirelessSecuritytypeValue.value = "WPA2";
				} else {
					f.WirelessSecuritytypeFlag.value = 5;
					f.WirelessSecuritytypeValue.value = "WPA2PSK";
				}
			}
			if (f.lan_wlan_security.value == 5) {
				if (document.getElementById('wpatype_8021x').getAttribute('class') == 'clicked') {
					f.WirelessSecuritytypeFlag.value = 4;
					f.WirelessSecuritytypeValue.value = "WPA1WPA2";
				} else {
					f.WirelessSecuritytypeFlag.value = 5;
					f.WirelessSecuritytypeValue.value = "WPAPSKWPA2PSK";
				}
			}
		}
	}

	if (!checkparameter_ac())
		return false;
	else {
		if (f.lan_wlan_security_ac.value == 0) {
			f.WirelessSecuritytypeFlag_ac.value = 2;
			f.WirelessSecuritytypeValue_ac.value = "OPEN";
		} else if (f.lan_wlan_security_ac.value == 1 || f.lan_wlan_security_ac.value == 2) {
			if (f.lan_wlan_security_ac.value == 1) {
				f.WirelessSecuritytypeValue_ac.value = "WEP-64Bits";
			} else if (f.lan_wlan_security_ac.value == 2) {
				f.WirelessSecuritytypeValue_ac.value = "WEP-128Bits";
			}
			f.WirelessSecuritytypeFlag_ac.value = 3;

			f.Wirelesswepkeyflag_ac.value = 1;

		} else if (f.lan_wlan_security_ac.value == 3 || f.lan_wlan_security_ac.value == 4 || f.lan_wlan_security_ac.value == 5) {
			if (f.lan_wlan_security_ac.value == 3) {
				if (document.getElementById('wpatype_8021x_ac').getAttribute('class') == 'clicked') {
					f.WirelessSecuritytypeFlag_ac.value = 4;
					f.WirelessSecuritytypeValue_ac.value = "WPA";

				} else {
					f.WirelessSecuritytypeFlag_ac.value = 5;
					f.WirelessSecuritytypeValue_ac.value = "WPAPSK";
				}
			}

			if (f.lan_wlan_security_ac.value == 4) {
				if (document.getElementById('wpatype_8021x_ac').getAttribute('class') == 'clicked') {
					f.WirelessSecuritytypeFlag_ac.value = 4;
					f.WirelessSecuritytypeValue_ac.value = "WPA2";
				} else {
					f.WirelessSecuritytypeFlag_ac.value = 5;
					f.WirelessSecuritytypeValue_ac.value = "WPA2PSK";
				}
			}
			if (f.lan_wlan_security_ac.value == 5) {
				if (document.getElementById('wpatype_8021x_ac').getAttribute('class') == 'clicked') {
					f.WirelessSecuritytypeFlag_ac.value = 4;
					f.WirelessSecuritytypeValue_ac.value = "WPA1WPA2";
				} else {
					f.WirelessSecuritytypeFlag_ac.value = 5;
					f.WirelessSecuritytypeValue_ac.value = "WPAPSKWPA2PSK";
				}
			}
		}
	}

	if (f.status_24_ck.checked) {
		f.wirelesstotalstatusflag.value = 1;

		if (f.sssid.value.length < 3 || f.sssid.value.length > 32) {
			document.getElementById("ssid_error").innerHTML = "<br/>" + m_wifi_waringssid;
			return false;
		} else if (isSSIDInvalid(f.sssid.value)) {
			document.getElementById("ssid_error").innerHTML = "<br/>" + m_wifi_waringssid;
			return false;
		}
		if (checkSSID(f.sssid.value, 0) == false) {
			document.getElementById("ssid_error").innerHTML = "<br/>" + m_wifi_waringssid2;
			return false;
		}

		f.wirelesseEnablessidflag.value = 1;

		if (f.wifi_enable_24_ck.checked)
			f.wirelessewpswificfg.value = 1;
		else
			f.wirelessewpswificfg.value = 2;

		if (f.hide_24_ck.checked == false)
			f.wirelessehiddenssidflag.value = 1;
		else
			f.wirelessehiddenssidflag.value = 2;

		if (f.wmm_24_ck.checked == false)
			f.wirelessewmmstatusflag.value = 1;
		else
			f.wirelessewmmstatusflag.value = 2;

		if (f.closewpsflag.value == 0) {
			if (f.hide_24_ck.checked) {
				if (f.wifi_enable_24_ck.checked) {
					if (confirm(m_wifi_head + " " + m_wifi_24g + ": " + _wps_error_2)) {
						f.closewpsflag.value = 1;
						wps_error_2_flag = 1;
					} else
						return false;
				}
			} else {
				if (f.WirelessSecuritytypeValue.value == "WPA" || f.WirelessSecuritytypeValue.value == "WPA2" || f.WirelessSecuritytypeValue.value == "WPA1WPA2" || f.WirelessSecuritytypeValue.value == "WPAPSK" || f.WirelessSecuritytypeValue.value == "WEP-64Bits" || f.WirelessSecuritytypeValue.value == "WEP-128Bits") {
					if (f.wifi_enable_24_ck.checked) {
						if (confirm(m_wifi_head + " " + m_wifi_24g + ": " + _wps_error)) {
							f.closewpsflag.value = 1;
							wps_error_flag = 1;
						} else
							return false;
					}
				} else {
					if (f.WirelessSecuritytypeValue.value.indexOf("WPA") != -1) {
						if (f.cipher_type.value == "TKIP") {
							if (f.wifi_enable_24_ck.checked) {
								if (confirm(m_wifi_head + " " + m_wifi_24g + ": " + _wps_error_1)) {
									f.closewpsflag.value = 1;
									wps_error_1_flag = 1;
								} else
									return false;
							}
						}
					}
				}
			}
		} else if (f.closewpsflag.value == 2) {
			if (f.wifi_enable_24_ck.checked) {
				if (confirm(m_wifi_head + " " + m_wifi_24g + ": " + wps_error_3)) {
					f.WirelessSecuritytypeValue.value = "OPEN";
					f.wirelessehiddenssidflag.value = 1;
					wps_error_3_flag = 1;
				} else
					return false;
			}
		} else if (f.closewpsflag.value == 3) {
			if (f.wifi_enable_24_ck.checked) {
				if (f.WirelessSecuritytypeValue.value.indexOf("WPA") != -1 && document.getElementById('wpatype_8021x').getAttribute('class') == 'clicked') {
					if (confirm(m_wifi_head + " " + m_wifi_24g + ": " + _wps_error)) {
						f.closewpsflag.value = 1;
						_wps_error_flag = 1;
					} else
						return false;
				} else {
					if (confirm(m_wifi_head + " " + m_wifi_24g + ": " + wps_error_4)) {
						f.cipher_type.value = "AES";
						wps_error_4_flag = 1;
					} else
						return false;
				}
			}
		}
	}
	if (f.status_ac_ck.checked) {
		f.wirelesstotalstatusflag_ac.value = 1;

		if (f.sssid_ac.value.length < 3 || f.sssid_ac.value.length > 32) {
			document.getElementById("ssid_ac_error").innerHTML = "<br/>" + m_wifi_waringssid;
			return false;
		} else if (isSSIDInvalid(f.sssid_ac.value)) {
			document.getElementById("ssid_ac_error").innerHTML = "<br/>" + m_wifi_waringssid;
			return false;
		}
		if (checkSSID_ac(f.sssid_ac.value, 0) == false) {
			document.getElementById("ssid_ac_error").innerHTML = "<br/>" + m_wifi_waringssid2;
			return false;
		}

		f.wirelesseEnablessidflag_ac.value = 1;

		if (f.wifi_enable_ac_ck.checked)
			f.wirelessewpswificfg_ac.value = 1;
		else
			f.wirelessewpswificfg_ac.value = 2;

		if (f.hide_ac_ck.checked == false)
			f.wirelessehiddenssidflag_ac.value = 1;
		else
			f.wirelessehiddenssidflag_ac.value = 2;

		if (f.wmm_ac_ck.checked == false)
			f.wirelessewmmstatusflag_ac.value = 1;
		else
			f.wirelessewmmstatusflag_ac.value = 2;

		if (f.closewpsflag_ac.value == 0) {
			if (f.hide_ac_ck.checked) {
				if (f.wifi_enable_ac_ck.checked) {
					if (confirm(m_wifi_head + " " + m_wifi_5GHz + ": " + _wps_error_2))
						f.closewpsflag_ac.value = 1;
					else
						return false;
				}
			} else {
				if (f.WirelessSecuritytypeValue_ac.value == "WPA" || f.WirelessSecuritytypeValue_ac.value == "WPA2" || f.WirelessSecuritytypeValue_ac.value == "WPA1WPA2" || f.WirelessSecuritytypeValue_ac.value == "WPAPSK" || f.WirelessSecuritytypeValue_ac.value == "WEP-64Bits" || f.WirelessSecuritytypeValue_ac.value == "WEP-128Bits") {
					if (f.wifi_enable_ac_ck.checked) {
						if (confirm(m_wifi_head + " " + m_wifi_5GHz + ": " + _wps_error))
							f.closewpsflag_ac.value = 1;
						else
							return false;
					}
				} else {
					if (f.WirelessSecuritytypeValue_ac.value.indexOf("WPA") != -1) {
						if (f.cipher_type_ac.value == "TKIP") {
							if (f.wifi_enable_ac_ck.checked) {
								if (confirm(m_wifi_head + " " + m_wifi_5GHz + ": " + _wps_error_1))
									f.closewpsflag_ac.value = 1;
								else
									return false;
							}
						}
					}
				}
			}
		} else if (f.closewpsflag_ac.value == 2) {
			if (f.wifi_enable_ac_ck.checked) {
				if (confirm(m_wifi_head + " " + m_wifi_5GHz + ": " + wps_error_3)) {
					f.WirelessSecuritytypeValue_ac.value = "OPEN";
					f.wirelessehiddenssidflag_ac.value = 1;
				} else
					return false;
			}
		} else if (f.closewpsflag_ac.value == 3) {
			if (f.wifi_enable_ac_ck.checked) {
				if (f.WirelessSecuritytypeValue_ac.value.indexOf("WPA") != -1 && document.getElementById('wpatype_8021x_ac').getAttribute('class') == 'clicked') {
					if (confirm(m_wifi_head + " " + m_wifi_5GHz + ": " + _wps_error))
						f.closewpsflag_ac.value = 1;
					else
						return false;
				} else {
					if (confirm(m_wifi_head + " " + m_wifi_5GHz + ": " + wps_error_4))
						f.cipher_type_ac.value = "AES";
					else
						return false;
				}
			}
		}
	}

	if (checkParameter_adv() == false) {
		return false;
	} else {
		if ((f.bgMode.value == 1) || (f.bgMode.value == 4) || (f.bgMode.value == 0))
			f.Is11nMode.value = 0;
		else {
			f.Is11nMode.value = 1;
			if (f.sgi_ck.checked)
				f.wirelesssgiflag.value = 1;
			else
				f.wirelesssgiflag.value = 0;
		}
		if (f.checkbox_is_pt_ck.checked)
			f.wirelessptflag.value = 1;
		else
			f.wirelessptflag.value = 0;

		if (f.channelMode.value == 1)
			f.conexistencecheckflag.value = 1;

		else if (f.channelMode.value == 2)
			f.conexistencecheckflag.value = 0;
		else
			f.conexistencecheckflag.value = 1;
		if (f.channelMode.value == 2)
			f.channelMode.value = 1;

		f.savecfg.value = 1;
	}
	if (checkParameter_adv_ac() == false) {
		return;
	} else {
		if (f.bgMode_ac.value == 15)
			f.Is11nMode_ac.value = 1;
		else
			f.Is11nMode_ac.value = 0;
		if (f.bgMode_ac.value != 2) {
			if (f.sgi_ac_ck.checked)
				f.wirelesssgiflag_ac.value = 1;
			else
				f.wirelesssgiflag_ac.value = 0;
		}
		if (f.checkbox_is_pt_ac_ck.checked)
			f.wirelessptflag_ac.value = 1;
		else
			f.wirelessptflag_ac.value = 0;
		if (f.ieee_80211h_ck.checked)
			f.ieee_80211h_ac.value = 1;
		else
			f.ieee_80211h_ac.value = 0;

		f.savecfg_ac.value = 1;
	}

	f.wirelessesavecfgflag.value = 1;
	f.wirelessesavecfgflag_ac.value = 1;
	f.action = "WiFi_loding.asp?";

	$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sKey) {
		$("#sessionKey").val(sKey);
		document.getElementById("CreatePopAlertMessage").style.display = "inline";
		document.getElementById("waitSettingFinish").style.display = "inline";
		Start_reciprocal_Number_RestoreConfiguration();
		setTimeout('ajaxSubmit(document.getElementById("wifi_form"), function(){});', 300);
	});
}

function goIndex(n) {
	var f = document.getElementById("wifi_form");
	f.WirelessSSIDChangeFlag.value = 1;
	f.action = "WiFi.asp?";
	f.submit();
}

function showWEP() {
	var sctr = new String();
	sctr = "";

	sctr += "<tr>";
	sctr += "	<th>" + m_wifi_authtype + ": </th>";
	sctr += "	<td><div class=\"styled-select\"><select id='lan_wlan_authtype' name='lan_wlan_authtype'>";
	sctr += "		<option value='OpenSystem' >" + m_comm_open + "</option>";
	sctr += "		<option value='SharedKey' >" + m_comm_Shared + "</option>";
	sctr += "		</select></div><label id='lan_wlan_authtype_error' name='lan_wlan_authtype_error' class='error'></label>";
	sctr += "	</td>";
	sctr += "</tr>";

	$("#security_tbody").html(sctr);
}

function show24WEP_pwd() {
	var sctr = "<input id='text_encryption_A' type='text' name='lan_wlan_encryption_A' class='text' value='' maxlength='26' onkeypress=\"save_button_changed();\"/><label id='lan_wlan_encryption_A_error' name='lan_wlan_encryption_A_error' class='error'></label>";
	document.getElementById("sec24_password").innerHTML = sctr;
}

function showWPA(type) {
	var sctr = new String();
	sctr = "";
	sctr += "<tr>";
	sctr += "	<th><div class =\"title\">" + m_wifi_wpatype + "</div></th>";
	sctr += "	<td></td>";
	sctr += "</tr>";
	sctr += "<tr>";
	sctr += "	<td align=\"right\"><div id=\"wpatype_8021x\"  class=\"clicked\" onClick=\"checkWPA(0);\"></div></td>";
	sctr += "	<td> " + m_wifi_802x + "</td>";
	sctr += "</tr>";
	sctr += "<tr>";
	sctr += "	<td align=\"right\"><div id=\"wpatype_psk\"  class=\"unclick\" onClick=\"checkWPA(1);\"></div></td>";
	sctr += "	<td> " + m_wifi_psk + "</td>";
	sctr += "</tr>";

	sctr += "<tr class='ShowWPA1' style='display:none'>";
	sctr += "	<th><div class =\"title\">" + m_wifi_802x + "</div></th>";
	sctr += "	<td></td>";
	sctr += "</tr>";
	sctr += "<tr class='ShowWPA1' style='display:none'>";
	sctr += "	<th>" + m_wifi_serverip + ":</th>";
	sctr += "	<td><input id=\"text_serverip_0\" type=\"text\" name=\"lan_wlan_serverip\" class=\"text\" value=\"\" ></td>";
	sctr += "</tr>";
	sctr += "<tr class='ShowWPA1' style='display:none'>";
	sctr += "	<th>" + m_comm_Port + ": </th>";
	sctr += "	<td><input id=\"text_port_0\" type=\"text\" name=\"lan_wlan_port\" class=\"text\" value=\"\" ></td>";
	sctr += "</tr>";
	sctr += "<tr class='ShowWPA1' style='display:none'>";
	sctr += "	<th>" + m_comm_Secret + ": </th>";
	sctr += "	<td><input id=\"text_secret_0\" type=\"text\" name=\"lan_wlan_secret\" class=\"text\" value=\"\" ></td>";
	sctr += "</tr>";

	sctr += "<tr>";
	sctr += "	<th>" + m_wifi_ciphertype + " : </th>";
	sctr += "	<td><div class=\"styled-select\"><select id=\"cipher_type\"  name=\"cipher_type\">";

	if (type == "wpa") {
		if (mode_802 != "6")
			sctr += "<option value=\"TKIP\" >" + m_wifi_TKIP + "</option>";
		sctr += "<option value=\"TKIPAES\" >" + m_comm_Both + "</option>";
	} else if (type == "wpa2") {
		sctr += "<option value=\"AES\" >" + m_wifi_AES + "</option>";
		// sctr += "<option value=\"TKIPAES\" >" + m_comm_Both + "</option>";
	} else {
		if (mode_802 != "6")
			sctr += "<option value=\"TKIP\" >" + m_wifi_TKIP + "</option>";
		sctr += "<option value=\"AES\" >" + m_wifi_AES + "</option>";
		sctr += "<option value=\"TKIPAES\" >" + m_wifi_AES + "/" + m_wifi_TKIP + "</option>";
	}

	sctr += "</select></div><label id='cipher_type_error' name='cipher_type_error' class='error'></label></td>";
	sctr += "</tr>";

	sctr += "<tr>";
	sctr += "	<th>" + m_wifi_groupkey + " : </th>";
	sctr += "	<td><input id=\"text_groupkeyinterval_0\" type=\"text\" name=\"lan_wlan_groupkeyinterval\" class=\"text\" value=\"\" />Seconds<label id='lan_wlan_groupkeyinterval_error' name='lan_wlan_groupkeyinterval_error' class='error'></label>";
	sctr += "	</td>";
	sctr += "</tr>";

	$("#security_tbody").html(sctr);
}

function show24WPA_pwd() {
	var sctr = "<input id=\"text_string_0\" type=\"text\" name=\"lan_wlan_string\" class=\"text\" value=\"\" onkeypress=\"save_button_changed();\"><label id='lan_wlan_string_error' name='lan_wlan_string_error' class='error'></label>";
	document.getElementById("sec24_password").innerHTML = sctr;
}

function show24WPA_defPwd() {
	var sctr = "<input id=\"sec24_def_column\" type=\"text\" name=\"sec24_def_column\" class=\"text\" value=\"\" disabled>";
	document.getElementById("sec24_password").innerHTML = sctr;
}

function checkWPA(arg) {
	f = document.getElementById("wifi_form");
	if (arg == 0) {
		document.getElementById('wpatype_8021x').setAttribute("class", "clicked");
		document.getElementById('wpatype_psk').setAttribute("class", "unclick");
	} else {
		document.getElementById('wpatype_8021x').setAttribute("class", "unclick");
		document.getElementById('wpatype_psk').setAttribute("class", "clicked");
	}
	switch (parseInt(arg)) {
		case 0:
			$(".ShowWPA1").show();
			show24WPA_defPwd();
			f.lan_wlan_groupkeyinterval.value = groupkey;
			f.lan_wlan_serverip.value = serverip;
			f.lan_wlan_port.value = wlan_port;
			f.lan_wlan_secret.value = decodeSpecialChr(wlan_secret);
			break;
		case 1:
			$(".ShowWPA1").hide();
			show24WPA_pwd();
			f.lan_wlan_string.value = wpapsk;
			$("#cipher_type").val("TKIPAES");
			$("#cipher_type").selectbox('change', $("#cipher_type").val(), $("#cipher_type").find('option:selected').text());
			break;
		default:
			break;
	}
	save_button_changed();
}

function checkkey(arg) {
	if (arg == 0) {
		document.getElementById("radio_encryptionselection_A").setAttribute("class", "clicked");
		document.getElementById("radio_encryptionselection_B").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_C").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_D").setAttribute("class", "unclick");
	} else if (arg == 1) {
		document.getElementById("radio_encryptionselection_A").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_B").setAttribute("class", "clicked");
		document.getElementById("radio_encryptionselection_C").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_D").setAttribute("class", "unclick");
	} else if (arg == 2) {
		document.getElementById("radio_encryptionselection_A").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_B").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_C").setAttribute("class", "clicked");
		document.getElementById("radio_encryptionselection_D").setAttribute("class", "unclick");
	} else if (arg == 3) {
		document.getElementById("radio_encryptionselection_A").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_B").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_C").setAttribute("class", "unclick");
		document.getElementById("radio_encryptionselection_D").setAttribute("class", "clicked");
	}
}


function showWPA1() {
	var sctr = "";

	sctr += "<tr>";
	sctr += "		<th><div class =\"title\">" + m_wifi_802x + "</div></th>";
	sctr += "		<td></td>";
	sctr += "</tr>";
	sctr += "		<tr>";
	sctr += "			<th>" + m_wifi_serverip + ":</th>";
	sctr += "			<td><input id=\"text_serverip_0\" type=\"text\" name=\"lan_wlan_serverip\" class=\"text\" value=\"\" ></td>";
	sctr += "		</tr>";
	sctr += "		<tr>";
	sctr += "			<th>" + m_comm_Port + ": </th>";
	sctr += "			<td><input id=\"text_port_0\" type=\"text\" name=\"lan_wlan_port\" class=\"text\" value=\"\" ></td>";
	sctr += "		</tr>";
	sctr += "		<tr>";
	sctr += "			<th>" + m_comm_Secret + ": </th>";
	sctr += "			<td><input id=\"text_secret_0\" type=\"text\" name=\"lan_wlan_secret\" class=\"text\" value=\"\" ></td>";
	sctr += "		</tr>";

	document.write(sctr);
}

function showWPA2() {
	var sctr = "";

	sctr += "<tr>";
	sctr += "		<th><div class =\"title\">" + m_wifi_pskhex + "</div></th>";
	sctr += "		<td></td>";
	sctr += "</tr>";
	sctr += "		<tr>";
	sctr += "			<th>" + m_wifi_hexvalue + ":</th>";
	sctr += "			<td><input id=\"text_hex_0\" type=\"text\" name=\"lan_wlan_hex\" class=\"text\" value=\"\" ></td>";
	sctr += "		</tr>";

	return sctr;
}

function showWPA3() {
	var sctr = "";
	sctr += "<tr>";
	sctr += "	<th><div class =\"title\">" + m_wifi_PSK2 + "</div></th>";
	sctr += "	<td></td>";
	sctr += "</tr>";
	sctr += "<tr>";
	sctr += "	<th>" + m_wifi_psknetworkkey + ": </th>";
	sctr += "	<td><input id=\"text_string_0\" type=\"text\" name=\"lan_wlan_string\" class=\"text\" value=\"\" maxlength=\"64\"></td>";
	sctr += "</tr>";
	prints(sctr);
}


function isHex(cmpStr) {
	var regStr = /[a-fA-F0-9]/;
	for (i = 0; i < cmpStr.length; i++) {
		if (cmpStr.charAt(i).search(regStr) == -1)
			return false;
	}
	return true;
}

function MathandAbs(ip) {
	var sIP = ip.split(".");
	absip = Math.abs(sIP[0]) + "." + Math.abs(sIP[1]) + "." + Math.abs(sIP[2]) + "." + Math.abs(sIP[3]);
	return absip;
}

function checkIP(ip) {
	var sIP = MathandAbs(ip).split(".");
	if (sIP.length != 4) return false;
	for (var i = 0; i < sIP.length; i++) {
		if (!isNumber(sIP[i])) return false;
		if (i == 0) {
			if (parseInt(sIP[i]) < 1 || parseInt(sIP[i]) > 223 || parseInt(sIP[i]) == 127)
				return false;
		}
		if (i == 1 || i == 2) {
			if (parseInt(sIP[i]) < 0 || parseInt(sIP[i]) > 255)
				return false;
		}
		if (i == 3) {
			if (parseInt(sIP[i]) < 1 || parseInt(sIP[i]) > 254)
				return false;
		}
	}
	return true;
}

function checkparameter() {
	var f = document.getElementById("wifi_form");

	if (f.lan_wlan_security.value == 0)
		return true;

	if (f.lan_wlan_security.value == 1) {
		if (f.lan_wlan_encryption_A.value.length == 5) {
			if (!check_key("lan_wlan_encryption_A", 64, 1)) {
				$("#lan_wlan_encryption_A_error").html("<br/>" + _lan_wlan_encryption_ASCII_1_error + msg_length + _lan_wlan_encryption_ASCII_error);
				f.lan_wlan_encryption_A.focus();
				f.lan_wlan_encryption_A.select();
				return false;
			}
		} else if (f.lan_wlan_encryption_A.value.length == 10) {
			if (!check_key("lan_wlan_encryption_A", 64, 2)) {
				$("#lan_wlan_encryption_A_error").html("<br/>" + _lan_wlan_encryption_hex_1_error + msg_length + _lan_wlan_encryption_hex_error);
				f.lan_wlan_encryption_A.focus();
				f.lan_wlan_encryption_A.select();
				return false;
			}
		} else {
			$("#lan_wlan_encryption_A_error").html("<br/>" + _wlan_conn_wizard_network_error);
			f.lan_wlan_encryption_A.focus();
			f.lan_wlan_encryption_A.select();
			return false;
		}
	}

	if (f.lan_wlan_security.value == 2) {
		if (f.lan_wlan_encryption_A.value.length == 13) {
			if (!check_key("lan_wlan_encryption_A", 128, 1)) {
				$("#lan_wlan_encryption_A_error").html("<br/>" + _lan_wlan_encryption_ASCII_1_error + msg_length + _lan_wlan_encryption_ASCII_error);
				f.lan_wlan_encryption_A.focus();
				f.lan_wlan_encryption_A.select();
				return false;
			}
		} else if (f.lan_wlan_encryption_A.value.length == 26) {
			if (!check_key("lan_wlan_encryption_A", 128, 2)) {
				$("#lan_wlan_encryption_A_error").html("<br/>" + _lan_wlan_encryption_hex_1_error + msg_length + _lan_wlan_encryption_hex_error);
				f.lan_wlan_encryption_A.focus();
				f.lan_wlan_encryption_A.select();
				return false;
			}
		} else {
			$("#lan_wlan_encryption_A_error").html("<br/>" + _wlan_conn_wizard_network_error);
			f.lan_wlan_encryption_A.focus();
			f.lan_wlan_encryption_A.select();
			return false;
		}
	}

	if ((f.lan_wlan_security.value == 5) || (f.lan_wlan_security.value == 3) || (f.lan_wlan_security.value == 4)) {
		if ((parseInt(f.lan_wlan_groupkeyinterval.value) < 10) || (parseInt(f.lan_wlan_groupkeyinterval.value) > 4194303) || (!isNumber(f.lan_wlan_groupkeyinterval.value))) {
			$("#lan_wlan_groupkeyinterval_error").html("<br/>" + _lan_wlan_groupkeyinterval_error);
			f.lan_wlan_groupkeyinterval.focus();
			f.lan_wlan_groupkeyinterval.select();
			return false;
		}

		if (document.getElementById('wpatype_8021x').getAttribute('class') == 'clicked') {
			if (!checkIP(f.lan_wlan_serverip.value)) {
				$("#lan_wlan_serverip_error").html("<br/>" + _lan_wlan_serverip_error);
				f.lan_wlan_serverip.focus();
				f.lan_wlan_serverip.select();
				return false;
			}

			if ((f.lan_wlan_port.value < 1) || (f.lan_wlan_port.value > 65535) || (!isNumber(f.lan_wlan_port.value))) {
				$("#lan_wlan_port_error").html("<br/>" + _lan_wlan_port_error);
				f.lan_wlan_port.focus();
				f.lan_wlan_port.select();
				return false;
			}

			if (f.lan_wlan_secret.value.length > 64) {
				$("#lan_wlan_secret_error").html("<br/>" + _lan_wlan_sec_error);
				f.lan_wlan_secret.focus();
				f.lan_wlan_secret.select();
				return false;
			}
		} else if (document.getElementById('wpatype_psk').getAttribute('class') == 'clicked') {
			if ((f.lan_wlan_string.value.length < 8) || (f.lan_wlan_string.value.length > 63) || (isWPAKeyInvalid(f.lan_wlan_string.value))) {

				if (f.lan_wlan_security.value == 3)
					$("#lan_wlan_string_error").html("<br/>" + _lan_wlan_string_errorA + "WPA-PSK" + _lan_wlan_string_errorB);

				if (f.lan_wlan_security.value == 4)
					$("#lan_wlan_string_error").html("<br/>" + _lan_wlan_string_errorA + "WPA2-PSK" + _lan_wlan_string_errorB);

				if (f.lan_wlan_security.value == 5)
					$("#lan_wlan_string_error").html("<br/>" + _lan_wlan_string_errorA + "WPA/WPA2-PSK" + _lan_wlan_string_errorB);
				f.lan_wlan_string.focus();
				f.lan_wlan_string.select();
				return false;
			}

			if (strchk_unicode(f.lan_wlan_string.value)) {
				$("#lan_wlan_string_error").html("<br/>" + _lan_wlan_string_errorC);
				f.lan_wlan_string.focus();
				f.lan_wlan_string.select();
				return false;
			}
		}
	}
	return true;
}

function isWPAKey16Invalid(pskstr) {
	var str = "0123456789abcedfABCDEF";
	for (var i = 0; i < pskstr.length; i++) {
		var j = 0;
		for (var z = 0; z < str.length; z++) {
			if (pskstr.charAt(i) == str.charAt(z))
				j++;
		}
		if (j == 0)
			return true;
	}
	return false;
}

function isWPAKeyInvalid(source) {
	var sourcestr = new String(source);
	var tempstr;
	if (sourcestr == "")
		return false;
	for (var strposition = 0; strposition <= sourcestr.length - 1; strposition++) {
		tempstr = sourcestr.substr(strposition, 1);
		if ((tempstr.charCodeAt(0) >= 48 && tempstr.charCodeAt(0) <= 57) || (tempstr.charCodeAt(0) >= 65 && tempstr.charCodeAt(0) <= 90) || (tempstr.charCodeAt(0) >= 97 && tempstr.charCodeAt(0) <= 122))
			continue;
		else
			return true;
	}
	return false;
}

function Prefixes_Rule(TelNum) {
	for (var i = 0; i < TelNum.length; i++) {
		if (TelNum.charAt(i) == '\"') return false;
		if (TelNum.charAt(i) == ' ') return false;
		if (TelNum.charAt(i) == '\\') return false;
		if (TelNum.charAt(i) == '%') return false;
	}
	return true;
}

function Prefixes_Rule_WEP_KEY(TelNum) {
	for (var i = 0; i < TelNum.length; i++) {
		if (TelNum.charAt(i) == '\"') return false;
		if (TelNum.charAt(i) == ' ') return false;
		if (TelNum.charAt(i) == '\\') return false;
		if (TelNum.charAt(i) == '%') return false;
		if (TelNum.charAt(i) == '#') return false;
	}
	return true;
}

function check_key(lan_wlan_encryption, lan_wlan_cipher, lan_wlan_type) {
	var f = document.getElementById("wifi_form");
	var keyvalue = eval("f." + lan_wlan_encryption + ".value");
	var keylength = parseInt(lan_wlan_cipher);
	var keytype = parseInt(lan_wlan_type);
	var ascii_length = (keylength / 8) - 3;
	var hex_length = ascii_length * 2;

	if (keytype == 1)
		my_length = ascii_length;
	else
		my_length = hex_length;

	msg_length = my_length;

	if (keytype == 1) {
		if (!Prefixes_Rule_WEP_KEY(keyvalue))
			return false;
	}

	if (keytype != 1) {
		if (!isHex(keyvalue))
			return false;
	}

	if ((keytype == 1) && (keyvalue == 0))
		return false;

	if ((keyvalue.length != my_length && keyvalue != ""))
		return false;

	return true;
}

function isIP(ip) {
	var sIP = ip.split(".");
	if (sIP.length != 4) return false;
	for (var i = 0; i < sIP.length; i++) {
		if (!isNumber(sIP[i])) return false;
		if (parseInt(sIP[i]) < 0 || parseInt(sIP[i]) > 255) return false;
	}
	return true;
}

function isNumber(n) {
	if (n.length == 0) return false;
	for (var i = 0; i < n.length; i++) {
		if (n.charAt(i) < '0' || n.charAt(i) > '9') return false;
	}
	return true;
}

function subHtmAsc(str) {
	var regStr = /(#|%|&|\+|\/|:|;|<|=|>|\?|@|\ )+/;
	var rntStr = "";

	if (str.search(regStr) == -1)
		return str;

	for (var i = 0; i < str.length; i++) {
		rntStr += checkHtmChar(str.charAt(i))
	}
	return rntStr;
}

function checkDataListsCount() {
	var count = 0;
	for (var i = 0; i < Wlanlist.length; i++) {
		if (Wlanlist[i][2].length) {
			count = Wlanlist.length;
			break;
		}
	}
	return count;
}

function point_control(temp, arg) {
	var f = document.getElementById("wifi_form");
	if (arg == 1)
		return;

	if (temp == "upload") {
		if (smode == 0)
			f.WirelessSecuritytypeValue.value = "OPEN";
		else if (smode == 1 || smode == 5 || smode == 8)
			f.WirelessSecuritytypeValue.value = "WEP-64Bits";
		else if (smode == 10 || smode == 11 || smode == 12)
			f.WirelessSecuritytypeValue.value = "WEP-128Bits";
		else if (smode == 6)
			f.WirelessSecuritytypeValue.value = "WPAPSK";
		else if (smode == 7)
			f.WirelessSecuritytypeValue.value = "WPA2PSK";
		else if (smode == 9)
			f.WirelessSecuritytypeValue.value = "WPAPSKWPA2PSK";
		else if (smode == 2)
			f.WirelessSecuritytypeValue.value = "WPA";
		else if (smode == 3)
			f.WirelessSecuritytypeValue.value = "WPA2";
		else if (smode == 4)
			f.WirelessSecuritytypeValue.value = "WPA1WPA2";
	} else {
		if (f.lan_wlan_security.value == 0)
			f.WirelessSecuritytypeValue.value = "OPEN";
		else if (f.lan_wlan_security.value == 1)
			f.WirelessSecuritytypeValue.value = "WEP-64Bits";
		else if (f.lan_wlan_security.value == 2)
			f.WirelessSecuritytypeValue.value = "WEP-128Bits";
		else {
			if (f.lan_wlan_security.value == 3) {
				if (document.getElementById('wpatype_8021x').getAttribute('class') == 'clicked')
					f.WirelessSecuritytypeValue.value = "WPA";
				else
					f.WirelessSecuritytypeValue.value = "WPAPSK";
			}
			if (f.lan_wlan_security.value == 4) {
				if (document.getElementById('wpatype_8021x').getAttribute('class') == 'clicked')
					f.WirelessSecuritytypeValue.value = "WPA2";
				else
					f.WirelessSecuritytypeValue.value = "WPA2PSK";
			}
			if (f.lan_wlan_security.value == 5) {
				if (document.getElementById('wpatype_8021x').getAttribute('class') == 'clicked')
					f.WirelessSecuritytypeValue.value = "WPA1WPA2";
				else
					f.WirelessSecuritytypeValue.value = "WPAPSKWPA2PSK";
			}
		}
	}

	document.getElementById("wifi_enable_24").disabled = false;
	document.getElementById("hide_24").disabled = false;
	if (mode_802 == "9" || mode_802 == "7" || mode_802 == "6")
		document.getElementById("wmm_24").disabled = false;
	else
		document.getElementById("wmm_24").disabled = false;
}

function save_newPIN() {
	var f = document.getElementById("wifi_form");
	if (confirm(_lan_wlan_wi_fi_confirm_newPIN) == true) {
		f.WpsGenerate.value = "1";
		f.submit();
	} else
		return;
}

function reset_defaultPIN() {
	if (confirm(_lan_wlan_wi_fi_confirm_defaultPIN) == true) {
		var str = "ad_wireless_setup.xgi?";
		str += "set/wireless/inf:1/wps/pin=";
		str += "&" + "EXE=wlan,1,1";
		self.location.href = str;
	} else
		return;
}

function reset_unconfigured() {
	var f = document.getElementById("wifi_form");
	if (confirm(_lan_wlan_wi_fi_confirm_unconfigured) == true) {
		if (f.closewpsflag.value == 2) {
			if (confirm(wps_error_3) == true) {
				f.resetuncfgwpsenablecfg.value = 1;
				f.WirelessSecuritytypeValue.value = "OPEN";
				f.wirelessehiddenssidflag.value = 1;
			} else
				return false;
		} else if (f.closewpsflag.value == 3) {
			if (confirm(wps_error_4) == true) {
				f.cipher_type.value = "AES";
				f.resetuncfgwpsenablecfg.value = 2;
			} else
				return false;
		}

		f.WpsOOB.value = 1;
		f.submit();
	} else
		return;
}

var AjaxReq = null;

function createRequest() {
	var request = null;
	try {
		request = new XMLHttpRequest();
	} catch (trymicrosoft) {
		try {
			request = new ActiveXObject("Msxml2.XMLHTTP");
		} catch (othermicrosoft) {
			try {
				request = new ActiveXObject("Microsoft.XMLHTTP");
			} catch (failed) {
				request = null;
			}
		}
	}
	if (request == null) alert("Error creating request object !");
	return request;
}

function send_request(url, callback) {
	if (AjaxReq == null) AjaxReq = createRequest();
	AjaxReq.open("GET", url, true);
	AjaxReq.onreadystatechange = callback;
	AjaxReq.send(null);
}

function wps_enable(temp) {
	var f = document.getElementById("wifi_form");
	if (temp == 1) {
		if (!f.status_24_ck.checked)
			return;
	}

	if (f.wifi_enable_24_ck.checked) {
		if (f.hide_24_ck.checked)
			f.closewpsflag.value = 2;
		else {
			if (f.WirelessSecuritytypeValue.value == "WPA" || f.WirelessSecuritytypeValue.value == "WPA2" || f.WirelessSecuritytypeValue.value == "WPA1WPA2" || f.WirelessSecuritytypeValue.value == "WPAPSK" || f.WirelessSecuritytypeValue.value == "WEP-64Bits" || f.WirelessSecuritytypeValue.value == "WEP-128Bits")
				f.closewpsflag.value = 2;
			else if (f.WirelessSecuritytypeValue.value == "WPA2PSK" || f.WirelessSecuritytypeValue.value == "WPAPSKWPA2PSK") {
				if (f.cipher_type.value == "TKIP")
					f.closewpsflag.value = 3;
			}
		}
	}
}

function callback_check_pbcstatus() {
	var f = document.getElementById("wifi_form");
	if (AjaxReq != null && AjaxReq.readyState == 4) {

		if (AjaxReq.responseText.indexOf("Pbc") != -1) {
			document.getElementById("CreatePopAlertMessage").style.display = "inline";
			document.getElementById("waitSettingFinish").style.display = "inline";
			Start_reciprocal_Number_RestoreConfiguration();
		}
	}
	if (AjaxReq != null) delete AjaxReq;
}

function pbcStart() {
	$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sKey) {
		document.getElementById("CreatePopAlertMessage").style.display = "inline";
		document.getElementById("pbcMessage").style.display = "inline";
		setTimeout(function() {
			$.post(
				"/cgi-bin/New_GUI/Set/pbcSet.asp", {
					sessionKey: sKey,
					WirelesswpscfgFlag: "1"
				},
				function(data) {
					if (data.indexOf("Pbc") != -1) {
						document.getElementById("CreatePopAlertMessage").style.display = "none";
						document.getElementById("pbcMessage").style.display = "none";
					}
				}
			);
		}, 300);
	});
}

function Load_HTML() {
	$("#header").load("header.asp");
}

function Initial() {
	initialMenu();
}

function ChangeBandStatus() {
	Disable_wirless('changestatus');
}

var _ReciprocalNumber = 15;

function Start_reciprocal_Number_RestoreConfiguration() {
	if (_ReciprocalNumber >= 0) {
		document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", "Sec");
		_ReciprocalNumber--;
		setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
	} else {
		document.getElementById("waitSettingFinish").style.display = "none";
		document.getElementById("SuccessSettings").style.display = "inline";
	}
}

function SetCheckBoxEnableFirefox(id, init, ckstatus) {
	var f = document.getElementById("wifi_form");
	if ((id != "status_24") && (id != "checkbox_is_accesspoint_0_p") && (id != "status_ac") && (id != "checkbox_is_accesspoint_0_p_ac")) {
		if ((id == "wifi_enable_24") || (id == "hide_24") || (id == "wmm_24")) {
			if (!f.status_24_ck.checked)
				return;
		}
		if ((id == "wifi_enable_ac") || (id == "hide_ac") || (id == "wmm_ac")) {
			if (!f.status_ac_ck.checked)
				return;
		}
	}
	if (id == "ieee_80211h") {
		if ((mode_802_ac == 14) || (mode_802_ac == 15))
			return;
	}
	var stren = m_comm_enable;
	var strdis = m_comm_disenable;
	SetCheckBox(id, stren, strdis, ckstatus, init);
}