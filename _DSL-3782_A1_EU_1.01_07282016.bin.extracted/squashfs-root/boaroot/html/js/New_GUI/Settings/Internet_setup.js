var InvalidIPv6AddrList = ["0:0:0:0:0:0:0:0", "0:0:0:0:0:0:0:1", "FF00:0:0:0:0:0:0:0", "FF01:0:0:0:0:0:0:1", "FF02:0:0:0:0:0:0:1", "FF01:0:0:0:0:0:0:2", "FF02:0:0:0:0:0:0:2", "FF05:0:0:0:0:0:0:2"];
var tmpnum = 0;
function doSubmit() {
	
	var f = document.getElementById("wan_form");
	f.submitWANType.value = '';
	f.ethchangepvcindex.value= "1";
	if(isIPv6Supported=="Yes") {
		if(ipv6status=="IPv4/IPv6")
			f.isIPv4ipv6Supported.value="1";
	}
	$.get("/cgi-bin/get/New_GUI/get_sessionKey.asp", function(sessionKey){		
		$("#sessionKey").val(sessionKey);
		setTimeout(function(){
			if(f.connType.value == 1)
			{
				f.adsl_mss.value = parseInt(f.dynamic_mtu.value) - 40;
				doSubmitDynamic();
			}
			if(f.connType.value == 2)
			{
				f.adsl_mss.value = parseInt(f.static_mtu.value) - 40;
				doSubmitStatic();
			}
			if(f.connType.value == 3)
			{
				f.adsl_mss.value = parseInt(f.pppoe_mtu.value) - 40;
				doSubmitPPPOE();
			}
			if(f.connType.value == 4)
			{
				f.adsl_mss.value = parseInt(f.pppoa_mtu.value) - 40;
				doSubmitPPPOA();
			}
			if(f.connType.value == 5)
				doSubmitBridge();
		}, 300);
		
	});
	
					
}

function doSubmitTYPE() {
	var f = document.getElementById("wan_form");

	$("label[class='error']").html("");
	if(f.uiViewConState_ck.checked) {
		if(f.vlanid.value != "") {
			if(!isNumber(f.vlanid.value) || (parseInt(f.vlanid.value)<1)|| (parseInt(f.vlanid.value)>4094)) {
				$("#vlanid_error").html("<br/>"+m_internet_alertvalanid);
				f.vlanid.focus();
				f.vlanid.select();
				return false;
			} else {
				if(parseInt(f.vlanid.value) == 0)
					f.vlanid_switch.value = "No";
				else
					f.vlanid_switch.value = "Yes";
			}
		} else
			f.vlanid_switch.value = "No";
	}
	
	if(f.connType.value == 1)
		if(!checkparameterDynamic())
			return false;
	if(f.connType.value == 2)
		if(!checkparameterStatic())
			return false;
	if(f.connType.value == 3)
		if(!checkparameterPPPOE())
			return false;
	if(f.connType.value == 4)
		if(!checkparameterPPPOA())
			return false;
	if(f.connType.value == 5)
		if(!checkparameterBridge())
			return false;
	
	if(f.wanType.value == 3)
	{
		f.action = "Internet_auto_jump.asp";
		f.isPage.value = 0;
	}
	else if(f.wanType.value == 4)
	{
		f.action = "Internet_auto_loading.asp";
		f.isPage.value = 1;
	}
	else if(f.wanType.value == 0)
	{
		f.action = "Internet_adsl_loading.asp";
		f.isPage.value = 2;
	}	
	//else if(f.wanType[3].checked == true)
	//	f.action = "sp_wan_setup_eth.asp";
    	else
	{
		f.action = "Internet_3g_loading.asp";
		f.isPage.value = 4;
    	}
	f.submitWANType.value = 'apply';
	f.isType.value = 0;
	document.getElementById("CreatePopAlertMessage").style.display = "inline";
	document.getElementById("waitSettingFinish").style.display = "inline";
	Start_reciprocal_Number_RestoreConfiguration();
	setTimeout('ajaxSubmit(document.getElementById("wan_form"), function(){doSubmit();});', 300);
	//f.submit();
}

function doSubmitDynamic() {
	var f = document.getElementById("wan_form");

		if(f.uiViewConState_ck.checked == true)
			f.uiViewConState_ck.value = "Yes";
		else
			f.uiViewConState_ck.value = "No";
		if(f.dynamic_PPPoEPassthrough_ck.checked == true)
			f.dynamic_PPPoEPassthrough_tmp.value = "Yes";
		else
			f.dynamic_PPPoEPassthrough_tmp.value = "No";
		if(f.dynamic_nat_ck.checked == true)
			f.dynamic_nat_tmp.value= "Enable";
		else
			f.dynamic_nat_tmp.value= "Disabled";
		f.action = "Internet_adsl_loading.asp";
		f.submitType.value = 'apply';
		f.isType.value = 1;
		f.isPage.value = 2;
		setTimeout('ajaxSubmit(document.getElementById("wan_form"), function(){});', 300);
		
}

function doSubmitStatic() {
	var f = document.getElementById("wan_form");

		if(f.uiViewConState_ck.checked == true)
			f.uiViewConState_ck.value = "Yes";
		else
			f.uiViewConState_ck.value = "No";
		if(f.static_nat_ck.checked == true)
			f.static_nat_tmp.value= "Enable";
		else
			f.static_nat_tmp.value= "Disabled";
		if((f.static_uiViewEncaps.value == "1483 Bridged IP LLC") ||(f.static_uiViewEncaps.value == "1483 Bridged IP VC-Mux")) {
		      f.pppoe_save_flag.value = "1";
			if(f.static_PPPoEPassthrough_ck.checked == true)
				f.static_PPPoEPassthrough_tmp.value = "Yes";
			else
				f.static_PPPoEPassthrough_tmp.value = "No";
		}
		f.action = "Internet_adsl_loading.asp";
		f.submitType.value = 'apply';
		f.isType.value = 1;
		f.isPage.value = 2;
		setTimeout('ajaxSubmit(document.getElementById("wan_form"), function(){});', 300);
}

function doSubmitPPPOE() {
	var f = document.getElementById("wan_form");
	
		if(f.uiViewConState_ck.checked == true)
			f.uiViewConState_ck.value = "Yes";
		else
			f.uiViewConState_ck.value = "No";
		if(f.pppoe_nat_ck.checked == true)
			f.pppoe_nat_tmp.value= "Enable";
		else
			f.pppoe_nat_tmp.value= "Disabled";
		if(f.pppoe_PPPoEPassthrough_ck.checked == true)
			f.pppoe_PPPoEPassthrough_tmp.value = "Yes";
		else
			f.pppoe_PPPoEPassthrough_tmp.value = "No";
		f.action = "Internet_adsl_loading.asp";
		f.submitType.value = 'apply';
		f.isType.value = 1;
		f.isPage.value = 2;
		setTimeout('ajaxSubmit(document.getElementById("wan_form"), function(){});', 300);
}

function doSubmitPPPOA() {
	var f = document.getElementById("wan_form");
	
		if(f.uiViewConState_ck.checked == true)
			f.uiViewConState_ck.value = "Yes";
		else
			f.uiViewConState_ck.value = "No";
		if(f.pppoa_nat_ck.checked == true)
			f.pppoa_nat_tmp.value= "Enable";
		else
			f.pppoa_nat_tmp.value= "Disabled";
		f.action = "Internet_adsl_loading.asp";
		f.submitType.value = 'apply';
		f.isType.value = 1;
		f.isPage.value = 2;
		setTimeout('ajaxSubmit(document.getElementById("wan_form"), function(){});', 300);
}

function doSubmitBridge() {
	var f = document.getElementById("wan_form");
	

		if(f.uiViewConState_ck.checked == true)
			f.uiViewConState_ck.value = "Yes";
		else
			f.uiViewConState_ck.value = "No";
		f.action = "Internet_adsl_loading.asp";
		f.submitType.value = 'apply';
		f.isType.value = 1;
		f.isPage.value = 2;
		if($("#BridgeElpp_ck").attr("checked")) {
			f.BridgeElppEnable.value = "Yes";
		}	
		else
			f.BridgeElppEnable.value = "No";
		setTimeout('ajaxSubmit(document.getElementById("wan_form"), function(){});', 300);
}

/*function goType()
{
	var f = document.getElementById("wan_form");
	if(f.wanType.value == 3)
		self.location.href = "/cgi-bin/New_GUI/sp_wan.asp";
	else if(f.wanType.value == 4)
		self.location.href = "/cgi-bin/New_GUI/sp_wan_setup_ptm.asp";
	else if(f.wanType.value == 0)
		self.location.href = "/cgi-bin/New_GUI/Internet_setup.asp";
    	else
       	self.location.href = "/cgi-bin/New_GUI/sp_wan_3g.asp";
}*/
function subHtmAsc2(str) {
	var regStr=/(#|%|&|\+|\/|:|;|<|=|>|\?|@|\ )+/;
	var rntStr="";

	if (str.search(regStr) == -1)
		return str;

	for(var i=0; i<str.length; i++) {
		rntStr+=checkHtmChar2(str.charAt(i))
	}
	return rntStr;
}

function checkHtmChar2(c) {
	if (check_special(c.charCodeAt(0)))
		return toUTF(c.charAt("0"));
	return c;
}

function toUTF(m) {
	var aui=utf16to8(m);
	var bui="";
	for(var c=0;c<=aui.length;c++) {
		if(aui.charAt(c) != "")
			bui+="%"+toHex(aui.charAt(c).charCodeAt("0"));
	}
	return bui;
}

function utf16to8(str) {
    var out, i, len, c;

    out = "";
    len = str.length;
    for(i = 0; i < len; i++) {
		 c = str.charCodeAt(i);
		 if ((c >= 0x0001) && (c <= 0x007F)) {
		     out += str.charAt(i);
		 } else if (c > 0x07FF) {
		     out += String.fromCharCode(0xE0 | ((c >> 12) & 0x0F));
		     out += String.fromCharCode(0x80 | ((c >>  6) & 0x3F));
		     out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));
		 } else {
		     out += String.fromCharCode(0xC0 | ((c >>  6) & 0x1F));
		     out += String.fromCharCode(0x80 | ((c >>  0) & 0x3F));
		 }
    }
    return out;
}

function toHex( n ) {
	var digitArray = new Array('0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f');
	var result = '';
	var start = true;
	for ( var i=32; i>0; ) {
		i -= 4;
		var digit = ( n >> i ) & 0xf;

		if (!start || digit != 0) {
			start = false;
			result += digitArray[digit];
		}
	}
	return ( result == '' ? '0' : result );
}

function goIndex() {
	var f = document.getElementById("wan_form");
	f.ethchangepvcindex.value= "1";
	//f.action = "Internet_adsl_loading.asp";
    	//ajaxSubmit(document.getElementById("wan_form"), function(){self.location.href = "Internet_setup.asp";});
	f.submit();
}

function doReset() {
	var f = document.getElementById("wan_form");
	initWanSetup();
}

function checkparameterMAC(m) {
	if(m.length == 0)
		return false;

	if(m!="") {
 		if (m.search(":") != -1)
			var tmp=m.split(":");
		else
			var tmp=m.split("-");

		if(tmp.length!=6) {
			return false;
		} else {
			if(tmp[0]=="")
				return false;
			if(tmp[1]=="")
				return false;
			if(tmp[2]=="")
				return false;
			if(tmp[3]=="")
				return false;
			if(tmp[4]=="")
				return false;
			if(tmp[5]=="")
				return false;
		}
	}
	return true;
}

function showparticular(args) {
	var f = document.getElementById("wan_form");
	switch(parseInt(args)){
		case 1:
			//DisplayShow('dynamic_Connection_Type',"tr");
			document.getElementById("dynamic_Connection_Type").style.display = "";
			//DisplayShow('dynamic_NAT',"tr");
			document.getElementById("dynamic_NAT").style.display = "";
			if(bmode!=1) {
				document.getElementById("dynamic_Usage").style.display = "";
				document.getElementById("dynamic_MTU").style.display = "";
				document.getElementById("dynamic_Enable_PPPoE_Passthrough").style.display = "";
				//document.getElementById("dynamic_option60_venderid").style.display = "";
				document.getElementById("showatm").style.display = "";
			}
			if(isIPv6Supported=="Yes") { 
				document.getElementById("dhcpipv6").style.display = "";
				document.getElementById("staticipv6").style.display = "none";
				document.getElementById("pppipv6").style.display = "none";
			}
			document.getElementById("static_Connection_Type").style.display = "none";
			document.getElementById("static_IP_Address").style.display = "none";
			document.getElementById("static_Subnet_mask").style.display = "none";
			document.getElementById("static_Gateway_Address").style.display = "none";
			document.getElementById("static_MTU").style.display = "none";
			document.getElementById("static_Usage").style.display = "none";
			document.getElementById("showPppoe").style.display = "none";
			document.getElementById("static_NAT").style.display = "none";
			document.getElementById("pppoe_NAT").style.display = "none";
			document.getElementById("pppoa_NAT").style.display = "none";
			document.getElementById("pppoe_Username").style.display = "none";
			document.getElementById("pppoe_Password").style.display = "none";
			document.getElementById("pppoe_Confirm_Password").style.display = "none";
			document.getElementById("pppoe_Connection_Type").style.display = "none";
			document.getElementById("pppoe_Service_Name").style.display = "none";
			document.getElementById("pppoe_AC_name").style.display = "none";
			document.getElementById("pppoe_IP_Control").style.display = "none";
			document.getElementById("pppoe_Static_IP_Address").style.display = "none";
			document.getElementById("pppoe_Connect_mode_select1").style.display = "none";
			document.getElementById("pppoe_Maximum_Idle_Time").style.display = "none";
			document.getElementById("pppoe_MTU").style.display = "none";
			document.getElementById("pppoe_Usage").style.display = "none";
			document.getElementById("pppoe_Enable_PPPOE_Passthrough").style.display = "none";
			document.getElementById("pppoe_Protocol").style.display = "none";
			document.getElementById("pppoa_Username").style.display = "none";
			document.getElementById("pppoa_Password").style.display = "none";
			document.getElementById("pppoa_Confirm_Password").style.display = "none";
			document.getElementById("pppoa_Connection_Type").style.display = "none";
			document.getElementById("pppoa_IP_Control").style.display = "none";
			document.getElementById("pppoa_Static_IP_Address").style.display = "none";
			document.getElementById("pppoa_Connect_mode_select1").style.display = "none";
			document.getElementById("pppoa_Maximum_Idle_Time").style.display = "none";
			document.getElementById("pppoa_MTU").style.display = "none";
			document.getElementById("pppoa_Usage").style.display = "none";
			document.getElementById("pppoa_Protocol").style.display = "none";
			document.getElementById("bridge_connection_type").style.display = "none";
			document.getElementById("bridge_package").style.display = "none";
			
			initDynamic();
			doDHCPIPv6Enable();
			break;
		case 2:
			document.getElementById("static_Connection_Type").style.display = "";
			document.getElementById("static_IP_Address").style.display = "";
			document.getElementById("static_Subnet_mask").style.display = "";
			document.getElementById("static_Gateway_Address").style.display = "";
			document.getElementById("static_NAT").style.display = "";
			if(bmode!=1) {
				document.getElementById("showatm").style.display = "";
				document.getElementById("static_MTU").style.display = "";
				document.getElementById("static_Usage").style.display = "";
			}
			if(isIPv6Supported=="Yes") {
				document.getElementById("staticipv6").style.display = "";
				document.getElementById("dhcpipv6").style.display = "none";
				document.getElementById("pppipv6").style.display = "none";
			} 
			document.getElementById("dynamic_Connection_Type").style.display = "none";
			document.getElementById("dynamic_MTU").style.display = "none";
			document.getElementById("dynamic_Usage").style.display = "none";
			document.getElementById("dynamic_Enable_PPPoE_Passthrough").style.display = "none";
			//document.getElementById("dynamic_option60_venderid").style.display = "none";

			document.getElementById("dynamic_NAT").style.display = "none";
			document.getElementById("pppoe_NAT").style.display = "none";
			document.getElementById("pppoa_NAT").style.display = "none";

			document.getElementById("pppoe_Username").style.display = "none";
			document.getElementById("pppoe_Password").style.display = "none";
			document.getElementById("pppoe_Confirm_Password").style.display = "none";
			document.getElementById("pppoe_Connection_Type").style.display = "none";
			document.getElementById("pppoe_Service_Name").style.display = "none";
			document.getElementById("pppoe_AC_name").style.display = "none";
			document.getElementById("pppoe_IP_Control").style.display = "none";
			document.getElementById("pppoe_Static_IP_Address").style.display = "none";
			document.getElementById("pppoe_Connect_mode_select1").style.display = "none";
			
			document.getElementById("pppoe_Maximum_Idle_Time").style.display = "none";
			document.getElementById("pppoe_MTU").style.display = "none";
			document.getElementById("pppoe_Usage").style.display = "none";
			document.getElementById("pppoe_Enable_PPPOE_Passthrough").style.display = "none";
			document.getElementById("pppoe_Protocol").style.display = "none";

			document.getElementById("pppoa_Username").style.display = "none";
			document.getElementById("pppoa_Password").style.display = "none";
			document.getElementById("pppoa_Confirm_Password").style.display = "none";
			document.getElementById("pppoa_Connection_Type").style.display = "none";
			document.getElementById("pppoa_IP_Control").style.display = "none";
			document.getElementById("pppoa_Static_IP_Address").style.display = "none";
			document.getElementById("pppoa_Connect_mode_select1").style.display = "none";
			
			document.getElementById("pppoa_Maximum_Idle_Time").style.display = "none";
			document.getElementById("pppoa_MTU").style.display = "none";
			document.getElementById("pppoa_Usage").style.display = "none";
			document.getElementById("pppoa_Protocol").style.display = "none";
			document.getElementById("bridge_connection_type").style.display = "none";
			document.getElementById("bridge_package").style.display = "none";
			initStatic();
			doStaticIPv6Enable();
			break;
		case 3:
			document.getElementById("pppoe_Username").style.display = "";

			document.getElementById("pppoe_Password").style.display = "";
			
			document.getElementById("pppoe_Confirm_Password").style.display = "";
			
			document.getElementById("pppoe_Connection_Type").style.display = "";
			
			document.getElementById("pppoe_Service_Name").style.display = "";
			
			document.getElementById("pppoe_AC_name").style.display = "";

			if(parseInt(unlock) == 1) {
				document.getElementById("pppoe_IP_Control").style.display = "";
				document.getElementById("pppoe_Static_IP_Address").style.display = "";
			} else {
				document.getElementById("pppoe_IP_Control").style.display = "none";
				document.getElementById("pppoe_Static_IP_Address").style.display = "none";
			}

			document.getElementById("pppoe_Connect_mode_select1").style.display = "";
			//DisplayShow('pppoe_Connect_mode_select2',"tr");
			//DisplayShow('pppoe_Connect_mode_select3',"tr");
			
			document.getElementById("pppoe_Maximum_Idle_Time").style.display = "";
	
			document.getElementById("pppoe_NAT").style.display = "";
			if(isIPv6Supported=="Yes") {
				document.getElementById("pppipv6").style.display = "inline";
				document.getElementById("dhcpipv6").style.display = "none";
				document.getElementById("staticipv6").style.display = "none";
			} 

			if(bmode!=1) {
				document.getElementById("pppoe_MTU").style.display = "";
				document.getElementById("pppoe_Usage").style.display = "";
				document.getElementById("pppoe_Enable_PPPOE_Passthrough").style.display = "";
				document.getElementById("pppoe_Protocol").style.display = "";
				document.getElementById("showatm").style.display = "";
			}
			
			document.getElementById("static_NAT").style.display = "none";
			document.getElementById("dynamic_NAT").style.display = "none";
			document.getElementById("pppoa_NAT").style.display = "none";
			
			document.getElementById("dynamic_Connection_Type").style.display = "none";
			document.getElementById("dynamic_MTU").style.display = "none";
			document.getElementById("dynamic_Usage").style.display = "none";
			document.getElementById("dynamic_Enable_PPPoE_Passthrough").style.display = "none";
			//document.getElementById("dynamic_option60_venderid").style.display = "none";
			document.getElementById("static_Connection_Type").style.display = "none";
			document.getElementById("static_IP_Address").style.display = "none";
			document.getElementById("static_Subnet_mask").style.display = "none";
			document.getElementById("static_Gateway_Address").style.display = "none";
			document.getElementById("static_MTU").style.display = "none";
			document.getElementById("static_Usage").style.display = "none";

			
			
			document.getElementById("pppoa_Username").style.display = "none";
			document.getElementById("pppoa_Password").style.display = "none";
			document.getElementById("pppoa_Confirm_Password").style.display = "none";
			document.getElementById("pppoa_Connection_Type").style.display = "none";
			document.getElementById("pppoa_IP_Control").style.display = "none";
			document.getElementById("pppoa_Static_IP_Address").style.display = "none";
			document.getElementById("pppoa_Connect_mode_select1").style.display = "none";
			document.getElementById("pppoa_Maximum_Idle_Time").style.display = "none";
			document.getElementById("pppoa_MTU").style.display = "none";
			document.getElementById("pppoa_Usage").style.display = "none";
			document.getElementById("pppoa_Protocol").style.display = "none";
			document.getElementById("bridge_connection_type").style.display = "none";
			document.getElementById("bridge_package").style.display = "none";
			document.getElementById("showPppoe").style.display = "none";
			
			
			initPPPOE();
			doPPPIPv6Enable();
			if(parseInt(tmpnum) != 3) {
				f.pppoe_conn_type.value = "PPPoE LLC";
			}
			break;
		case 4:
			document.getElementById("pppoa_Username").style.display = "";
			document.getElementById("pppoa_Password").style.display = "";
			document.getElementById("pppoa_Confirm_Password").style.display = "";
			document.getElementById("pppoa_Connection_Type").style.display = "";
			if(parseInt(unlock) == 1) {
				document.getElementById("pppoa_IP_Control").style.display = "";
				document.getElementById("pppoa_Static_IP_Address").style.display = "";
			} else {
				document.getElementById("pppoa_IP_Control").style.display = "none";
				document.getElementById("pppoa_Static_IP_Address").style.display = "none";
			}
			if(isIPv6Supported=="Yes") {
				document.getElementById("pppipv6").style.display = "";
				document.getElementById("dhcpipv6").style.display = "none";
				document.getElementById("staticipv6").style.display = "none";
			} 
			document.getElementById("pppoa_Connect_mode_select1").style.display = "";
			document.getElementById("pppoa_Maximum_Idle_Time").style.display = "";

			document.getElementById("pppoa_NAT").style.display = "";
			document.getElementById("pppoa_Protocol").style.display = "";
			if(bmode!=1) {
				document.getElementById("pppoa_MTU").style.display = "";
				if(parseInt(unlock) == 1)
					document.getElementById("pppoa_Usage").style.display = "";
				else
					document.getElementById("pppoa_Usage").style.display = "none";
				document.getElementById("showatm").style.display = "";
			}

			document.getElementById("static_NAT").style.display = "none";
			document.getElementById("pppoe_NAT").style.display = "none";
			document.getElementById("dynamic_NAT").style.display = "none";
			document.getElementById("dynamic_Connection_Type").style.display = "none";
			document.getElementById("dynamic_MTU").style.display = "none";
			document.getElementById("dynamic_Usage").style.display = "none";
			document.getElementById("dynamic_Enable_PPPoE_Passthrough").style.display = "none";
			//document.getElementById("dynamic_option60_venderid").style.display = "none";
			document.getElementById("static_Connection_Type").style.display = "none";
			document.getElementById("static_IP_Address").style.display = "none";
			document.getElementById("static_Subnet_mask").style.display = "none";
			document.getElementById("static_Gateway_Address").style.display = "none";
			document.getElementById("static_MTU").style.display = "none";
			document.getElementById("static_Usage").style.display = "none";

			document.getElementById("pppoe_Username").style.display = "none";
			document.getElementById("pppoe_Password").style.display = "none";
			document.getElementById("pppoe_Confirm_Password").style.display = "none";
			document.getElementById("pppoe_Connection_Type").style.display = "none";
			document.getElementById("pppoe_Service_Name").style.display = "none";
			document.getElementById("pppoe_AC_name").style.display = "none";
			document.getElementById("pppoe_IP_Control").style.display = "none";
			document.getElementById("pppoe_Static_IP_Address").style.display = "none";
			document.getElementById("pppoe_Connect_mode_select1").style.display = "none";
			
			document.getElementById("pppoe_Maximum_Idle_Time").style.display = "none";
			document.getElementById("pppoe_MTU").style.display = "none";
			document.getElementById("pppoe_Usage").style.display = "none";

			document.getElementById("pppoa_Usage").style.display = "";
			document.getElementById("pppoe_Enable_PPPOE_Passthrough").style.display = "none";
			document.getElementById("pppoe_Protocol").style.display = "none";

			document.getElementById("bridge_connection_type").style.display = "none";
			document.getElementById("bridge_package").style.display = "none";
			document.getElementById("showPppoe").style.display = "none";
			initPPPOA();
			doPPPIPv6Enable();
			if(parseInt(tmpnum) != 4)
				f.pppoa_conn_type.value = "PPPoA VC-Mux";
			break;
		case 5:
			document.getElementById("bridge_connection_type").style.display = "";
			document.getElementById("bridge_package").style.display = "";
			if(bmode!=1)
				document.getElementById("showatm").style.display = "";

			document.getElementById("dynamic_NAT").style.display = "none";
			document.getElementById("static_NAT").style.display = "none";
			document.getElementById("pppoe_NAT").style.display = "none";
			document.getElementById("pppoa_NAT").style.display = "none";

			document.getElementById("dynamic_Connection_Type").style.display = "none";
			document.getElementById("dynamic_MTU").style.display = "none";
			document.getElementById("dynamic_Usage").style.display = "none";
			document.getElementById("dynamic_Enable_PPPoE_Passthrough").style.display = "none";
			//document.getElementById("dynamic_option60_venderid").style.display = "none";
			document.getElementById("static_Connection_Type").style.display = "none";
			document.getElementById("static_IP_Address").style.display = "none";
			document.getElementById("static_Subnet_mask").style.display = "none";
			document.getElementById("static_Gateway_Address").style.display = "none";
			document.getElementById("static_MTU").style.display = "none";
			document.getElementById("static_Usage").style.display = "none";
			
			document.getElementById("pppoe_Username").style.display = "none";
			document.getElementById("pppoe_Password").style.display = "none";
			document.getElementById("pppoe_Confirm_Password").style.display = "none";
			document.getElementById("pppoe_Connection_Type").style.display = "none";
			document.getElementById("pppoe_Service_Name").style.display = "none";
			document.getElementById("pppoe_AC_name").style.display = "none";
			document.getElementById("pppoe_IP_Control").style.display = "none";
			document.getElementById("pppoe_Static_IP_Address").style.display = "none";
			document.getElementById("pppoe_Connect_mode_select1").style.display = "none";
			
			document.getElementById("pppoe_Maximum_Idle_Time").style.display = "none";
			document.getElementById("pppoe_MTU").style.display = "none";
			document.getElementById("pppoe_Usage").style.display = "none";
			document.getElementById("pppoe_Enable_PPPOE_Passthrough").style.display = "none";
			document.getElementById("pppoe_Protocol").style.display = "none";

			document.getElementById("pppoa_Username").style.display = "none";
			document.getElementById("pppoa_Password").style.display = "none";
			document.getElementById("pppoa_Confirm_Password").style.display = "none";
			document.getElementById("pppoa_Connection_Type").style.display = "none";
			document.getElementById("pppoa_IP_Control").style.display = "none";
			document.getElementById("pppoa_Static_IP_Address").style.display = "none";
			document.getElementById("pppoa_Connect_mode_select1").style.display = "none";
			
			document.getElementById("pppoa_Maximum_Idle_Time").style.display = "none";
			document.getElementById("pppoa_MTU").style.display = "none";
			document.getElementById("pppoa_Usage").style.display = "none";
			document.getElementById("pppoa_Protocol").style.display = "none";
			document.getElementById("pppipv6").style.display = "none";
			document.getElementById("dhcpipv6").style.display = "none";
			document.getElementById("staticipv6").style.display = "none";
			document.getElementById("showPppoe").style.display = "none";
			initBridge();
			break;
	}
	if( isIPv6Supported == "Yes") {
		if(parseInt(f.ipv6Flag.value) != 1) {
			document.getElementById("dhcpipv6").style.display = "none";
			document.getElementById("staticipv6").style.display = "none";
			document.getElementById("pppipv6").style.display = "none";
		}
	}
}

function lockObj(objName, flag) {
	var tag = document.getElementsByName(objName);
	for(var i=0; i < tag.length; i++) {
		tag[i].disabled = flag;
	}
}

function doDHCPIPv6Enable() {
	var f = document.getElementById("wan_form");
	var flag = true;
	if(f.DHCPIPv6Enable[0].checked)
		flag = false;

	lockObj("DynIPv6EnableRadio", flag);
	lockObj("privacyaddrsradio0", flag);
	lockObj("PPPIPv6PDRadio0", flag);
	lockObj("wan_MLD0", flag);
	lockObj("ripngEnableRadio0", flag);
	lockObj("wan_Ripng_Dir0", flag);
}

function doStaticIPv6Enable() {
	var f = document.getElementById("wan_form");
	var flag = true;
	if(f.StaticIPv6Enable[0].checked)
		flag = false;

	lockObj("wan_IPv6Addr", flag);
	lockObj("wan_IPv6Prefix", flag);
	lockObj("wan_IPv6DefGw", flag);
	lockObj("wan_IPv6DNS1", flag);
	lockObj("wan_IPv6DNS2", flag);
	lockObj("wan_MLD1", flag);
	lockObj("ripngEnableRadio1", flag);
	lockObj("wan_Ripng_Dir1", flag);
}

function doPPPIPv6Enable() {
	var f = document.getElementById("wan_form");
	var flag = true;
	if(f.PPPIPv6Enable[0].checked)
		flag = false;

	lockObj("PPPIPv6ModeRadio", flag);
	lockObj("privacyaddrsradio2", flag);
	lockObj("PPPIPv6PDRadio2", flag);
	lockObj("wan_MLD2", flag);
	lockObj("ripngEnableRadio2", flag);
	lockObj("wan_Ripng_Dir2", flag);
}

function selectpptp() {
	var f = document.getElementById("wan_form");

	if(f.pptp_enable.checked==false) {
		f.pptp_tunnel_name.disabled=true;
		f.pptp_server_ip_address.disabled=true;
		f.pptp_user_name.disabled=true;
		f.pptp_user_password.disabled=true;
		f.pptp_peer_ip_address.disabled=true;
		f.pptp_peer_subnet_mask.disabled=true;
	}
	if(f.pptp_enable.checked==true) {
		f.pptp_tunnel_name.disabled=false;
		f.pptp_server_ip_address.disabled=false;
		f.pptp_user_name.disabled=false;
		f.pptp_user_password.disabled=false;
		f.pptp_peer_ip_address.disabled=false;
		f.pptp_peer_subnet_mask.disabled=false;
	}
}

function initDynamic() {
	var f = document.getElementById("wan_form");
	var z=0;
	document.getElementById("pppoe_umb_pppoe_type_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_interface_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_umb_ip_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_umb_netmask_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_type_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_interface_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_umb_ip_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_umb_netmask_show").style.display = "none";
	document.getElementById("PPTPdiv").style.display = "none";

	if(parseInt(showpptp)==1) {
		document.getElementById("PPTPdiv").style.display = "";
		if(parseInt(pptpobj.mode)==6)
			f.pptp_enable.checked=true;
		else
			f.pptp_enable.checked=false;

		if(f.pptp_enable.checked==false) {
			f.pptp_tunnel_name.disabled=true;
			f.pptp_server_ip_address.disabled=true;
			f.pptp_user_name.disabled=true;
			f.pptp_user_password.disabled=true;
			f.pptp_peer_ip_address.disabled=true;
			f.pptp_peer_subnet_mask.disabled=true;
		} else {
			f.pptp_tunnel_name.disabled=false;
			f.pptp_server_ip_address.disabled=false;
			f.pptp_user_name.disabled=false;
			f.pptp_user_password.disabled=false;
			f.pptp_peer_ip_address.disabled=false;
			f.pptp_peer_subnet_mask.disabled=false;
		}

		f.pptp_tunnel_name.value=pptpobj.tunnel_name;
		f.pptp_server_ip_address.value=pptpobj.serverip;
		f.pptp_user_name.value=pptpobj.name;
		f.pptp_user_password.value=pptpobj.password;
		f.pptp_peer_ip_address.value="";
		f.pptp_peer_subnet_mask.value="";
	}

	if(bmode!=1) {
		mtu = dynamicobj.MTU;
		if(mtu == "N/A")
			f.dynamic_mtu.value=0;
		else
			f.dynamic_mtu.value=mtu;
		if(dynamicobj.nat=="Enable")
			SetCheckBoxEnable("dynamic_nat", true, true);
		else
			SetCheckBoxEnable("dynamic_nat", true, false);
		$("#dynamic_DefaultRoute").selectbox("detach");
		if(defalutrouter=="Yes")
			 f.dynamic_DefaultRoute.value="Yes";
		else
			 f.dynamic_DefaultRoute.value="No";
		$("#dynamic_DefaultRoute").selectbox("attach");
		if(dynamicobj.pppoe_passthrough=="Yes")
			SetCheckBoxEnable("dynamic_PPPoEPassthrough", true, true);
		else
			SetCheckBoxEnable("dynamic_PPPoEPassthrough", true, false);
	   	QoSDoOnLoad();
	}

	if(decodeSpecialChr(ATM_obj.encaps)=="1483 Bridged IP LLC")
		f.dynamic_uiViewEncaps.value="1483 Bridged IP LLC";
	else if(decodeSpecialChr(ATM_obj.encaps) == "1483 Bridged IP VC-Mux")
		f.dynamic_uiViewEncaps.value="1483 Bridged IP VC-Mux";
	else if (decodeSpecialChr(ATM_obj.encaps) == "1483 Routed IP LLC(IPoA)")
		f.dynamic_uiViewEncaps.value="1483 Routed IP LLC(IPoA)";
	else if(decodeSpecialChr(ATM_obj.encaps) == "1483 Routed IP VC-Mux")
		f.dynamic_uiViewEncaps.value="1483 Routed IP VC-Mux";

	//f.option60_venderid.value = decodeSpecialChr(venderid);
	if((self.location.href.indexOf("error=true")!=-1)||(self.location.href.indexOf("confirm=true")!=-1)||(self.location.href.indexOf("confirm=back")!=-1)) {
		if(bmode!=1)
			f.dynamic_mtu.value=mtuvalue;
		f.type.value=annexvalue;
	}
}

function initStatic() {
	var f = document.getElementById("wan_form");
	document.getElementById("pppoe_umb_pppoe_type_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_interface_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_umb_ip_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_umb_netmask_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_type_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_interface_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_umb_ip_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_umb_netmask_show").style.display = "none";
	document.getElementById("PPTPdiv").style.display = "none";

	if(parseInt(showpptp)==1) {
		document.getElementById("PPTPdiv").style.display = "";
		if(parseInt(pptpobj.mode)==6)
			f.pptp_enable.checked=true;
		else
			f.pptp_enable.checked=false;

		if(f.pptp_enable.checked==false) {
			f.pptp_tunnel_name.disabled=true;
			f.pptp_server_ip_address.disabled=true;
			f.pptp_user_name.disabled=true;
			f.pptp_user_password.disabled=true;
			f.pptp_peer_ip_address.disabled=true;
			f.pptp_peer_subnet_mask.disabled=true;
		} else {
			f.pptp_tunnel_name.disabled=false;
			f.pptp_server_ip_address.disabled=false;
			f.pptp_user_name.disabled=false;
			f.pptp_user_password.disabled=false;
			f.pptp_peer_ip_address.disabled=false;
			f.pptp_peer_subnet_mask.disabled=false;
		}

		f.pptp_tunnel_name.value=pptpobj.tunnel_name;
		f.pptp_server_ip_address.value=pptpobj.serverip;
		f.pptp_user_name.value=pptpobj.name;
		f.pptp_user_password.value=pptpobj.password;
		f.pptp_peer_ip_address.value="";
		f.pptp_peer_subnet_mask.value="";
	}

	if(bmode!=1) {
		mtu = staticobj.MTU;
		if(mtu == "N/A")
			f.static_mtu.value=0;
		else
			f.static_mtu.value=mtu;

		if(staticobj.nat == "Enable")
			SetCheckBoxEnable("static_nat", true, true);
		else
			SetCheckBoxEnable("static_nat", true, false);
		$("#static_DefaultRoute").selectbox("detach");
		if(defalutrouter=="Yes")
			 f.static_DefaultRoute.value="Yes";
		else
			 f.static_DefaultRoute.value="No";
		$("#static_DefaultRoute").selectbox("attach");
	  	if(staticobj.pppoe_passthrough=="Yes")
			SetCheckBoxEnable("static_PPPoEPassthrough", true, true);
		else
			SetCheckBoxEnable("static_PPPoEPassthrough", true, false);
	   	QoSDoOnLoad();
	}

	if(decodeSpecialChr(ATM_obj.encaps)=="1483 Bridged IP LLC")
		f.static_uiViewEncaps.value="1483 Bridged IP LLC";
	else if(decodeSpecialChr(ATM_obj.encaps) == "1483 Bridged IP VC-Mux")
		f.static_uiViewEncaps.value="1483 Bridged IP VC-Mux";
	else if (decodeSpecialChr(ATM_obj.encaps) == "1483 Routed IP LLC(IPoA)")
		f.static_uiViewEncaps.value="1483 Routed IP LLC(IPoA)";
	else if(decodeSpecialChr(ATM_obj.encaps) == "1483 Routed IP VC-Mux")
		f.static_uiViewEncaps.value="1483 Routed IP VC-Mux";

	if(staticobj.ip == "N/A")
		f.static_ip.value="";
	else
		f.static_ip.value=staticobj.ip;

	if(staticobj.mask == "N/A")
		f.static_mask.value="";
	else
		f.static_mask.value=staticobj.mask;

	if(staticobj.gateway == "N/A")
		f.static_gateway.value="";
	else
		f.static_gateway.value=staticobj.gateway;

	if((self.location.href.indexOf("error=true")!=-1)||(self.location.href.indexOf("confirm=true")!=-1)||(self.location.href.indexOf("confirm=back")!=-1)) {
		if(bmode!=1)
		f.static_mtu.value=mtuvalue;
		f.static_ip.value=ipvalue;
		f.static_mask.value=maskvalue;
		f.static_gateway.value=gatewayvalue;
	}
	HideorShow();
}

function initPPPOE() {
	var f = document.getElementById("wan_form");

	if(parseInt(unnumbered)==1) {
		if(parseInt(unlock) == 1) {
			document.getElementById("pppoe_umb_pppoe_type_show").style.display = "";
			document.getElementById("pppoe_umb_pppoe_interface_show").style.display = "";
			document.getElementById("pppoe_umb_pppoe_umb_ip_show").style.display = "";		
			document.getElementById("pppoe_umb_pppoe_umb_netmask_show").style.display = "";
		} else {
			document.getElementById("pppoe_umb_pppoe_type_show").style.display = "none";
			document.getElementById("pppoe_umb_pppoe_interface_show").style.display = "none";
			document.getElementById("pppoe_umb_pppoe_umb_ip_show").style.display = "none";		
			document.getElementById("pppoe_umb_pppoe_umb_netmask_show").style.display = "none";
		}

		document.getElementById("pppoa_umb_pppoa_type_show").style.display = "none";
		document.getElementById("pppoa_umb_pppoa_interface_show").style.display = "none";
		document.getElementById("pppoa_umb_pppoa_umb_ip_show").style.display = "none";
		document.getElementById("pppoa_umb_pppoa_umb_netmask_show").style.display = "none";
		document.getElementById("PPTPdiv").style.display = "none";
		
		if(parseInt(showpptp)==1) {
			document.getElementById("PPTPdiv").style.display = "";
			if(parseInt(pptpobj.mode)==6)
				f.pptp_enable.checked=true;
			else
				f.pptp_enable.checked=false;

			if(f.pptp_enable.checked==false) {
				f.pptp_tunnel_name.disabled=true;
				f.pptp_server_ip_address.disabled=true;
				f.pptp_user_name.disabled=true;
				f.pptp_user_password.disabled=true;
				f.pptp_peer_ip_address.disabled=true;
				f.pptp_peer_subnet_mask.disabled=true;
			} else {
				f.pptp_tunnel_name.disabled=false;
				f.pptp_server_ip_address.disabled=false;
				f.pptp_user_name.disabled=false;
				f.pptp_user_password.disabled=false;
				f.pptp_peer_ip_address.disabled=false;
				f.pptp_peer_subnet_mask.disabled=false;
			}

			f.pptp_tunnel_name.value=pptpobj.tunnel_name;
			f.pptp_server_ip_address.value=pptpobj.serverip;
			f.pptp_user_name.value=pptpobj.name;
			f.pptp_user_password.value=pptpobj.password;
			f.pptp_peer_ip_address.value="";
			f.pptp_peer_subnet_mask.value="";
		}

		if(lanipList[2]=="")
			f.pppoe_umb_pppoe_type.value=0;
		else
			f.pppoe_umb_pppoe_type.value=lanipList[2];

		if(lanipList[3]=="")
			f.interface.selected=1;
		else
			f.interface.value=lanipList[3];

		f.pppoe_umb_ip.value=lanipList[0];
		f.pppoe_umb_netmask.value=lanipList[1];

		if((parseInt(f.pppoe_umb_pppoe_type.value)!=1)&&(parseInt(f.pppoe_umb_pppoe_type.value)!=2)) {
			f.interface.disabled=true;
			f.pppoe_umb_ip.disabled=true;
			f.pppoe_umb_netmask.disabled=true;
		}
	}

	if(bmode!=1) {
		mtu = pppobj.MTU;
		if(mtu == "N/A")
			f.pppoe_mtu.value=0;
		else if(parseInt(mtu) > 1516)
			f.pppoe_mtu.value=1516;
		else
			f.pppoe_mtu.value=mtu;

		if(pppobj.nat == "Enable")
			//f.pppoe_nat.checked = true;
			SetCheckBoxEnable("pppoe_nat", true, true);
		else
			//f.pppoe_nat.checked = false;
			SetCheckBoxEnable("pppoe_nat", true, false);
		$("#pppoe_DefaultRoute").selectbox("detach");
		if(defalutrouter=="Yes")
			 f.pppoe_DefaultRoute.value="Yes";
		else
			 f.pppoe_DefaultRoute.value="No";
		$("#pppoe_DefaultRoute").selectbox("attach");
	  	//f.pppoe_PPPoEPassthrough.checked=((pppobj.pppoe_passthrough=="Yes")?1:0);
	  	if(pppobj.pppoe_passthrough == "Yes")
			SetCheckBoxEnable("pppoe_PPPoEPassthrough", true, true);
		else
			SetCheckBoxEnable("pppoe_PPPoEPassthrough", true, false);
	  	if(pppoeauthprotocol == "N/A")
			f.pppoe_auth_protocol.value="AUTO";
		else
			f.pppoe_auth_protocol.value=pppoeauthprotocol;
	   	QoSDoOnLoad();
	}
	wanMode = pppobj.wanMode;
	mode = pppobj.mode;
	user = pppobj.user;

	serviceName = pppobj.serviceName;
	acName = pppobj.acName;

	if(mode != 2)
		f.pppoe_IPControl.selectedIndex =1;

	ip = pppobj.ip;
	idle = (pppobj.idle=="N/A"? 1 : parseInt(pppobj.idle));
	mtu = pppobj.MTU;

	autoConnect = pppobj.autoConnect;
	onDemand = pppobj.onDemand;

	if(user == "N/A")
		f.pppoe_name.value="";
	else
		f.pppoe_name.value=decodeSpecialChr(user);
	f.pppoe_pass.value=decodeSpecialChr(pppobj.password); 
       f.pppoe_pass_v.value=decodeSpecialChr(pppobj.password); 
	
	if(decodeSpecialChr(ATM_obj.encaps)=="PPPoE LLC")
		f.pppoe_conn_type.selectedIndex=0;
	else if(decodeSpecialChr(ATM_obj.encaps)=="PPPoE VC-Mux")
		f.pppoe_conn_type.selectedIndex=1;

	if(serviceName == "N/A")
		f.pppoe_srv_name.value="";
	else
		f.pppoe_srv_name.value=decodeSpecialChr(serviceName);

	if(acName == "N/A")
		f.pppoe_ac_name.value="";
	else
		f.pppoe_ac_name.value=decodeSpecialChr(acName);

	f.pppoe_ip.value=ip;
    f.pppoe_max_time.value=idle;

	$("#pppoe_radio_connect").selectbox("detach");
	if(pppobj.autoConnect=="Connect_Keep_Alive")
		f.pppoe_radio_connect.value = "Connect_Keep_Alive";
	else if(pppobj.autoConnect=="Connect_Manually")
		f.pppoe_radio_connect.value = "Connect_Manually";
	else
		f.pppoe_radio_connect.value = "Connect_on_Demand";
	$("#pppoe_radio_connect").selectbox("attach");
	connect_control();
   	clickPPP(f);
 	traffic_classValue=ATM_obj.traffic_class;
 	vbr_pcrValue=ATM_obj.vbr_pcr;
 	vbr_scrValue=ATM_obj.vbr_scr;

	if((self.location.href.indexOf("error=true")!=-1)||(self.location.href.indexOf("confirm=true")!=-1)||(self.location.href.indexOf("confirm=back")!=-1)) {
		if(bmode!=1)
			f.pppoe_mtu.value=mtuvalue;
		
		f.pppoe_conn_type.value=conn_t;
		f.pppoe_IPControl.value=IPC;
		if(f.pppoe_IPControl.value==1) {
			f.pppoe_ip.value=ipvalue;
			f.pppoe_ip.disabled=false;
		}
	}
}

function initPPPOA() {
	var f = document.getElementById("wan_form");

	if(parseInt(unnumbered)==1) {
		if(parseInt(unlock) == 1) {
			document.getElementById("pppoa_umb_pppoa_type_show").style.display = "";
			document.getElementById("pppoa_umb_pppoa_interface_show").style.display = "";
			document.getElementById("pppoa_umb_pppoa_umb_ip_show").style.display = "";
			document.getElementById("pppoa_umb_pppoa_umb_netmask_show").style.display = "";
		} else {
			document.getElementById("pppoa_umb_pppoa_type_show").style.display = "none";
			document.getElementById("pppoa_umb_pppoa_interface_show").style.display = "none";
			document.getElementById("pppoa_umb_pppoa_umb_ip_show").style.display = "none";
			document.getElementById("pppoa_umb_pppoa_umb_netmask_show").style.display = "none";
		}

		document.getElementById("pppoe_umb_pppoe_type_show").style.display = "none";
		document.getElementById("pppoe_umb_pppoe_interface_show").style.display = "none";
		document.getElementById("pppoe_umb_pppoe_umb_ip_show").style.display = "none";
		document.getElementById("pppoe_umb_pppoe_umb_netmask_show").style.display = "none";
		document.getElementById("PPTPdiv").style.display = "none";

		if(defalutrouter=="Yes")
			 f.pppoe_DefaultRoute.value="Yes";
		else
			 f.pppoe_DefaultRoute.value="No";

		if(parseInt(showpptp)==1) {
			document.getElementById("PPTPdiv").style.display = "";
			if(parseInt(pptpobj.mode)==6)
				f.pptp_enable.checked=true;
			else
				f.pptp_enable.checked=false;

			if(f.pptp_enable.checked==false) {
				f.pptp_tunnel_name.disabled=true;
				f.pptp_server_ip_address.disabled=true;
				f.pptp_user_name.disabled=true;
				f.pptp_user_password.disabled=true;
				f.pptp_peer_ip_address.disabled=true;
				f.pptp_peer_subnet_mask.disabled=true;
			} else {
				f.pptp_tunnel_name.disabled=false;
				f.pptp_server_ip_address.disabled=false;
				f.pptp_user_name.disabled=false;
				f.pptp_user_password.disabled=false;
				f.pptp_peer_ip_address.disabled=false;
				f.pptp_peer_subnet_mask.disabled=false;
			}

			f.pptp_tunnel_name.value=pptpobj.tunnel_name;
			f.pptp_server_ip_address.value=pptpobj.serverip;
			f.pptp_user_name.value=pptpobj.name;
			f.pptp_user_password.value=pptpobj.password;
			f.pptp_peer_ip_address.value="";
			f.pptp_peer_subnet_mask.value="";
		}

		if(lanipList[2]=="")
			f.pppoa_umb_pppoa_type.value=0;
		else
			f.pppoa_umb_pppoa_type.value=lanipList[2];

		if(lanipList[3]=="")
			f.pppoa_interface.selected=1;
		else
			f.pppoa_interface.value=lanipList[3];

		f.pppoa_umb_ip.value=lanipList[0];
		f.pppoa_umb_netmask.value=lanipList[1];

		if((parseInt(f.pppoa_umb_pppoa_type.value)!=1)&&(parseInt(f.pppoa_umb_pppoa_type.value)!=2)) {
			f.pppoa_interface.disabled=true;
			f.pppoa_umb_ip.disabled=true;
			f.pppoa_umb_netmask.disabled=true;
		}
	}

	if(bmode!=1) {
		mtu = pppobj.MTU;
		if(mtu == "N/A")
			f.pppoa_mtu.value=0;
		else if(parseInt(mtu) > 1516)
			f.pppoe_mtu.value=1516;
		else
			f.pppoa_mtu.value=mtu;

		if(pppobj.nat == "Enable")
			SetCheckBoxEnable("pppoa_nat", true, true);
		else
			SetCheckBoxEnable("pppoa_nat", true, false);
		if(pppoeauthprotocol == "N/A")
			f.pppoa_auth_protocol.value="AUTO";
		else
			f.pppoa_auth_protocol.value=pppoeauthprotocol;
		$("#pppoa_DefaultRoute").selectbox("detach");
		if(defalutrouter=="Yes")
			 f.pppoa_DefaultRoute.value="Yes";
		else
			 f.pppoa_DefaultRoute.value="No";
		$("#pppoa_DefaultRoute").selectbox("attach");
	   	QoSDoOnLoad();
	}
	wanMode = pppobj.wanMode;
	mode = pppobj.mode;
	user = pppobj.user;
	serviceName = pppobj.serviceName;
	acName = pppobj.acName;

	if(mode != 2)
		f.pppoa_IPControl.selectedIndex =1;

	ip = pppobj.ip;
	idle = (pppobj.idle=="N/A"? 1 : parseInt(pppobj.idle));
	mtu = pppobj.MTU;

	autoConnect = pppobj.autoConnect;
	onDemand = pppobj.onDemand;

	if(user == "N/A")
		f.pppoa_name.value="";
	else
		f.pppoa_name.value=decodeSpecialChr(user);
	f.pppoa_pass.value=decodeSpecialChr(pppobj.password); 
       f.pppoa_pass_v.value=decodeSpecialChr(pppobj.password); 

	if(decodeSpecialChr(ATM_obj.encaps)=="PPPoA LLC")
		f.pppoa_conn_type.selectedIndex=0;
	else if(decodeSpecialChr(ATM_obj.encaps)=="PPPoA VC-Mux")
		f.pppoa_conn_type.selectedIndex=1;

	f.pppoa_ip.value=ip;
	f.pppoa_max_time.value=idle;

	$("#pppoa_radio_connect").selectbox("detach");
	if(pppobj.autoConnect=="Connect_Keep_Alive")
		f.pppoa_radio_connect.value = "Connect_Keep_Alive";
	else if(pppobj.autoConnect=="Connect_Manually")
		f.pppoa_radio_connect.value = "Connect_Manually";
	else
		f.pppoa_radio_connect.value = "Connect_on_Demand";
	$("#pppoa_radio_connect").selectbox("attach");
	connect_controlOA();
	clickPPPOA(f);
	traffic_classValue=ATM_obj.traffic_class;
	vbr_pcrValue=ATM_obj.vbr_pcr;
	vbr_scrValue=ATM_obj.vbr_scr;

	if((self.location.href.indexOf("error=true")!=-1)||(self.location.href.indexOf("confirm=true")!=-1)||(self.location.href.indexOf("confirm=back")!=-1)) {
		if(bmode!=1)
			f.pppoa_mtu.value=mtuvalue;
		
		f.pppoa_conn_type.value=conn_t;
		f.pppoa_IPControl.value=IPC;
		if(f.pppoa_IPControl.value==1) {
			f.pppoa_ip.value=ipvalue;
			f.pppoa_ip.disabled=false;
		}
	}
}

function initBridge() {
	var f = document.getElementById("wan_form");

	document.getElementById("pppoe_umb_pppoe_type_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_interface_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_umb_ip_show").style.display = "none";
	document.getElementById("pppoe_umb_pppoe_umb_netmask_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_type_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_interface_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_umb_ip_show").style.display = "none";
	document.getElementById("pppoa_umb_pppoa_umb_netmask_show").style.display = "none";
	document.getElementById("PPTPdiv").style.display = "none";
	
	if(bmode!=1)
		QoSDoOnLoad();

	if(decodeSpecialChr(ATM_obj.encaps)=="1483 Bridged Only LLC")
		f.bridge_uiViewEncaps.value="1483 Bridged Only LLC";
	else if(decodeSpecialChr(ATM_obj.encaps)=="1483 Bridged Only VC-Mux")
		f.bridge_uiViewEncaps.value="1483 Bridged Only VC-Mux";

	if(parseInt(bridgeMtu) > 1500)
		SetCheckBoxEnable("BridgeElpp", true, true);
	else
		SetCheckBoxEnable("BridgeElpp", true, false);
}

function ViewConStatechecked() {
	var f = document.getElementById("wan_form");
	changeBlock();
}

function doedit() {
	var f = document.getElementById("wan_form");
	if(f.pppoe_umb_pppoe_type.value==0) {
		f.interface.disabled=true;
		f.pppoe_umb_ip.disabled=true;
		f.pppoe_umb_netmask.disabled=true;
	} else {
		f.interface.disabled=false;
		f.pppoe_umb_ip.disabled=false;
		f.pppoe_umb_netmask.disabled=false;
	}
}

function doeditpppoa() {
	var f = document.getElementById("wan_form");
	if(f.pppoa_umb_pppoa_type.value==0) {
		f.pppoa_interface.disabled=true;
		f.pppoa_umb_ip.disabled=true;
		f.pppoa_umb_netmask.disabled=true;
	} else {
		f.pppoa_interface.disabled=false;
		f.pppoa_umb_ip.disabled=false;
		f.pppoa_umb_netmask.disabled=false;
	}
}

function changeBlock() {
	var f = document.getElementById("wan_form");
	//if(f.uiViewConState.checked) {
	if(f.uiViewConState_ck.checked){
		//changeBlockState('wan_settings',false);
		$("#connType").selectbox("enable");
		
		//changeBlockState('wan_setups',false);
		$("#dynamic_uiViewEncaps").selectbox("enable");
		f.dynamic_mtu.disabled = false;
		$("#dynamic_DefaultRoute").selectbox("enable");
		document.getElementById("dynamic_nat").disabled = false;
		document.getElementById("dynamic_PPPoEPassthrough").disabled = false;
		//f.option60_venderid.disabled = false;
		$("#static_uiViewEncaps").selectbox("enable");
		f.static_ip.disabled = false;
		f.static_mask.disabled = false;
		f.static_gateway.disabled = false;
		f.static_mtu.disabled = false;
		$("#static_DefaultRoute").selectbox("enable");
		document.getElementById("static_nat").disabled = false;
		document.getElementById("static_PPPoEPassthrough").disabled = false;
		f.pppoe_name.disabled = false;
		f.pppoe_pass.disabled = false;
		f.pppoe_pass_v.disabled = false;
		$("#pppoe_conn_type").selectbox("enable");
		f.pppoe_srv_name.disabled = false; 
		f.pppoe_ac_name.disabled = false;
		$("#pppoe_IPControl").selectbox("enable");
		f.pppoe_ip.disabled = false;
		$("#pppoe_umb_pppoe_type").selectbox("enable");
		$("#interface").selectbox("enable");
		f.pppoe_umb_ip.disabled = false;
		f.pppoe_umb_netmask.disabled = false;
		f.pppoe_mtu.disabled = false;
		$("#pppoe_DefaultRoute").selectbox("enable");
		document.getElementById("pppoe_nat").disabled = false;
		document.getElementById("pppoe_PPPoEPassthrough").disabled = false;
		$("#pppoe_auth_protocol").selectbox("enable");
		$("#radio_connect_2").selectbox("enable");
		f.pppoe_max_time.disabled = false;
		f.pppoa_name.disabled = false;
		f.pppoa_pass.disabled = false;
		f.pppoa_pass_v.disabled = false;
		$("#pppoa_conn_type").selectbox("enable");
		$("#pppoa_IPControl").selectbox("enable");
		f.pppoa_ip.disabled = false;
		$("#pppoa_umb_pppoa_type").selectbox("enable");
		$("#pppoa_interface").selectbox("enable");
		f.pppoa_umb_ip.disabled = false;
		f.pppoa_umb_netmask.disabled = false;
		f.pppoa_mtu.disabled = false;
		$("#pppoa_DefaultRoute").selectbox("enable");
		document.getElementById("pppoa_nat").disabled = false;
		$("#pppoa_auth_protocol").selectbox("enable");
		$("#radio_connect_0").selectbox("enable");
		f.pppoa_max_time.disabled = false;
		$("#bridge_uiViewEncaps").selectbox("enable");
		document.getElementById("BridgeElpp").disabled = false;

		changeBlockState('pptp_setup',false);

		//changeBlockState('wan_atms',false);
		f.uiViewPvcVpi.disabled = false;
		f.uiViewPvcVci.disabled = false;
		$("#uiViewQosS").selectbox("enable");
		f.uiViewPvcPcr.disabled = false;
		f.uiViewPvcScr.disabled = false;
		f.uiViewPvcMbs.disabled = false;
		f.vlanid.disabled = false;
		
		changeBlockState('dhcp_ipv6', false);
		changeBlockState('static_ipv6', false);
		changeBlockState('ppp_ipv6', false);

		doDHCPIPv6Enable();
		doStaticIPv6Enable();
		doPPPIPv6Enable();
	} else {
		//changeBlockState('wan_settings',true);
		$("#connType").selectbox("disable");
		
		//changeBlockState('wan_setups',true);
		$("#dynamic_uiViewEncaps").selectbox("disable");
		f.dynamic_mtu.disabled = true;
		$("#dynamic_DefaultRoute").selectbox("disable");
		document.getElementById("dynamic_nat").disabled = true;
		document.getElementById("dynamic_PPPoEPassthrough").disabled = true;
		//f.option60_venderid.disabled = true;
		$("#static_uiViewEncaps").selectbox("disable");
		f.static_ip.disabled = true;
		f.static_mask.disabled = true;
		f.static_gateway.disabled = true;
		f.static_mtu.disabled = true;
		$("#static_DefaultRoute").selectbox("disable");
		document.getElementById("static_nat").disabled = true;
		document.getElementById("static_PPPoEPassthrough").disabled = true;
		f.pppoe_name.disabled = true;
		f.pppoe_pass.disabled = true;
		f.pppoe_pass_v.disabled = true;
		$("#pppoe_conn_type").selectbox("disable");
		f.pppoe_srv_name.disabled = true; 
		f.pppoe_ac_name.disabled = true;
		$("#pppoe_IPControl").selectbox("disable");
		f.pppoe_ip.disabled = true;
		$("#pppoe_umb_pppoe_type").selectbox("disable");
		$("#interface").selectbox("disable");
		f.pppoe_umb_ip.disabled = true;
		f.pppoe_umb_netmask.disabled = true;
		f.pppoe_mtu.disabled = true;
		$("#pppoe_DefaultRoute").selectbox("disable");
		document.getElementById("pppoe_nat").disabled = true;
		document.getElementById("pppoe_PPPoEPassthrough").disabled = true;
		$("#pppoe_auth_protocol").selectbox("disable");
		$("#radio_connect_2").selectbox("disable");
		f.pppoe_max_time.disabled = true;
		f.pppoa_name.disabled = true;
		f.pppoa_pass.disabled = true;
		f.pppoa_pass_v.disabled = true;
		$("#pppoa_conn_type").selectbox("disable");
		$("#pppoa_IPControl").selectbox("disable");
		f.pppoa_ip.disabled = true;
		$("#pppoa_umb_pppoa_type").selectbox("disable");
		$("#pppoa_interface").selectbox("disable");
		f.pppoa_umb_ip.disabled = true;
		f.pppoa_umb_netmask.disabled = true;
		f.pppoa_mtu.disabled = true;
		$("#pppoa_DefaultRoute").selectbox("disable");
		document.getElementById("pppoa_nat").disabled = true;
		$("#pppoa_auth_protocol").selectbox("disable");
		$("#radio_connect_0").selectbox("disable");
		f.pppoa_max_time.disabled = true;
		$("#bridge_uiViewEncaps").selectbox("disable");
		document.getElementById("BridgeElpp").disabled = true;
		
		changeBlockState('pptp_setup',true);
		
		//changeBlockState('wan_atms',true);
		f.uiViewPvcVpi.disabled = true;
		f.uiViewPvcVci.disabled = true;
		$("#uiViewQosS").selectbox("disable");
		f.uiViewPvcPcr.disabled = true;
		f.uiViewPvcScr.disabled = true;
		f.uiViewPvcMbs.disabled = true;
		f.vlanid.disabled = true;
		
		changeBlockState('dhcp_ipv6', true);
		changeBlockState('static_ipv6', true);
		changeBlockState('ppp_ipv6', true);		
	}

	selectpptp();
	clickPPP(f);
	doedit();
	clickPPPOA(f);
	doeditpppoa();
}

function init() {
	var f = document.getElementById("wan_form");

	if(self.location.href.indexOf("Chg=adsl") != -1)
	     	f.wanType.value = 0;
	else
		if(auto_method=="Auto")
			f.wanType.value = 3;
		else
			f.wanType.value = 0;
	initWanSetup(wanid);
}

function initWanSetup(number) {
   	var f = document.getElementById("wan_form");
	var n=0;
	tmpnum = 0;
	/*if(parseInt(fail_en) == 0)
		f.fail_radio[0].checked=true;
	else
		f.fail_radio[1].checked=true;*/

	//Chgfail();

	number=parseInt(number);
	if(number<0 || number>7)
		number = 0;
	f.pvcid.value=number;

	AtmDoOnload(ATM_obj);

	if(vlanlist == "N/A"||vlanlist =="0")
		f.vlanid.value = "";
	else
		f.vlanid.value = vlanlist;

	changeBlock();
	
	/*if(parseInt(unlock) == 1)
		DisplayShow('showfailover',"tr");
	else
		DisplayHide('showfailover');*/

	switch (parseInt(connection)) {
		case 0:
			//f.connType[0].checked=true;
			f.connType.value=1;
			tmpnum = 1;
			break;
		case 1:
			//f.connType[1].checked=true;
			f.connType.value=2;
			tmpnum = 2;
			break;
		case 2:
		    if(ATM_obj.encaps.indexOf('PPPoA')!='-1') {
		       	//f.connType[3].checked=true;
		       	f.connType.value=4;
				tmpnum = 4;
		    } else {
				//f.connType[2].checked=true;
				f.connType.value=3;
				tmpnum = 3;
		    }
			break;
		case 3:
			//f.connType[4].checked=true;
			f.connType.value=5;
			tmpnum = 5;
			break;
	}
	showparticular(parseInt(tmpnum));
}

function QoSDoOnLoad(connSelected) {
	var f = document.getElementById("wan_form");
	traffic_classValue = ATM_obj.traffic_class;
  	vbr_pcrValue = ATM_obj.vbr_pcr;
  	vbr_scrValue = ATM_obj.vbr_scr;
	pvcDoSetQoS(traffic_classValue);
	if ((self.location.href.indexOf("error=true")!=-1)||(self.location.href.indexOf("confirm=true")!=-1)||(self.location.href.indexOf("confirm=back")!=-1)) {
		if(bmode!=1)
			pvcDoSetQoS(qosvalue[0]);
	}
}

function AtmDoOnload(obj) {
	var f = document.getElementById("wan_form");

  	f.uiViewPvcVpi.value=obj.vpi;
  	f.uiViewPvcVci.value=obj.vci;

	if(obj.active == "Yes")
		//f.uiViewConState.checked = true;
		SetCheckBoxEnable("uiViewConState", true, true);
	else
		//f.uiViewConState.checked = false;
		SetCheckBoxEnable("uiViewConState", true, false);

	if ((self.location.href.indexOf("error=true")!=-1)||(self.location.href.indexOf("confirm=true")!=-1)||(self.location.href.indexOf("confirm=back")!=-1)) {
		if(bmode!=1)
			f.uiViewPvcVpi.value=vpivalue;
		f.uiViewPvcVci.value=vcivalue;
	}
}

function pvcDoSetQoS(arg) {
	var f = document.getElementById("wan_form");
  	var index = 0;
	f.uiViewPvcPcr.value=ATM_obj.max_pcr;
	f.uiViewPvcScr.value=ATM_obj.scr;
	f.uiViewPvcMbs.value=ATM_obj.mbs;
  	switch(arg) {
	  	case "ubr":
			document.getElementById("showMaxPcr").style.display = "none";
			document.getElementById("showScr").style.display = "none";
			document.getElementById("showMbs").style.display = "none";
			break;
		case "cbr":
			document.getElementById("showMaxPcr").style.display = "";
			document.getElementById("showScr").style.display = "none";
			document.getElementById("showMbs").style.display = "none";
			break;
		case "nrt-vbr":
			document.getElementById("showMaxPcr").style.display = "";
			document.getElementById("showScr").style.display = "";
			document.getElementById("showMbs").style.display = "";
			break;
		case "rt-vbr":
			document.getElementById("showMaxPcr").style.display = "";
			document.getElementById("showScr").style.display = "";
			document.getElementById("showMbs").style.display = "";
			break;
		case "ubr+":
	    default:
			document.getElementById("showMaxPcr").style.display = "";
			document.getElementById("showScr").style.display = "none";
			document.getElementById("showMbs").style.display = "none";
	    	break;
	}
	f.uiViewQosS.value=decodeSpecialChr(arg);
}

function setMac() {
   	var f = document.forms[0];

	if(f.clonemac.value == "Clone") {
		if(runtimeMAC!="") {
		   	myMac = runtimeMAC.split(":");
		   	f.dynamic_mac0.value=myMac[0];
		   	f.dynamic_mac1.value=myMac[1];
		   	f.dynamic_mac2.value=myMac[2];
		   	f.dynamic_mac3.value=myMac[3];
		   	f.dynamic_mac4.value=myMac[4];
		   	f.dynamic_mac5.value=myMac[5];
			f.clonemac.value = "Default"
		} else {
			f.dynamic_mac0.value="00";
		   	f.dynamic_mac1.value="00";
		   	f.dynamic_mac2.value="00";
		   	f.dynamic_mac3.value="00";
		   	f.dynamic_mac4.value="00";
		   	f.dynamic_mac5.value="00";
		}
	} else {
		f.dynamic_mac0.value="00";
	   	f.dynamic_mac1.value="00";
	   	f.dynamic_mac2.value="00";
	   	f.dynamic_mac3.value="00";
	   	f.dynamic_mac4.value="00";
	   	f.dynamic_mac5.value="00";
		f.clonemac.value = "Clone"
	}
}

function showVciVpi() {
	var str=new String();
	str="";
	str+="<tr>";
	str+="<th>"+_wan_dsl_vpi_lbl+":</th>";
	str+="<td><input id=\"uiViewPvcVpi\" type=\"text\" name=\"uiViewPvcVpi\" class=\"text\" value=\"\" />";
	str+="</td>";
	str+="</tr>";
	str+="<tr>";
	str+="<th>"+_wan_dsl_vci_lbl+":</th>";
	str+="<td><input id=\"uiViewPvcVci\" type=\"text\" name=\"uiViewPvcVci\" class=\"text\" value=\"\" />";
	str+="</td>";
	str+="</tr>";
	document.writeln(str);
}

function ChgPage(tmp) {
	var f = document.forms[0];
	if(tmp == 1)
		showparticular(1);
	if(tmp == 2)
		showparticular(2);
	if(tmp == 3)
		showparticular(3);
	if(tmp == 4)
		showparticular(4);
	if(tmp == 5)
		showparticular(5);
}

function Chgfail() {
	var f = document.forms[0];
	if(f.fail_radio[0].checked) {
		f.wanType[0].disabled=false;
		f.wanType[1].disabled=false;
	} else {
		f.wanType[0].disabled=true;
		f.wanType[1].disabled=true;
	}
}

function checkVPI(name) {
	var f = document.forms[0];
	var id = f.pvcid.value;
	for (var i=0;i<dsl_wanif_max;i++) {
		if(id!=i) {
			if(name==VCIVPILists[0][i])
				return false;
		}
	}
	return true;
}

function checkVCI(name) {
	var f = document.forms[0];
	var id = f.pvcid.value;
	for (var i=0;i<dsl_wanif_max;i++) {
		if(id!=i) {
			if(name==VCIVPILists[1][i])
				return false;
		}
	}
	return true;
}

function checkVPIVCI(name1,name2) {
	var f = document.forms[0];
	var id = f.pvcid.value;
	for (var i=0;i<dsl_wanif_max;i++) {
		if(id!=i) {
			if((name1==VCIVPILists[0][i]) && (name2==VCIVPILists[1][i]))
				return false;
		}
	}
	return true;
}

function Prefixes_Rule(TelNum) {
	for (var i=0; i<TelNum.length; i++) {
		if(TelNum.charAt(i)=='\"') return false;
		if(TelNum.charAt(i)==' ') return false;
	}
	return true;
}

function check_special(asc2) {
	if(asc2 == 33) return true;
	if(asc2 == 34) return true;
	if(asc2 == 35) return true;
	if(asc2 == 36) return true;
	if(asc2 == 37) return true;
	if(asc2 == 38) return true;
	if(asc2 == 39) return true;
	if(asc2 == 40) return true;
	if(asc2 == 41) return true;
	if(asc2 == 42) return true;
	if(asc2 == 43) return true;
	if(asc2 == 44) return true;
	if(asc2 == 45) return true;
	if(asc2 == 46) return true;
	if(asc2 == 47) return true;
	if(asc2 == 58) return true;
	if(asc2 == 59) return true;
	if(asc2 == 60) return true;
	if(asc2 == 61) return true;
	if(asc2 == 62) return true;
	if(asc2 == 63) return true;
	if(asc2 == 64) return true;
	if(asc2 == 91) return true;
	if(asc2 == 92) return true;
	if(asc2 == 93) return true;
	if(asc2 == 94) return true;
	if(asc2 == 95) return true;
	if(asc2 == 96) return true;
	if(asc2 == 123) return true;
	if(asc2 == 124) return true;
	if(asc2 == 125) return true;
	if(asc2 == 126) return true;
	if(asc2 == 163) return true;
	if(asc2 == 166) return true;
	if(asc2 == 172) return true;
	if(asc2 == 8364) return true;
	return false;
}

function isUserNameInvalid(source) {
	var username;
	var tempstr;
	if(source=="")
		return true;

	if(parseInt(unlock) != 1) {
		if(source.indexOf("@") == -1)
			return true;
	}

	if(parseInt(unlock) != 1) {
		username=source.split("@");
		var userid = new String(username[0]);
		var domain = new String(username[1]);
		if(userid == "")
			return true;
		if(domain == "")
			return true;
	} else
		var userid = new String(source);

	for(var strposition=0;strposition<=userid.length-1;strposition++) {
		tempstr=userid.substr(strposition,1);
		if((tempstr.charCodeAt(0)>=48 && tempstr.charCodeAt(0)<=57 )||(tempstr.charCodeAt(0)>=65 && tempstr.charCodeAt(0)<=90 )||(tempstr.charCodeAt(0)>=97 && tempstr.charCodeAt(0)<=122 )||check_special(tempstr.charCodeAt(0)))
			continue;
		else
			return true;
	}

	if(parseInt(unlock) != 1) {
		for(var strposition=0;strposition<=domain.length-1;strposition++) {
			tempstr=domain.substr(strposition,1);
			if((tempstr.charCodeAt(0)>=48 && tempstr.charCodeAt(0)<=57 )||(tempstr.charCodeAt(0)>=65 && tempstr.charCodeAt(0)<=90 )||(tempstr.charCodeAt(0)>=97 && tempstr.charCodeAt(0)<=122 )||check_special(tempstr.charCodeAt(0)))
				continue;
			else
				return true;
		}
	}
	return false;
}

function isPasswordInvalid(source) {
	var sourcestr=new String(source);
	var tempstr;
	if(sourcestr=="")
		return false;
	for(var strposition=0;strposition<=sourcestr.length-1;strposition++) {
		tempstr=sourcestr.substr(strposition,1);
		if((tempstr.charCodeAt(0)>=48 && tempstr.charCodeAt(0)<=57 )||(tempstr.charCodeAt(0)>=65 && tempstr.charCodeAt(0)<=90 )||(tempstr.charCodeAt(0)>=97 && tempstr.charCodeAt(0)<=122 ))
			continue;
		else
			return true;
	}
	return false;
}

function checkATM() {
	var f = document.forms[0];
	if(!isNumber(f.uiViewPvcVpi.value) ||(f.uiViewPvcVpi.value<0)||(f.uiViewPvcVpi.value>255)) {
		$("#uiViewPvcVpi_error").html("<br/>"+_wan_dsl_vpi_error);
		f.uiViewPvcVpi.focus();
		f.uiViewPvcVpi.select();
		return false;
	}

	if(!isNumber(f.uiViewPvcVci.value) ||(f.uiViewPvcVci.value<32)||(f.uiViewPvcVci.value>65535)) {
		$("#uiViewPvcVci_error").html("<br/>"+_wan_dsl_vci_error);		
		f.uiViewPvcVci.focus();
		f.uiViewPvcVci.select();
		return false;
	}
	if(!checkVPIVCI(f.uiViewPvcVpi.value,f.uiViewPvcVci.value)) {
		$("#uiViewPvcVpi_error").html("<br/>"+_wan_dsl_vpi_exist_error);		
		f.uiViewPvcVpi.focus();
		f.uiViewPvcVpi.select();
		return false;
	}

	if(f.uiViewQosS.value=="cbr") {
		if((f.uiViewPvcPcr.value.length==0) ||!isNumber(f.uiViewPvcPcr.value) || (f.uiViewPvcPcr.value < 0) || (f.uiViewPvcPcr.value > 5500)) {
			$("#uiViewPvcPcr_error").html("<br/>"+_wan_dsl_max_pcr_error);		
			f.uiViewPvcPcr.focus();
			f.uiViewPvcPcr.select();
			return false;
		}
	}

	if(f.uiViewQosS.value=="nrt-vbr") {
		if((f.uiViewPvcPcr.value.length==0) ||!isNumber(f.uiViewPvcPcr.value)|| (f.uiViewPvcPcr.value < 0) || (f.uiViewPvcPcr.value > 5500)) {
			$("#uiViewPvcPcr_error").html("<br/>"+_wan_dsl_max_pcr_error);		
			f.uiViewPvcPcr.focus();
			f.uiViewPvcPcr.select();
			return false;
		}

		if((f.uiViewPvcScr.value.length==0) ||!isNumber(f.uiViewPvcScr.value) || (f.uiViewPvcScr.value < 0) || (f.uiViewPvcScr.value > 5500)) {
			$("#uiViewPvcScr_error").html("<br/>"+_wan_dsl_scr0_error);	
			f.uiViewPvcScr.focus();
			f.uiViewPvcScr.select();
			return false;
		}
		if((f.uiViewPvcMbs.value.length==0) ||!isNumber(f.uiViewPvcMbs.value) || (f.uiViewPvcMbs.value < 0) || (f.uiViewPvcMbs.value > 5500)) {
			$("#uiViewPvcMbs_error").html("<br/>"+_wan_dsl_mbs_error);	
			f.uiViewPvcMbs.focus();
			f.uiViewPvcMbs.select();
			return false;
		}
	}

	if(f.uiViewQosS.value=="rt-vbr") {
		if((f.uiViewPvcPcr.value.length==0) ||!isNumber(f.uiViewPvcPcr.value) || (f.uiViewPvcPcr.value < 0) || (f.uiViewPvcPcr.value > 5500)) {
			$("#uiViewPvcPcr_error").html("<br/>"+_wan_dsl_max_pcr_error);	
			f.uiViewPvcPcr.focus();
			f.uiViewPvcPcr.select();
			return false;
		}

		if((f.uiViewPvcScr.value.length==0) ||!isNumber(f.uiViewPvcScr.value) || (f.uiViewPvcScr.value < 0) || (f.uiViewPvcScr.value > 5500)) {
			$("#uiViewPvcScr_error").html("<br/>"+_wan_dsl_scr0_error);	
			f.uiViewPvcScr.focus();
			f.uiViewPvcScr.select();
			return false;
		}
		if((f.uiViewPvcMbs.value.length==0) ||!isNumber(f.uiViewPvcMbs.value) || (f.uiViewPvcMbs.value < 0) || (f.uiViewPvcMbs.value > 5500)) {
			$("#uiViewPvcMbs_error").html("<br/>"+_wan_dsl_mbs_error);	
			f.uiViewPvcMbs.focus();
			f.uiViewPvcMbs.select();
			return false;
		}
	}

	if(f.uiViewQosS.value=="ubr+") {
		if( f.uiViewPvcPcr.value.length != 0) {
			if(!isNumber(f.uiViewPvcPcr.value) || (f.uiViewPvcPcr.value < 0) || (f.uiViewPvcPcr.value > 5500)) {
				$("#uiViewPvcPcr_error").html("<br/>"+_wan_dsl_max_pcr_error);	
				f.uiViewPvcPcr.focus();
				f.uiViewPvcPcr.select();
				return false;
			}
		}
	}

    if(f.uiViewQosS.value=="ubr") {
		f.uiViewPvcPcr.value = "0";
		f.uiViewPvcScr.value = "0";
		f.uiViewPvcMbs.value = "0";

    }

   	if(f.uiViewQosS.value=="cbr") {
		f.uiViewPvcScr.value = "0";
		f.uiViewPvcMbs.value = "0";
    }

	return true;
}

function checkparameterDynamic() {
	var f = document.forms[0];
	//if(f.uiViewConState.checked) {
	if(f.uiViewConState_ck.checked){
		if(bmode!=1) {
			if(!checkATM())
				return false;

			if(parseInt(f.dynamic_mtu.value)!=0) {
				if(!isNumber(f.dynamic_mtu.value) || (parseInt(f.dynamic_mtu.value)<576)|| (parseInt(f.dynamic_mtu.value)>1516)) {
					$("#dynamic_mtu_error").html("<br/>"+_wan_dsl_dhcpmtu_error);
					f.dynamic_mtu.focus();
					f.dynamic_mtu.select();
					return false;
				}
			}

			/*if(f.option60_venderid.value.length>32) {
				$("#option60_venderid_error").html("<br/>"+_wan_venderid_error);
				f.option60_venderid.focus();
				f.option60_venderid.select();
				return false;
			}*/
		}

		if(parseInt(showpptp)==1) {
			if(f.pptp_enable.checked==true) {
				if(f.pptp_tunnel_name.value.length<1||f.pptp_tunnel_name.value.length>63) {
					$("#pptp_tunnel_name_error").html("<br/>"+_wan_dsl_tunnel_name_error);
					f.pptp_tunnel_name.focus();
					f.pptp_tunnel_name.select();
					return false;
				}
				if(!is_valid_ip(f.pptp_server_ip_address.value,0)) {
					$("#pptp_server_ip_address_error").html("<br/>"+_wan_dsl_server_ip_address_error);
					f.pptp_server_ip_address.focus();
					f.pptp_server_ip_address.select();
					return false;
				}
				if(f.pptp_user_name.value.length<1||f.pptp_user_name.value.length>15||!Prefixes_Rule(f.pptp_user_name.value)) {
					$("#pptp_user_name_error").html("<br/>"+_wan_dsl_user_name_error);
					f.pptp_user_name.focus();
					f.pptp_user_name.select();
					return false;
				}
				if(f.pptp_user_password.value.length>63||!Prefixes_Rule(f.pptp_user_password.value)) {
					$("#pptp_user_password_error").html("<br/>"+_wan_dsl_user_password_error);
					f.pptp_user_password.focus();
					f.pptp_user_password.select();
					return false;
				}

				if (is_valid_ip(f.pptp_peer_ip_address.value, 0)==false) {
					$("#pptp_peer_ip_address_error").html("<br/>"+_wan_dsl_peer_ipAddress_error);
					f.pptp_peer_ip_address.focus();
					f.pptp_peer_ip_address.select();
					return false;
				}
				if (is_valid_mask(f.pptp_peer_subnet_mask.value)==false) {
					$("#pptp_peer_subnet_mask_error").html("<br/>"+_wan_dsl_peer_ipSubnetMask_error);
					f.pptp_peer_subnet_mask.focus();
					f.pptp_peer_subnet_mask.select();
					return false;
				}
				if (!is_valid_ip2(f.pptp_peer_ip_address.value, f.pptp_peer_subnet_mask.value)) {
					$("#pptp_peer_subnet_mask_error").html("<br/>"+_wan_dsl_peer_ipSubnetMask_error);
					f.pptp_peer_subnet_mask.focus();
					f.pptp_peer_subnet_mask.select();
					return false;
				}
			}
		}
	}
	return(true);
}

function checkparameterStatic() {
	var f = document.forms[0];

	//if(f.uiViewConState.checked) {
	if(f.uiViewConState_ck.checked){
		if(bmode!=1) {
			if(!checkATM())
				return false;
			if(parseInt(f.static_mtu.value)!=0) {
				if(!isNumber(f.static_mtu.value) || (parseInt(f.static_mtu.value)<100)|| (parseInt(f.static_mtu.value)>1516)) {
					$("#static_mtu_error").html("<br/>"+_wan_dsl_staticmtu_error);
					f.static_mtu.focus();
					f.static_mtu.select();
					return false;
				}
			}
		}
		if (!is_valid_ip(f.static_ip.value, 0)) {
			$("#static_ip_error").html("<br/>"+_wan_dsl_ipAddress_error);
			f.static_ip.focus();
			f.static_ip.select();
			return false;
		}
		if (!is_valid_mask(f.static_mask.value)) {
			$("#static_mask_error").html("<br/>"+_wan_dsl_subnetMask_error);
			f.static_mask.focus();
			f.static_mask.select();
			return false;
		}
		if (!is_valid_ip2(f.static_ip.value, f.static_mask.value)) {
			$("#static_ip_error").html("<br/>"+_wan_dsl_ipAddress_error);
			f.static_ip.focus();
			f.static_ip.select();
			return false;
		}
		if (!is_valid_gateway(f.static_ip.value, f.static_mask.value, f.static_gateway.value, 0)) {
			$("#static_gateway_error").html("<br/>"+_wan_dsl_different_subnet);
			f.static_gateway.focus();
			f.static_gateway.select();
			return false;
		}
		if(is_valid_network(f.static_ip.value, f.static_mask.value)) {
			$("#static_ip_error").html("<br/>"+_wan_dsl_ipAddress_error);
			f.static_ip.focus();
			f.static_ip.select();
			return false;
		}
		var net1 = get_network_id(f.static_ip.value, f.static_mask.value);
		var net2 = get_network_id(f.static_gateway.value, f.static_mask.value);
		if (net1[0] != net2[0])	{
			$("#static_gateway_error").html("<br/>"+_wan_dsl_different_subnet);
			f.static_gateway.focus();
			f.static_gateway.select();
			return false;
		}
		
		if(parseInt(showpptp)==1) {
			if(f.pptp_enable.checked==true) {
				if(f.pptp_tunnel_name.value.length<1||f.pptp_tunnel_name.value.length>63) {
					$("#pptp_tunnel_name_error").html("<br/>"+_wan_dsl_tunnel_name_error);
					f.pptp_tunnel_name.focus();
					f.pptp_tunnel_name.select();
					return false;
				}
				if(!is_valid_ip(f.pptp_server_ip_address.value,0)) {
					$("#pptp_server_ip_address_error").html("<br/>"+_wan_dsl_server_ip_address_error);
					f.pptp_server_ip_address.focus();
					f.pptp_server_ip_address.select();
					return false;
				}
				if(f.pptp_user_name.value.length<1||f.pptp_user_name.value.length>15||!Prefixes_Rule(f.pptp_user_name.value)) {
					$("#pptp_user_name_error").html("<br/>"+_wan_dsl_user_name_error);
					f.pptp_user_name.focus();
					f.pptp_user_name.select();
					return false;
				}
				if(f.pptp_user_password.value.length>63||!Prefixes_Rule(f.pptp_user_password.value)) {
					$("#pptp_user_password_error").html("<br/>"+_wan_dsl_user_password_error);
					f.pptp_user_password.focus();
					f.pptp_user_password.select();
					return false;
				}
				if (is_valid_ip(f.pptp_peer_ip_address.value, 0)==false) {
					$("#pptp_peer_ip_address_error").html("<br/>"+_wan_dsl_peer_ipAddress_error);
					f.pptp_peer_ip_address.focus();
					f.pptp_peer_ip_address.select();
					return false;
				}
				if (is_valid_mask(f.pptp_peer_subnet_mask.value)==false) {
					$("#pptp_peer_subnet_mask_error").html("<br/>"+_wan_dsl_peer_ipSubnetMask_error);
					f.pptp_peer_subnet_mask.focus();
					f.pptp_peer_subnet_mask.select();
					return false;
				}
				if (!is_valid_ip2(f.pptp_peer_ip_address.value, f.pptp_peer_subnet_mask.value)) {
					$("#pptp_peer_subnet_mask_error").html("<br/>"+_wan_dsl_peer_ipSubnetMask_error);
					f.pptp_peer_subnet_mask.focus();
					f.pptp_peer_subnet_mask.select();
					return false;
				}
			}
		}

		if(isIPv6Supported=="Yes") {
			if(parseInt(f.ipv6Flag.value) == 1) {
				if(f.StaticIPv6Enable[0].checked) {
					if(!processIPV6format())
						return false;
				}
			}			
		}
	}
	return true;
}

function checkparameterPPPOE() {
	var f = document.forms[0];

	if(f.uiViewConState_ck.checked) {
		if(bmode!=1) {
			if(!checkATM())
				return false;

			var MTU= parseInt(f.pppoe_mtu.value);
			if(!isNumber(f.pppoe_mtu.value) ||(MTU<100|| MTU>1516)&MTU!=0) {
					$("#pppoe_mtu_error").html("<br/>"+_wan_dsl_pppmtu_error);
					f.pppoe_mtu.focus();
					f.pppoe_mtu.select();
					return false;
			}
		}

		if(parseInt(unnumbered)==1&&parseInt(f.pppoe_umb_pppoe_type.value)!=0) {
			if (is_valid_ip(f.pppoe_umb_ip.value, 0)==false) {
				$("#pppoe_umb_ip_error").html("<br/>"+_wan_dsl_ip_ipAddress_error);
				f.pppoe_umb_ip.focus();
				f.pppoe_umb_ip.select();
				return false;
			}
			if (is_valid_mask(f.pppoe_umb_netmask.value)==false) {
				$("#pppoe_umb_netmask_error").html("<br/>"+_wan_dsl_ip_subnetMask_error);
				f.pppoe_umb_netmask.focus();
				f.pppoe_umb_netmask.select();
				return false;
			}
			if (!is_valid_ip2(f.pppoe_umb_ip.value, f.pppoe_umb_netmask.value)) {
				$("#pppoe_umb_netmask_error").html("<br/>"+_wan_dsl_ip_subnetMask_error);
				f.pppoe_umb_netmask.focus();
				f.pppoe_umb_netmask.select();
				return false;
			}
			if(f.pppoe_DefaultRoute.value!="msi") {
				$("#pppoe_DefaultRoute_error").html("<br/>"+_wan_dsl_ip_droute_error1+""+_wan_dsl_ip_droute_error2);
				return false;
			}
		}

		if(f.pppoe_name.value.length==0 || (f.pppoe_name.value.length!=0 && (f.pppoe_name.value.length>64 || f.pppoe_name.value.length<3))) {
			//if(parseInt(unlock) != 1)
			//	$("#pppoe_name_error").html("<br/>"+_wan_dsl_wanName_error);
			//else
				$("#pppoe_name_error").html("<br/>"+_wan_dsl_wanName_error2);
			f.pppoe_name.focus();
			f.pppoe_name.select();
			return;
		} else {
			/*if(isUserNameInvalid(f.pppoe_name.value)) {
				if(parseInt(unlock) != 1)
					$("#pppoe_name_error").html("<br/>"+_wan_dsl_wanName_error);
				else
					$("#pppoe_name_error").html("<br/>"+_wan_dsl_wanName_error2);
				f.pppoe_name.focus();
				f.pppoe_name.select();
				return;
			}*/
		}

		if(f.pppoe_pass.value.length==0 || (f.pppoe_pass.value.length!=0 && (f.pppoe_pass.value.length<1 ||f.pppoe_pass.value.length>32)) ) {
			$("#pppoe_pass_error").html("<br/>"+_wan_access_password_error_ppp);
			f.pppoe_pass.focus();
			f.pppoe_pass.select();
			return;
		}

		if(f.pppoe_pass.value!=f.pppoe_pass_v.value) {
			$("#pppoe_pass_error").html("<br/>"+_wan_access_password_nonequal_error);
			f.pppoe_pass.focus();
			f.pppoe_pass.select();
			return false;
		}

		if(f.pppoe_ac_name.value.length>63) {
			$("#pppoe_ac_name_error").html("<br/>"+_wan_access_ac_name_error);
			f.pppoe_ac_name.focus();
			f.pppoe_ac_name.select();
			return false;
		}

		if(f.pppoe_srv_name.value.length>39) {
			$("#pppoe_srv_name_error").html("<br/>"+_wan_access_service_name_error);
			f.pppoe_srv_name.focus();
			f.pppoe_srv_name.select();
			return false;
		}

		if(f.pppoe_IPControl.value==1) {
			if (!is_valid_ip(f.pppoe_ip.value, 0)) {
				$("#pppoe_ip_error").html("<br/>"+_wan_dsl_ipAddress_error);
				f.pppoe_ip.focus();
				f.pppoe_ip.select();
				return false;
			}
		}

		if(f.pppoe_radio_connect.value == "Connect_on_Demand") {
			if((!isNumber(f.pppoe_max_time.value)) || (f.pppoe_max_time.value <= 0)||(f.pppoe_max_time.value>10080)) {
				$("#pppoe_max_time_error").html("<br/>"+_wan_access_maxtime_error);
				f.pppoe_max_time.focus();
				f.pppoe_max_time.select();
				return false;
			}
		}

		if(parseInt(showpptp)==1) {
			if(f.pptp_enable.checked==true) {
				if(f.pptp_tunnel_name.value.length<1||f.pptp_tunnel_name.value.length>63) {
					$("#pptp_tunnel_name_error").html("<br/>"+_wan_dsl_tunnel_name_error);
					f.pptp_tunnel_name.focus();
					f.pptp_tunnel_name.select();
					return false;
				}
				if(!is_valid_ip(f.pptp_server_ip_address.value,0)) {
					$("#pptp_server_ip_address_error").html("<br/>"+_wan_dsl_server_ip_address_error);
					f.pptp_server_ip_address.focus();
					f.pptp_server_ip_address.select();
					return false;
				}
				if(f.pptp_user_name.value.length<1||f.pptp_user_name.value.length>15||!Prefixes_Rule(f.pptp_user_name.value)) {
					$("#pptp_user_name_error").html("<br/>"+_wan_dsl_user_name_error);
					f.pptp_user_name.focus();
					f.pptp_user_name.select();
					return false;
				}
				if(f.pptp_user_password.value.length>63||!Prefixes_Rule(f.pptp_user_password.value)) {
					$("#pptp_user_password_error").html("<br/>"+_wan_dsl_user_password_error);
					f.pptp_user_password.focus();
					f.pptp_user_password.select();
					return false;
				}
				if (is_valid_ip(f.pptp_peer_ip_address.value, 0)==false) {
					$("#pptp_peer_ip_address_error").html("<br/>"+_wan_dsl_peer_ipAddress_error);
					f.pptp_peer_ip_address.focus();
					f.pptp_peer_ip_address.select();
					return false;
				}
				if (is_valid_mask(f.pptp_peer_subnet_mask.value)==false) {
					$("#pptp_peer_subnet_mask_error").html("<br/>"+_wan_dsl_peer_ipSubnetMask_error);
					f.pptp_peer_subnet_mask.focus();
					f.pptp_peer_subnet_mask.select();
					return false;
				}
				if (!is_valid_ip2(f.pptp_peer_ip_address.value, f.pptp_peer_subnet_mask.value)) {
					$("#pptp_peer_subnet_mask_error").html("<br/>"+_wan_dsl_peer_ipSubnetMask_error);
					f.pptp_peer_subnet_mask.focus();
					f.pptp_peer_subnet_mask.select();
					return false;
				}
			}
		}
	}
	return true;
}

function checkparameterPPPOA() {
	var f = document.forms[0];

	if(f.uiViewConState_ck.checked) {
		if(bmode!=1) {
			if(!checkATM())
				return false;

			var MTU= parseInt(f.pppoa_mtu.value);
			if(!isNumber(f.pppoa_mtu.value) ||(MTU<100|| MTU>1516)&MTU!=0) {
					$("#pppoa_mtu_error").html("<br/>"+_wan_dsl_pppmtu_error);
					f.pppoa_mtu.focus();
					f.pppoa_mtu.select();
					return false;
			}
		}

		if(parseInt(unnumbered)==1&&parseInt(f.pppoa_umb_pppoa_type.value)!=0) {
			if (is_valid_ip(f.pppoa_umb_ip.value, 0)==false) {
				$("#pppoa_umb_ip_error").html("<br/>"+_wan_dsl_ip_ipAddress_error);
				f.pppoa_umb_ip.focus();
				f.pppoa_umb_ip.select();
				return false;
			}
			if (is_valid_mask(f.pppoa_umb_netmask.value)==false) {
				$("#pppoa_umb_netmask_error").html("<br/>"+_wan_dsl_ip_subnetMask_error);
				f.pppoa_umb_netmask.focus();
				f.pppoa_umb_netmask.select();
				return false;
			}
			if (!is_valid_ip2(f.pppoa_umb_ip.value, f.pppoa_umb_netmask.value)) {
				$("#pppoa_umb_netmask_error").html("<br/>"+_wan_dsl_ip_subnetMask_error);
				f.pppoa_umb_netmask.focus();
				f.pppoa_umb_netmask.select();
				return false;
			}
			if(f.pppoa_DefaultRoute.value!="msi") {
				$("#pppoa_DefaultRoute_error").html("<br/>"+_wan_dsl_ip_droute_error3+""+_wan_dsl_ip_droute_error4);
				return false;
			}
		}

		if(f.pppoa_name.value.length==0 || (f.pppoa_name.value.length!=0 && (f.pppoa_name.value.length>64 || f.pppoa_name.value.length<3))) {
			//if(parseInt(unlock) != 1)
			//	$("#pppoa_name_error").html("<br/>"+_wan_dsl_wanName_error);
			//else
				$("#pppoa_name_error").html("<br/>"+_wan_dsl_wanName_error2);
			f.pppoa_name.focus();
			f.pppoa_name.select();
			return;
		} else {
			/*if(isUserNameInvalid(f.pppoa_name.value)) {
				if(parseInt(unlock) != 1)
					$("#pppoa_name_error").html("<br/>"+_wan_dsl_wanName_error);
				else
					$("#pppoa_name_error").html("<br/>"+_wan_dsl_wanName_error2);
				f.pppoa_name.focus();
				f.pppoa_name.select();
				return;
			}*/
		}

		if(f.pppoa_pass.value.length==0 || (f.pppoa_pass.value.length!=0 && (f.pppoa_pass.value.length<1 ||f.pppoa_pass.value.length>32)) ) {
			$("#pppoa_pass_error").html("<br/>"+_wan_access_password_error_ppp);
			f.pppoa_pass.focus();
			f.pppoa_pass.select();
			return;
		}

		if(f.pppoa_pass.value!=f.pppoa_pass_v.value) {
			$("#pppoa_pass_error").html("<br/>"+_wan_access_password_nonequal_error);
			f.pppoa_pass.focus();
			f.pppoa_pass.select();
			return false;
		}

		if(f.pppoa_IPControl.value==1) {
			if(!is_valid_ip(f.pppoa_ip.value,0)) {
				$("#pppoa_ip_error").html("<br/>"+_wan_dsl_ipAddress_error);
				f.pppoa_ip.focus();
				f.pppoa_ip.select();
				return false;
			}
		}

		if(f.pppoa_radio_connect.value == "Connect_on_Demand") {
			if((!isNumber(f.pppoa_max_time.value)) || (f.pppoa_max_time.value <= 0)|| (f.pppoa_max_time.value > 10080)) {
				$("#pppoa_max_time_error").html("<br/>"+_wan_access_maxtime_error);
				f.pppoa_max_time.focus();
				f.pppoa_max_time.select();
				return false;
			}
		}

		if(parseInt(showpptp)==1) {
			if(f.pptp_enable.checked==true) {
				if(f.pptp_tunnel_name.value.length<1||f.pptp_tunnel_name.value.length>63) {
					$("#pptp_tunnel_name_error").html("<br/>"+_wan_dsl_tunnel_name_error);
					f.pptp_tunnel_name.focus();
					f.pptp_tunnel_name.select();
					return false;
				}
				if(!is_valid_ip(f.pptp_server_ip_address.value,0)) {
					$("#pptp_server_ip_address_error").html("<br/>"+_wan_dsl_server_ip_address_error);
					f.pptp_server_ip_address.focus();
					f.pptp_server_ip_address.select();
					return false;
				}
				if(f.pptp_user_name.value.length<1||f.pptp_user_name.value.length>15||!Prefixes_Rule(f.pptp_user_name.value)) {
					$("#pptp_user_name_error").html("<br/>"+_wan_dsl_user_name_error);
					f.pptp_user_name.focus();
					f.pptp_user_name.select();
					return false;
				}
				if(f.pptp_user_password.value.length>63||!Prefixes_Rule(f.pptp_user_password.value)) {
					$("#pptp_user_password_error").html("<br/>"+_wan_dsl_user_password_error);
					f.pptp_user_password.focus();
					f.pptp_user_password.select();
					return false;
				}
				if (is_valid_ip(f.pptp_peer_ip_address.value, 0)==false) {
					$("#pptp_peer_ip_address_error").html("<br/>"+_wan_dsl_peer_ipAddress_error);
					f.pptp_peer_ip_address.focus();
					f.pptp_peer_ip_address.select();
					return false;
				}
				if (is_valid_mask(f.pptp_peer_subnet_mask.value)==false) {
					$("#pptp_peer_subnet_mask_error").html("<br/>"+_wan_dsl_peer_ipSubnetMask_error);
					f.pptp_peer_subnet_mask.focus();
					f.pptp_peer_subnet_mask.select();
					return false;
				}
				if (!is_valid_ip2(f.pptp_peer_ip_address.value, f.pptp_peer_subnet_mask.value)) {
					$("#pptp_peer_subnet_mask_error").html("<br/>"+_wan_dsl_peer_ipSubnetMask_error);
					f.pptp_peer_subnet_mask.focus();
					f.pptp_peer_subnet_mask.select();
					return false;
				}
			}
		}
	}
	return true;
}

function checkparameterBridge() {
	var f = document.forms[0];

	if(f.uiViewConState_ck.checked) {
		if(bmode!=1) {
			if(!checkATM())
				return false;
		}
	}
	return true;
}

function checkMask(a,b) {
	var ipchk = MathandAbs(a).split(".");
	var maskchk = MathandAbs(b).split(".");
	if (maskchk.length!=4)
		return false;

   	for(var i=0; i< maskchk.length; i++) {
      		if (!isNumber(maskchk[i])) return false;
      		if (parseInt(maskchk[i]) < 0 || parseInt(maskchk[i]) > 255) return false;
   	}
	var yuip = ((parseInt(ipchk[0]) & parseInt(maskchk[0]))+"."+(parseInt(ipchk[1]) & parseInt(maskchk[1]))+"."+(parseInt(ipchk[2]) & parseInt(maskchk[2]))+"."+(parseInt(ipchk[3]) & parseInt(maskchk[3])));
	if(yuip == MathandAbs(a))
		return false;
	else
		return true;
}

function MathandAbs(ip) {
	var sIP=ip.split(".");
	absip = Math.abs(sIP[0])+"."+Math.abs(sIP[1])+"."+Math.abs(sIP[2])+"."+Math.abs(sIP[3]);
	return absip;
}

function HideorShow() {
	var f = document.forms[0];
	if((f.static_uiViewEncaps.value == "1483 Routed IP LLC(IPoA)") ||(f.static_uiViewEncaps.value == "1483 Routed IP VC-Mux"))
		document.getElementById("showPppoe").style.display = "none";
	else
		document.getElementById("showPppoe").style.display = "";
}

function connect_control() {
	var f = document.getElementById("wan_form");
	if(f.pppoe_radio_connect.value == "Connect_on_Demand")
		f.pppoe_max_time.disabled=false;
	else
		f.pppoe_max_time.disabled=true;
}

function connect_controlOA() {
	var f = document.getElementById("wan_form");
	//if(f.pppoa_radio_connect[1].checked)
	if(f.pppoa_radio_connect.value == "Connect_on_Demand")
		f.pppoa_max_time.disabled=false;
	else
		f.pppoa_max_time.disabled=true;
}

function clickPPP(f) {
	var b=false;
	//if (f.pppoe_IPControl.selectedIndex==0)
	if (f.pppoe_IPControl.value == 2)
		b = true;

	f.pppoe_ip.disabled = b;
}

function clickPPPOA(f) {
	var b=false;
	//if (f.pppoa_IPControl.selectedIndex==0)
	if (f.pppoa_IPControl.value == 2)
		b = true;

	f.pppoa_ip.disabled = b;
}

function checkIP(ip) {
	var sIP=MathandAbs(ip).split(".");
	if (sIP.length!=4) return false;
	for(var i=0; i< sIP.length; i++) {
		if (!isNumber(sIP[i])) return false;
		if(i == 0) {
			if (parseInt(sIP[i]) < 1 || parseInt(sIP[i]) > 223 ||parseInt(sIP[i]) == 127)
				return false;
		}
		if(i == 1 ||i == 2) {
			if (parseInt(sIP[i]) < 0 || parseInt(sIP[i]) > 255)
				return false;
		}
		if(i == 3) {
			if (parseInt(sIP[i]) < 1 || parseInt(sIP[i]) > 254)
				return false;
		}
	}
	return true;
}

function ChgMode(arg) {
	var f = document.getElementById("wan_form");
	if(arg == 0) {
		DisplayHide('ip_tr');
		DisplayHide('mask_tr');
		DisplayHide('gateway_tr');
		DisplayHide('dns_tr');
		DisplayHide('name_tr');
		DisplayHide('pass_tr');
		DisplayHide('pass_v_tr');

		f.pptp[0].checked = true;
		f.ip.disabled=true;
		f.mask.disabled=true;
		f.gateway.disabled=true;
		f.dns.disabled=true;
	}
	if(arg==1) {
		DisplayShow('ip_tr',"tr");
		DisplayShow('mask_tr',"tr");
		DisplayShow('gateway_tr',"tr");
		DisplayShow('dns_tr',"tr");
		DisplayHide('name_tr');
		DisplayHide('pass_tr');
		DisplayHide('pass_v_tr');

		f.pptp[1].checked = true;
		f.ip.disabled=false;
		f.mask.disabled=false;
		f.gateway.disabled=false;
		f.dns.disabled=false;
	}
	if(arg==2) {
		f.pptp[2].checked = true;
		DisplayHide('ip_tr');
		DisplayHide('mask_tr');
		DisplayHide('gateway_tr');
		DisplayHide('dns_tr');
		DisplayShow('name_tr',"tr");
		DisplayShow('pass_tr',"tr");
		DisplayShow('pass_v_tr',"tr");

	}
}

function SelectMode(selectmode) {
	var f = document.getElementById("wan_form");
	if(selectmode==2)
		f.maxtime.disabled=false;
	else
		f.maxtime.disabled=true;
}

function isNumber(n) {
	if (n.length==0) return false;
	for (var i=0;i < n.length;i++) {
		if (n.charAt(i) < '0' || n.charAt(i) > '9') return false;
	}
	return true;
}
function isNumber1(n) {
	if (n.length==0) return true;
	for (var i=0;i < n.length;i++) {
		if (n.charAt(i) < '0' || n.charAt(i) > '9') return false;
	}
	return true;
}

function GetInterface(Net_Type) {

	var tmp_obj = new NetType();
	var str="";

	switch (Net_Type) {
		case tmp_obj.wan:
			if(physical_type == 0) {
				for(var i=1;i<=parseInt(WanMax1);i++) {
					str+="<option value="+parseInt(i)+">"+"PVC"+i+"</option>";
				}
			} else {
				for(var i=1;i<=parseInt(WanMax2);i++) {
					str+="<option value="+parseInt(i)+">"+m_wan+i+"</option>";
				}
			}
			break;
		case tmp_obj.lan:
			str+="<option value='1'>"+m_lan+"1</option>";
			break;
		case tmp_obj.wanAndlan:
			if(physical_type == 0) {
				for(var j1=1;j1<=parseInt(LanMax);j1++) {
					str+="<option value="+parseInt(j1)+">"+m_lan+j1+"</option>";
				}
			} else {
				for(var j1=1;j1<=parseInt(LanMax);j1++) {
					str+="<option value="+parseInt(j1)+">"+m_lan+j1+"</option>";
				}
			}

			if(physical_type == 0) {
				for(var i1=1;i1<=parseInt(WanMax1);i1++) {
					str+="<option value="+parseInt(i1)+">"+"PVC"+i1+"</option>";
				}
			} else {
				for(var i1=1;i1<=parseInt(WanMax2);i1++) {
					str+="<option value="+parseInt(i1)+">"+m_wan+i1+"</option>";
				}
			}
			break;
		case tmp_obj.all:
			str+="<option value="+(parseInt(inf_index_others_start)+2)+">*</option>";
			if(physical_type == 0) {
				for(var j2=1;j2<=parseInt(LanMax);j2++) {
							str+="<option value="+parseInt(j2)+">"+m_lan+j2+"</option>";
				}
			} else {
				for(var j2=1;j2<=parseInt(LanMax);j2++) {
					str+="<option value="+parseInt(j2)+">"+m_lan+j2+"</option>";
				}
			}

			if(physical_type == 0) {
				for(var i2=1;i2<=parseInt(WanMax1);i2++) {
					str+="<option value="+parseInt(i2)+">"+"PVC"+i2+"</option>";
				}
			} else {
				for(var i2=1;i2<=parseInt(WanMax2);i2++) {
					str+="<option value="+parseInt(i2)+">"+m_wan+i2+"</option>";
				}
			}
			break;
		default:
			str+="<option value="+(parseInt(inf_index_others_start)+2)+">*</option>";
			if(physical_type == 0) {
				for(var j2=1;j2<=parseInt(LanMax);j2++) {
					str+="<option value="+parseInt(j2)+">"+m_lan+j2+"</option>";
				}
			} else {
				for(var j2=1;j2<=parseInt(LanMax);j2++) {
					str+="<option value="+parseInt(j2)+">"+m_lan+j2+"</option>";
				}
			}

			if(physical_type == 0) {
				for(var i2=1;i2<=parseInt(WanMax1);i2++) {
					str+="<option value="+parseInt(i2)+">"+"PVC"+i2+"</option>";
				}
			} else {
				for(var i2=1;i2<=parseInt(WanMax2);i2++) {
					str+="<option value="+parseInt(i2)+">"+m_wan+i2+"</option>";
				}
			}
	}
	tmp_obj = null;
	document.write(str);
}

function NetType(wan,lan,wanAndlan,all) {
	this.wan="WAN";
	this.lan="LAN";
	this.wanAndlan="WAN_LAN";
	this.all="ALL";
}

function doPrivacyaddrsShow0()  {
	var f = document.getElementById("wan_form"); 
	if(f.DynIPv6EnableRadio[0].checked)
		setDisplay('div_privacyaddrs0',0);
	else
		setDisplay('div_privacyaddrs0',1);
}

function doPPPv6PDEnable() {
	var  f=document.getElementById("wan_form"); 
}

function doPPPv6PDDisable()
{
	var  f=document.getElementById("wan_form"); 
}

function ripngEnableChanged0() {
	var f=document.getElementById("wan_form"); 
	if(f.ripngEnableRadio0[0].checked)
		setDisplay('div_ripng_direction0', 1);
	else
		setDisplay('div_ripng_direction0', 0);
}

function ripngEnableChanged1() {
	var  f=document.getElementById("wan_form"); 

	if (f.ripngEnableRadio1[0].checked)
		setDisplay('div_ripng_direction1', 1);
	else
		setDisplay('div_ripng_direction1', 0);
}

function inValidIPv6Addr(Address1)
{
	var regExp = /^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;
	
	var Address = trim(Address1);
	var address = Address.match(regExp);
	if(address == null){		
 		return true;
	}	
	return false;
}

function inValidIPv6Prefix(Prefix1)
{
	var Prefix = trim(Prefix1);
	var IPv6Prefix = Prefix.match("^[0-9]{1,3}$");
	
	if(IPv6Prefix == null) { 
 		return true;
	}
	
	if((Number(Prefix) > 128 ) || (Number(Prefix) < 1 )){
		return true;
	}
	
	return false;
}

function processIPV6format() {
	var value;
	var form=document.getElementById("wan_form");
	
	value = form.wan_IPv6Addr.value;
	if (value != "") {
		if(inValidIPv6Addr(value)) {
			$("#wan_IPv6Addr_error").html("<br/>"+m_internet_alertipv6+value);
			form.wan_IPv6Addr.focus();
			form.wan_IPv6Addr.select();
			return false;
		}
	} else {
		$("#wan_IPv6Addr_error").html("<br/>"+m_internet_alertipv62);
		form.wan_IPv6Addr.focus();
		form.wan_IPv6Addr.select();
		return false;
	}
	
	for(var i = 0; i < InvalidIPv6AddrList.length; i++) {
		if(value.toUpperCase() == InvalidIPv6AddrList[i]) {
			$("#wan_IPv6Addr_error").html("<br/>"+m_internet_alertipv6+value);
			form.wan_IPv6Addr.focus();
			form.wan_IPv6Addr.select();
			return false;
		}
	}

	value = form.wan_IPv6Prefix.value;
	if (value != "") {
		if(inValidIPv6Prefix(value)) {
			$("#wan_IPv6Prefix_error").html("<br/>"+m_internet_alertipv63+value);
			form.wan_IPv6Prefix.focus();
			form.wan_IPv6Prefix.select();
			return false;
		}
	} else {
		$("#wan_IPv6Prefix_error").html("<br/>"+m_internet_alertipv64);
		form.wan_IPv6Prefix.focus();
		form.wan_IPv6Prefix.select();
		return false;
	}
 		
	value = form.wan_IPv6DefGw.value;
	if (value != "") {
		if(inValidIPv6Addr(value)) {
			$("#wan_IPv6DefGw_error").html("<br/>"+m_internet_alertipv6+value);
			form.wan_IPv6DefGw.focus();
			form.wan_IPv6DefGw.select();
			return false;
		}
	} else {
		$("#wan_IPv6DefGw_error").html("<br/>"+m_internet_alertipv65);
		form.wan_IPv6DefGw.focus();
		form.wan_IPv6DefGw.select();
		return false;
	}

	for(var i = 0; i < InvalidIPv6AddrList.length; i++) {
		if(value.toUpperCase() == InvalidIPv6AddrList[i]) {
			$("#wan_IPv6DefGw_error").html("<br/>"+m_internet_alertipv66+ value);
			form.wan_IPv6DefGw.focus();
			form.wan_IPv6DefGw.select();
			return false;
		}
	}
	
		
	value = form.wan_IPv6DNS1.value;
	if (value != "") {
		if(inValidIPv6Addr(value)) {
			$("#wan_IPv6DNS1_error").html("<br/>"+m_internet_alertipv6+value);
			form.wan_IPv6DNS1.focus();
			form.wan_IPv6DNS1.select();
			return false;
		}
	} else {
		$("#wan_IPv6DNS1_error").html("<br/>"+m_internet_alertipv67);
		form.wan_IPv6DNS1.focus();
		form.wan_IPv6DNS1.select();
		return false;
	}

	for(var i = 0; i < InvalidIPv6AddrList.length; i++) {
		if(value.toUpperCase() == InvalidIPv6AddrList[i]) {
			$("#wan_IPv6DNS1_error").html("<br/>"+m_internet_alertipv68+ value);
			form.wan_IPv6DNS1.focus();
			form.wan_IPv6DNS1.select();
			return false;
		}
	}
		
	value = form.wan_IPv6DNS2.value;
	if (value != "") {
		if(inValidIPv6Addr(value)) {
			$("#wan_IPv6DNS2_error").html("<br/>"+m_internet_alertipv6+value);
			form.wan_IPv6DNS2.focus();
			form.wan_IPv6DNS2.select();
			return false;
		}
	} else {
		$("#wan_IPv6DNS2_error").html("<br/>"+m_internet_alertipv69);
		form.wan_IPv6DNS2.focus();
		form.wan_IPv6DNS2.select();
		return false;
	}

	for(var i = 0; i < InvalidIPv6AddrList.length; i++) {
		if(value.toUpperCase() == InvalidIPv6AddrList[i]) {
			$("#wan_IPv6DNS2_error").html("<br/>"+m_internet_alertipv610+ value);
			form.wan_IPv6DNS2.focus();
			form.wan_IPv6DNS2.select();
			return false;
		}
	}
		
	return true;
}

function doPPPv6ModeDHCP() {
	var form=document.getElementById("wan_form");
	form.PPPDHCPv6Mode_Flag.value = 1;
}

function doPrivacyaddrsShow2() {
	var form=document.getElementById("wan_form");
	if(form.PPPIPv6ModeRadio[0].checked)
		setDisplay('div_privacyaddrs2',0);
	else
		setDisplay('div_privacyaddrs2',1);
}

function doPPPv6ModeSLAAC() {
	var form=document.getElementById("wan_form");
	form.PPPDHCPv6Mode_Flag.value = 0;
}

function ripngEnableChanged2() {
	var form=document.getElementById("wan_form");
	if(form.ripngEnableRadio2[0].checked)
		setDisplay('div_ripng_direction2', 1);
	else
		setDisplay('div_ripng_direction2', 0);
}
function Load_HTML()
{
	$("#header").load("header.asp");
}
function Initial()
{
	initialMenu();
}
var _ReciprocalNumber = 10;
function Start_reciprocal_Number_RestoreConfiguration()
{
	if (_ReciprocalNumber >= 0)
	{
		document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", "Sec");
		_ReciprocalNumber --;
		setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
	}
	else
	{
		document.getElementById("waitSettingFinish").style.display = "none";
		document.getElementById("SuccessSettings").style.display = "inline";
	}
}
function returnToHome()  {
	var  f=document.getElementById("wan_form");
	if(f.isPage.value == 2)
		self.location.href="Internet_setup.asp";
	else if(f.isPage.value == 4)
		self.location.href="Internet_3g.asp";
	else
		self.location.href="Internet.asp";
}
function wanTypeChg()
{
	var  f=document.getElementById("wan_form");
	if(f.wanType.value == 3)
		self.location.href="Internet_auto.asp?Chg=auto";
	else if(f.wanType.value == 4)
		self.location.href="Internet_auto.asp?Chg=vdsl";
	else if(f.wanType.value == 2)
		self.location.href="Internet_3g.asp?Chg=3g";
}
