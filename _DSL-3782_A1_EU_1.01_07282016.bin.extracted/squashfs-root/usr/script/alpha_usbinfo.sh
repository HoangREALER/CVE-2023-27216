#!/bin/sh

RET_FILE=/tmp/usb_info.txt
USE_DEV=/proc/bus/usb/devices

if [ -f "$RET_FILE" ]; then
	rm $RET_FILE
fi

if [ -f "$USE_DEV" ]; then
	MANUFACTURER=`cat $USE_DEV | sed -n /Manufacturer/p | sed /hci_hcd/d | cut -d '=' -f 2`
fi
if [ -n "$MANUFACTURER" ]; then
	echo "$MANUFACTURER" > $RET_FILE
fi

USB_LINE=`df | sed -n /usb/p | sed -n 's/ * /:/gp'`
if [ -z "$USB_LINE" ]; then
	echo "No usb line"
	exit 0
fi
NUMBER=`echo "$USB_LINE" | wc -l | sed -n 's/ //gp'`
if [ -z "$NUMBER" ]; then
	echo "No usb num"
	exit 0
fi
TOTAL_COLUMN=`echo "$USB_LINE" | cut -d ':' -f 2`
if [ -z "$TOTAL_COLUMN" ]; then
	echo "No usb total"
	exit 0
fi
AVAIL_COLUMN=`echo "$USB_LINE" | cut -d ':' -f 4`
if [ -z "$AVAIL_COLUMN" ]; then
	echo "No usb available"
	exit 0
fi

if [ -z "$MANUFACTURER" ]; then
	echo "Unknown" > $RET_FILE
fi
echo "$NUMBER" >> $RET_FILE
echo "$TOTAL_COLUMN" >> $RET_FILE
echo "$AVAIL_COLUMN" >> $RET_FILE
