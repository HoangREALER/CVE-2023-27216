#!/bin/sh

PID_FILE="/tmp/var/run/klogd.pid"

ACTION=$1
if [ -z "$ACTION" ]; then
#  echo "klogd no action"
  exit 0
fi
if [ "$ACTION" != "start" ] && [ "$ACTION" != "stop" ]; then
#  echo "unknown action"
  exit 0
fi

# kill old klogd
if [ -f $PID_FILE ]; then
  PID=`cat $PID_FILE`
  if [ $PID != 0 ]; then
    kill -9 $PID
  fi
  rm -f $PID_FILE
else
  killall -9 klogd
fi

if [ "$ACTION" = "stop" ]; then
#  alpha_mgr -p 1
  exit 0
fi

#alpha_mgr -p 0
klogd -l br+ -l ra+ -w nas+ -w ppp+ >/dev/null &
echo $! > $PID_FILE
exit 0
